!function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:self,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var o,i,r=String(t),s=0,a=n,c="";r.charAt(0|s)||(a="=",s%1);c+=a.charAt(63&o>>8-s%1*8)){if((i=r.charCodeAt(s+=.75))>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");o=o<<8|i}return c}),t.atob||(t.atob=function(t){var o=String(t).replace(/=+$/,"");if(o.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,r,s=0,a=0,c="";r=o.charAt(a++);~r&&(i=s%4?64*i+r:r,s++%4)?c+=String.fromCharCode(255&i>>(-2*s&6)):0)r=n.indexOf(r);return c})}(),"function"!=typeof Object.assign&&(Object.assign=function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),o=1;o<arguments.length;o++){var i=arguments[o];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),[].includes||(Array.prototype.includes=function(e){"use strict";var t=Object(this),n=parseInt(t.length)||0;if(0===n)return!1;var o,i,r=parseInt(arguments[1])||0;for(r>=0?o=r:(o=n+r)<0&&(o=0);o<n;){if(e===(i=t[o])||e!=e&&i!=i)return!0;o++}return!1});var ProcessOut,__extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(e){!function(e){e[e.None=1]="None",e[e.OneOff=2]="OneOff",e[e.Subscription=3]="Subscription",e[e.Tokenization=4]="Tokenization"}(e.Flow||(e.Flow={}))}(ProcessOut||(ProcessOut={})),function(e){var t,n=function(){function e(e,t){if(this.element=e,this.iframe=t,window.addEventListener("resize",function(e){var t=Math.max(window.outerWidth,window.innerWidth);this.element.style.width=t+"px";var n=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);this.element.style.height=n+"px"}.bind(this)),"function"==typeof Event)var n=new Event("resize");else(n=document.createEvent("Event")).initEvent("resize",!0,!0);window.dispatchEvent(n)}return e.prototype.open=function(e){this.iframe.setAttribute("src",e),document.body.style.overflow="hidden",document.body.appendChild(this.element)},e.prototype.close=function(){document.body.style.overflow="",this.closed=!0,this.element.remove()},e}();!function(e){e[e.NewTab=0]="NewTab",e[e.NewWindow=1]="NewWindow",e[e.IFrame=2]="IFrame",e[e.FingerprintIframe=3]="FingerprintIframe"}(t=e.ActionFlow||(e.ActionFlow={}));var o=function(){function e(n,o){switch(this.gatewayLogo=o,n){case e.ThreeDSChallengeFlow:this.flow=t.IFrame;break;case e.ThreeDSFingerprintFlow:this.flow=t.FingerprintIframe;break;case"paypal":case"paypalexpresscheckout":this.flow=t.NewWindow,this.newWindowHeight=645,this.newWindowWidth=450;break;case"test-credit-card":case"test-alternative-payment":this.flow=t.NewWindow,this.newWindowHeight=645,this.newWindowWidth=450;break;default:this.flow=t.NewTab}this.flow==t.NewWindow&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(this.flow=t.NewTab)}return e.ThreeDSChallengeFlow="three-d-s-challenge-flow",e.ThreeDSFingerprintFlow="three-d-s-fingerprint-flow",e}();e.ActionHandlerOptions=o;var i=function(){function i(i,r){if(this.canceled=!1,this.newWindowName="processout.checkout-window",this.instance=i,this.options=r,this.options||(this.options=new o),this.options.flow==t.IFrame){var s=document.createElement("div");s.id="processoutjs-action-modal",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.height="100%",s.style.width="100%",s.setAttribute("style","position: fixed; top: 0; left: 0; background: rgba(0, 0, 0, 0.5); z-index: 9999999; overflow: auto;");var a=document.createElement("iframe");a.setAttribute("style",'margin: 1em auto; width: 440px; height: 480px; max-width: 100%; max-height: 100%; display: block; box-shadow: 0 15px 35px rgba(50, 50, 93, 0.1), 0 5px 15px rgba(0, 0, 0, 0.07); background-color: #ECEFF1; background-image: url("'+this.instance.endpoint("js","/images/loader.gif")+'"); background-repeat: no-repeat; background-position: center;")'),a.setAttribute("frameborder","0");var c=document.createElement("div");c.setAttribute("style","width: 100%; text-align: center; margin-bottom: 1em;");var u=document.createElement("div");u.setAttribute("style","cursor: pointer; color: white;"),u.innerHTML=e.Translator.translateMessage("label.cancel","Cancel"),c.appendChild(u),s.appendChild(a),s.appendChild(c),this.iframeWrapper=new n(s,a),u.onclick=function(){this.iframeWrapper.close()}.bind(this)}}return i.prototype.handle=function(n,o,i){var r,s,a,c,u,d=this,p=function(){c&&c.remove(),window.focus()};switch(this.options.flow){case t.NewWindow:r=this.createNewWindow(n),c=r.topLayer,u=r.newWindow;break;case t.IFrame:(u=this.iframeWrapper).open(n);break;case t.FingerprintIframe:(u=this.createFingerprintIFrame()).open(n),a=setTimeout(function(){i(new e.Exception("three-d-s-2.fingerprint-timed-out"))},1e4);break;default:s=this.createNewTabOrWindow(n),c=s.topLayer,u=s.newWindow}if(!u)return i(new e.Exception("customer.popup-blocked")),p(),null;var l=setInterval(function(){if(l){if(d.isCanceled())return clearInterval(l),l=null,u.close(),i(new e.Exception("customer.canceled")),void p();var t=function(){clearInterval(l),l=null,i(new e.Exception("customer.canceled")),p()};try{u&&!u.closed||t()}catch(e){try{u.close()}catch(e){}t()}}});return this.listenEvents(u,l,p,function(e){a&&clearTimeout(a),o(e)},function(e){a&&clearTimeout(a),i(e)}),this},i.prototype.createNewTabOrWindow=function(e){var t=window.open(e,this.newWindowName);return this.setupWindowObject(t)},i.prototype.createNewWindow=function(e){var t=this.options.newWindowHeight,n=this.options.newWindowWidth,o=window.top.outerHeight/2+window.top.screenY-t/2,i=window.top.outerWidth/2+window.top.screenX-n/2,r=window.open(e,this.newWindowName,"menubar=false,toolbar=false,width="+n+",height="+t+",top="+o+",left="+i);return this.setupWindowObject(r)},i.prototype.setupWindowObject=function(t){if(!t)return{};var n={topLayer:null,newWindow:t},o=function(e){try{n.newWindow.close()}catch(e){}};window.addEventListener("beforeunload",o,!1),window.addEventListener("pagehide",o,!1);var i=setInterval(function(){if(n.newWindow&&!n.newWindow.closed)try{n.newWindow.postMessage("processout.ping-ready","*")}catch(e){}else clearInterval(i)},250);n.topLayer=document.createElement("div"),n.topLayer.id="processoutjs-action-modal",n.topLayer.setAttribute("style","position: fixed; top: 0; left: 0; background: rgba(0, 0, 0, 0.7); z-index: 9999999; overflow: auto; height: 100%; width: 100%;");var r=document.createElement("div");if(r.setAttribute("style","text-align: center; color: white; max-width: 350px; margin: 0 auto; margin-top: 10%; cursor: pointer;"),this.options.gatewayLogo){var s=document.createElement("img");s.setAttribute("style","max-height: 70px; max-width: 230px; filter: brightness(0) invert(1); margin-bottom: 2em;"),s.setAttribute("src",this.options.gatewayLogo),r.appendChild(s)}var a=document.createElement("div");return a.innerHTML=e.Translator.translateMessage("label.apm-description"),r.appendChild(a),n.topLayer.appendChild(r),r.addEventListener("click",function(){n.newWindow.focus()},!1),document.body.appendChild(n.topLayer),n},i.prototype.createFingerprintIFrame=function(){var e=document.createElement("div");e.id="processoutjs-fingerprint-wrapper",e.style.height="0",e.style.width="0";var t=document.createElement("iframe");return t.style.display="none",t.setAttribute("frameborder","0"),e.appendChild(t),new n(e,t)},i.prototype.listenEvents=function(t,n,o,r,s){i.listenerCount++;var a=i.listenerCount,c=!1;window.addEventListener("message",function(u){var d=e.Message.parseEvent(u);if(d.namespace==e.Message.checkoutNamespace)if(i.listenerCount==a){if(!c)switch(c=!0,d.action){case"success":n&&(clearInterval(n),n=null),t.close(),r(d.data),o();break;case"canceled":n&&(clearInterval(n),n=null),t.close(),s(new e.Exception("customer.canceled")),o();break;case"none":n&&(clearInterval(n),n=null),t.close(),s(new e.Exception("processout-js.no-customer-action")),o();break;case"error":n&&(clearInterval(n),n=null),t.close(),s(new e.Exception(d.errorCode,d.errorMessage)),o();break;default:n&&(clearInterval(n),n=null),t.close(),s(new e.Exception("default")),o()}}else n&&(clearInterval(n),n=null)})},i.prototype.cancel=function(){this.canceled=!0},i.prototype.isCanceled=function(){return this.canceled},i.listenerCount=0,i}();e.ActionHandler=i}(ProcessOut||(ProcessOut={})),function(e){var t=function(){function t(t,n){this.instance=t,n.merchantCapabilities&&n.merchantCapabilities.length||(n.merchantCapabilities=["supports3DS"]),n.supportedNetworks&&n.supportedNetworks.length||(n.supportedNetworks=["amex","discover","masterCard","visa"]),this.request=n,this.session=new ApplePaySession(1,this.request);var o=this;this.session.onvalidatemerchant=function(t){o.instance.apiRequest("post",o.instance.endpoint("api","/applepay/sessions"),{session_url:t.validationURL,domain_name:window.location.hostname},function(t,n,i){t.success?o.session.completeMerchantValidation(t.session_payload):(o.onerror(new e.Exception(t.error_code,t.message)),o.session.abort())},function(t,n){o.onerror(new e.Exception("processout-js.network-issue")),o.session.abort()})},this.session.onpaymentauthorized=function(t){var n=o.data;n||(n={}),n.applepay_response=t.payment,n.token_type="applepay",o.instance.apiRequest("post",o.instance.endpoint("api","/cards"),n,function(t,n,i){t.success?o.onsuccess(t.card):(o.onerror(new e.Exception(t.error_code,t.message)),o.session.abort())},function(t,n){o.onerror(new e.Exception("processout-js.network-issue")),o.session.abort()})},this.session.oncancel=this.onCancelHandler.bind(this),this.session.onshippingcontactselected=this.onShippingContactSelectedHandler.bind(this),this.session.onshippingmethodselected=this.onShippingMethodSelectedHandler.bind(this)}return t.prototype.setHandlers=function(t,n){if(!t)throw new e.Exception("applepay.no-success-handler");this.onsuccess=t,this.onerror=function(e){n&&n(e)}},t.prototype.tokenize=function(e,t,n){this.setHandlers(t,n),this.session.begin()},t.prototype.abort=function(){this.session.abort()},t.prototype.completePayment=function(e){this.session.completePayment(e)},t.prototype.completePaymentMethodSelection=function(e,t){this.session.completePaymentMethodSelection(e,t)},t.prototype.completeShippingContactSelection=function(e,t,n,o){this.session.completeShippingContactSelection(e,t,n,o)},t.prototype.completeShippingMethodSelection=function(e,t,n){this.session.completeShippingMethodSelection(e,t,n)},t.prototype.getSession=function(){return this.session},t.prototype.onCancelHandler=function(e){this.oncancel&&this.oncancel(e)},t.prototype.onPaymentMethodSelectedHandler=function(e){this.onpaymentmethodselected&&this.onpaymentmethodselected(e)},t.prototype.onShippingContactSelectedHandler=function(e){this.onshippingcontactselected&&this.onshippingcontactselected(e)},t.prototype.onShippingMethodSelectedHandler=function(e){this.onshippingmethodselected&&this.onshippingmethodselected(e)},t}();e.ApplePay=t}(ProcessOut||(ProcessOut={})),function(e){var t=function(){function t(e){this.instance=e}return t.prototype.checkAvailability=function(t){window.ApplePaySession&&ApplePaySession.canMakePayments()?this.instance.apiRequest("get",this.instance.endpoint("api","/applepay/available"),{domain_name:window.location.hostname},function(n,o,i){n.success?t(null):t(new e.Exception("applepay.not-available",n.message))}.bind(this),function(n,o){t(new e.Exception("processout-js.network-issue"))}):t(new e.Exception("applepay.not-supported"))},t.prototype.newSession=function(t,n,o){return new e.ApplePay(this.instance,t)},t}();e.ApplePayWrapper=t}(ProcessOut||(ProcessOut={})),function(e){var t="processoutjs",n="true",o=function(){function o(o,i){if(this.instance=o,!i.source)throw new e.Exception("request.validation.error","Please provide a source to be used to start the 3-D Secure flow.");var r=i.url;if(!r&&i.invoiceID&&(r="/"+this.instance.getProjectID()+"/"+i.invoiceID+"/three-d-s/redirect/"+i.source+"?"+t+"="+n),!r&&(r="/"+this.instance.getProjectID()+"/three-d-s?"+t+"="+n+"&amount="+encodeURIComponent(i.amount)+"&currency="+encodeURIComponent(i.currency)+"&name="+encodeURIComponent(i.name)+"&return_url="+encodeURIComponent(i.returnURL?i.returnURL:"")+"&source="+encodeURIComponent(i.source),i.metadata&&"object"==typeof i.metadata))for(var s in i.metadata)i.metadata.hasOwnProperty(s)&&(r+="&metadata["+s+"]="+encodeURIComponent(i.metadata[s]));if(!r)throw new e.Exception("request.validation.error","Please provide a 3DS challenge URL or an invoice ID.");this.url=r}return o.prototype.handle=function(t,n){return this.instance.handleAction(this.instance.endpoint("checkout",this.url),function(e){t(e)},n,new e.ActionHandlerOptions(e.ActionHandlerOptions.ThreeDSChallengeFlow))},o}();e.ThreeDS=o}(ProcessOut||(ProcessOut={})),function(e){var t=function(){return function(){}}();e.ThreeDSOptions=t;var n=function(){function t(e){this.instance=e}return t.prototype.authenticate=function(t,n,o){return new e.ThreeDS(this.instance,t).handle(n,o)},t}();e.ThreeDSWrapper=n}(ProcessOut||(ProcessOut={})),function(e){var t=function(){function e(){}return e.prototype.token=function(){return"gway_req_"+btoa(JSON.stringify({gateway_configuration_id:this.gatewayConfigurationID,url:this.url,method:this.method,headers:this.headers,body:this.body,prepare:this.prepare}))},e}();e.GatewayRequest=t}(ProcessOut||(ProcessOut={})),function(e){var t=function(){return function(){}}();e.CardHolder=t;var n=function(){function t(e,n){this.month=e,this.year=t.parseYear(n)}return t.parse=function(e){var n=e.split(" / ");n.length<=1&&(n=e.split("/"));var o=Number(n[0]),i=0;return n.length>1&&(i=Number(n[1])),new t(o,i)},t.parseMonth=function(e){var t=Number(e);return t||(t=0),t},t.parseYear=function(e){var t=Number(e);return t||(t=0),t<2e3&&(t+=2e3),t},t.prototype.getMonth=function(){return this.month},t.prototype.getYear=function(){return this.year},t.prototype.string=function(){return this.month+" / "+this.year},t.prototype.validate=function(){var n=t.validateMonth(this.getMonth());if(n)return n;if(n=t.validateYear(this.getYear()))return n;var o=new Date;return this.getMonth()<o.getMonth()&&this.getYear()==o.getFullYear()?new e.Exception("card.invalid-date"):null},t.format=function(e){for(var t="",n=0;n<e.length;n++)-1!=="1234567890 /".indexOf(e[n])&&(t+=e[n]);return 2==t.length?t+" / ":4==t.length?t.slice(0,-3):t},t.validateMonth=function(t){return!t||t<1||t>12?new e.Exception("card.invalid-month"):null},t.validateYear=function(t){t<100&&(t+=2e3);var n=new Date;return!t||t<n.getFullYear()?new e.Exception("card.invalid-year"):null},t}();e.Expiry=n;var o=function(){function t(e,n,o){this.number=t.parseNumber(e),this.cvc=o,this.expiry=n}return t.prototype.getNumber=function(){return this.number},t.prototype.getExpiry=function(){return this.expiry},t.prototype.getCVC=function(){return this.cvc},t.luhn=function(e){for(var t=0,n=!1,o=e.length-1;o>=0;o--){var i=+e[o];n&&(i*=2)>9&&(i-=9),t+=i,n=!n}return t%10==0},t.prototype.validate=function(){var n=t.validateNumber(this.number);return n||(null==this.expiry?new e.Exception("card.invalid-date"):(n=this.expiry.validate())||t.validateCVC(this.cvc))},t.prototype.getIIN=function(){return t.getIIN(this.number)},t.prototype.getLast4Digits=function(){return t.getLast4Digits(this.number)},t.formatNumber=function(e){var n=t.getCardFormat(t.getIIN(e));e=t.parseNumber(e);for(var o="",i=0,r=0,s=0;s<e.length;s++)if(!isNaN(e[s])){if(r>=n[i]){if(r=0,++i>=n.length)break;o+=" "}o+=e[s],r++}return o},t.parseNumber=function(e){return String(e.replace(/ /gi,"").replace(/\-/gi,"").replace(/\-/gi,""))},t.validateNumber=function(n){return(n=t.parseNumber(n)).length<12?new e.Exception("card.invalid-number"):t.luhn(n)?null:new e.Exception("card.invalid-number")},t.validateCVC=function(t){return t&&t.length<3?new e.Exception("card.invalid-cvc"):null},t.getIIN=function(e){var n=(e=t.parseNumber(e)).length;return n>6&&(n=6),e.substring(0,n)},t.getLast4Digits=function(e){var n=(e=t.parseNumber(e)).length;return n>4&&(n=4),e.substr(e.length-n)},t.autoFormatNumber=function(e,n){var o=0;e.addEventListener("input",function(e){var i=this.selectionStart,r=this.value.length;this.value=t.formatNumber(this.value),i&&i<r&&(this.setSelectionRange(i,i),i>0&&" "==this.value[i-1]&&r>o&&this.setSelectionRange(i+1,i+1));var s=t.getPossibleCardLength(t.getIIN(this.value));n&&r>o&&t.parseNumber(this.value).length==s[1]&&n(),o=r})},t.autoFormatExpiry=function(e,t){var o=0;e.addEventListener("input",function(e){var i=this.selectionStart,r=this.value.length,s=n.format(this.value);s.length>7||(this.value=s,i&&i<r&&(this.setSelectionRange(i,i),i>0&&" "==this.value[i-1]&&r>o&&this.setSelectionRange(i+1,i+1)),t&&r>o&&7==this.value.length&&t(),o=r)})},t.getCardFormat=function(e){var n=t.getPossibleSchemes(e);return 1==n.length&&"american-express"==n[0]?[4,6,5]:[4,4,4,4,4]},t.getPossibleCardLength=function(e){for(var n=19,o=12,i=t.getPossibleSchemes(e),r=0;r<i.length;r++)switch(i[r]){case"visa":n=Math.min(n,13),o=Math.max(o,19);break;case"mastercard":case"instapayment":case"jcb":case"cardguard ead bg ils":case"elo":case"hipercard":n=Math.min(n,16),o=Math.max(o,16);break;case"american-express":case"uatp":n=Math.min(n,15),o=Math.max(o,15);break;case"diners-club":n=Math.min(n,14),o=Math.max(o,16);break;case"union-pay":case"discover":case"interpayment":case"dankort":case"naranja":case"cabal":case"argencard":n=Math.min(n,16),o=Math.max(o,19);break;case"maestro":n=Math.min(n,12),o=Math.max(o,19)}return n>o&&(n=12,o=19),[n,o]},t.getPossibleSchemes=function(e){e=t.parseNumber(e);var n={visa:["4"],mastercard:["22","23","24","25","26","27","51","52","53","54","55"],"american-express":["34","37"],"union-pay":["62"],"diners-club":["300","301","302","303","304","305","309","36","38","39"],discover:["6011","62","64","65"],jcb:["35"],maestro:["50","56","57","58","59","6"],dankort:["5019","4175","4571"],uatp:["1"],"cardguard ead bg ils":["5392"],hipercard:["606282"],elo:["401178","401179","438935","451416","457632","457393","431274","438935","457631","457632","506699","50670","50671","50672","50673","50674","50675","50676","506770","506771","506772","506773","506774","506775","506776","506777","506778","504175","509","627780","636297","636368","651652","651653","651654","651655","651656","651657","651658","651659","65166","65167","650031","650032","650033","650035","650036","650037","650038","650039","65004","650050","650051","65500","65501","650485","650486","650487","650488","650489","65049","65050","65051","65052","650530","650531","650532","650533","650534","650535","650536","650537","650538","650541","650542","650543","650544","650545","650546","650547","650548","650549","65055","65056","65057","65058","650590","650591","650592","650593","650594","650595","650596","650597","650598","65070","650710","650711","650712","650713","650714","650715","650716","650717","650718","650720","650721","650722","650723","650724","650725","650726","650727","655021","655022","655023","655024","655025","655026","655027","655028","655029","65503","65504","655050","655051","655052","655053","655054","655055","655056","655057","655058","650901","650902","650903","650904","650905","650906","650907","650908","650909","65091","65092","65093","65094","65095","65096","650970","650971","650972","650973","650974","650975","650976","650977","650978","650405","650406","650407","650408","650409","65041","65042","65043"],naranja:["377798","377799","402917","402918","527571","527572","589562"],cabal:["589657","600691","603522","6042","6043","636908"],argencard:["501105"],"carte bancaire":["49707","49783","49771","45950","45334","51336","49836","47722","45721","54515","49732","51345","45626","49774","49734","49738","40220","53253","56125","49835","49715","58171","45619","45954","49793","43782","41506","49773","53710","51338","53102","45940","45627","49766","46978","49720","45611","49902","55700","49796","49733","45930","55961","49792","51348","52945","49708","49726","45610","44995","49739","41507","47717","54985","58170","51327","47260","45335","43951","51365","43950","49746","40100","45629","49731","51810","45332","42011","55420","42346","41993","45333","49723","51361","49719","45929","55426","44244","51330","55981","49752","45621","49764","49755","51321","45615","49765","51375","47802","51372","49742","51377","55886","49837","51623","46983","49716","55391","67759","45613","45568","49758","46609","47480","44841","45958","51320","47729","51319","49722","51317","49745","67117","49797","51313","49714","49704","47726","44996","42012","49791","49749","51341","41503","51325","55980","46657","49711","52948","51371","49717","49838","51314","46703","40355","51324","51350","55892","53103","51353","43783","55496","49839","45612","45620","46547","51316","49763","49721","51379","49728","49770","49776","51521","49909","45616","52954","51312","49901","45939","49712","49775","45720","52166","49735","46982","51337","46361","51374","49788","47961","49785","49741","51385","46986","51364","49795","51992","49703","45937","51323","52931","45617","49760","53119","49709","49724","45566","45623","52922","46969","53506","51360","47427","45560","40593","45628","51357","41505","51315","45337","52942","53610","53611","40594","45624","48651","51366","45567","46896","40657","51750","52933","49756","52943","49790","54953","49761","45056","48373","49906","47809","54284","48369","51332","55399","44855","40223","49777","43787","58175","41509","45614","48160","51301","49754","49753","45054","46980","49737","52920","51356","49713","49706","49725","51390","49779","51370","51318","47268","51354","49750","51386","40221","51367","49744","49730","51373","45771","51736","45745","53411","52371","51300","43953","47718","49748","58177","53711","58176","52886","48362","45330","44245","49740","45622","46625","41717","51302","44997","52944","51369","49747","49772","58178","49768","52941","51363","51362","49781","45618","53234","49789","51326","49799","40209","45331","49702","58173","58174","49743","51352","51311","45625","51335","49905","49786","41628","49798","58179","53801","49767","45339","49769","53250","51328","49782","53410","58172","49778","45051","49736","49718","49900","49903","49784","55397","46321","51376","51331","49710","56124","44853","49759","51351","52949","53532","49904","49787","51322","49762","55888","51620","49794","51355","45932","52946","49780","49757","49729","52947","51310","51329","53502","49751","53255","51378","51303","49727","45933"]},o=new Array;for(var i in n){var r=n[i];for(var s in r){var a=r[s],c=e.length>a.length?a.length:e.length;if(e.substring(0,c)==a.toString().substring(0,c)){o.push(i);break}}}return o},t}();e.Card=o}(ProcessOut||(ProcessOut={})),function(e){var t=function(){return function(){this.number=null,this.expiryMonth=null,this.expiryYear=null,this.cvc=null,this.name=null,this.metadata=null}}();e.CardFieldValue=t;var n=function(){function e(e){this.type=e}return e.prototype.apply=function(e){return e.placeholder&&(this.placeholder=e.placeholder),e.style&&(this.style=e.style),this},e}();e.CardFieldOptions=n;var o=function(){return function(){}}();e.CardFieldStyle=o;var i=function(){function t(n,o,i,r,s,a){if(this.handlers={},!i||!i.type)throw new e.Exception("processout-js.invalid-field-type","Options and a the field type must be provided to setup the field.");if(!r)throw new e.Exception("processout-js.undefined-field","The card field for the "+i.type+" does not exist in the given container.");if(r instanceof HTMLInputElement)throw new e.Exception("processout-js.invalid-field","The card field for the "+i.type+" must be an input field.");if(i.type!=t.number&&i.type!=t.expiry&&i.type!=t.expiryMonth&&i.type!=t.expiryYear&&i.type!=t.cvc)throw new e.Exception("processout-js.invalid-field-type");this.instance=n,this.form=o,this.options=i,this.el=r;var c=this.el.getAttribute("data-processout-placeholder");c&&(this.options.placeholder=c),this.spawn(s,a)}return t.prototype.spawn=function(n,o){var i=Math.random().toString(36).substring(7);this.uid="#"+i;var r=this.instance.getProcessOutFieldEndpoint("?r="+i+this.uid);this.iframe=document.createElement("iframe"),this.iframe.className="processout-field-cc-iframe",this.iframe.name=i,this.iframe.setAttribute("src",r),this.iframe.setAttribute("style","background: none; width: 100%;"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allowtransparency","1"),this.iframe.style.display="none",this.iframe.height="14px";var s=!1,a=setTimeout(function(){s=!0,typeof o==typeof Function&&o(new e.Exception("processout-js.field.unavailable"))},t.timeout);this.iframe.onload=function(){try{this.iframe.src=r}catch(e){}}.bind(this),window.addEventListener("message",function(t){if(!s){var o=e.Message.parseEvent(t);o.frameID==this.uid&&o.namespace==e.Message.fieldNamespace&&(this.handlEvent(o),"alive"==o.action&&this.iframe.contentWindow.postMessage(JSON.stringify({namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"setup",formID:this.form.getUID(),data:this.options}),"*"),"ready"==o.action&&(this.iframe.style.display="block",clearTimeout(a),n(),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"resize"}),"*"),this.iframe.addEventListener("focus",function(e){this.focus()}.bind(this))))}}.bind(this)),this.el.appendChild(this.iframe)},t.prototype.handlEvent=function(e){var t={field:this,type:this.options.type,element:this.el,data:e.data};switch(e.action){case"inputEvent":this.eventCallback&&this.eventCallback("oninput",t);break;case"mouseEnterEvent":this.eventCallback&&this.eventCallback("onmouseenter",t);break;case"mouseLeaveEvent":this.eventCallback&&this.eventCallback("onmouseleave",t);break;case"focusEvent":this.el.className=this.el.className+" processout-input-focused",this.eventCallback&&this.eventCallback("onfocus",t);break;case"blurEvent":this.el.className=this.el.className.replace(/\bprocessout-input-focused\b/g,"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),this.eventCallback&&this.eventCallback("onblur",t);break;case"next":this.next&&this.next();break;case"event":if(e.data.name in this.handlers)for(var n=this.handlers[e.data.name],o=0;o<n.length;o++)n[0](e.data.data);break;case"resize":this.iframe.height=e.data}},t.prototype.setNext=function(e){this.next=e},t.prototype.update=function(t){t.placeholder&&(this.options.placeholder=t.placeholder),t.style&&(this.options.style=Object.assign(this.options.style,t.style)),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"update",data:this.options}),"*")},t.prototype.addEventListener=function(t,n){t in this.handlers||(this.handlers[t]=[]),this.handlers[t].push(n),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"registerEvent",data:t}),"*")},t.prototype.on=function(e,t){return this.addEventListener(e,t)},t.prototype.blur=function(){this.iframe.contentWindow.postMessage(JSON.stringify({messageID:Math.random().toString(),namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"blur"}),"*")},t.prototype.focus=function(){this.iframe.contentWindow.postMessage(JSON.stringify({messageID:Math.random().toString(),namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"focus"}),"*")},t.prototype.validate=function(n,o){var i=Math.random().toString();this.iframe.contentWindow.postMessage(JSON.stringify({messageID:i,namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"validate"}),"*");var r=setTimeout(function(){o(new e.Exception("processout-js.field.unavailable"))},t.timeout);window.addEventListener("message",function(t){var s=e.Message.parseEvent(t);s.frameID==this.uid&&s.namespace==e.Message.fieldNamespace&&s.messageID==i&&"validate"==s.action&&(clearTimeout(r),s.data?o(new e.Exception(s.data)):n())}.bind(this))},t.prototype.tokenize=function(n,o,i,r){var s=Math.random().toString();this.iframe.contentWindow.postMessage(JSON.stringify({messageID:s,namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"tokenize",data:{fields:n,data:o}}),"*");var a=setTimeout(function(){r(new e.Exception("processout-js.field.unavailable"))},t.timeout);window.addEventListener("message",function(t){var n=e.Message.parseEvent(t);n.messageID==s&&"tokenize"==n.action&&(clearTimeout(a),n.data.token?i(n.data.token):n.data.error?r(new e.Exception(n.data.error.code,n.data.error.message)):r(new e.Exception("default")))}.bind(this))},t.prototype.refreshCVC=function(n,o,i){var r=Math.random().toString();this.iframe.contentWindow.postMessage(JSON.stringify({messageID:r,namespace:e.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"refresh-cvc",data:n}),"*");var s=setTimeout(function(){i(new e.Exception("processout-js.field.unavailable"))},t.timeout);window.addEventListener("message",function(t){var n=e.Message.parseEvent(t);n.messageID==r&&"refresh-cvc"==n.action&&(clearTimeout(s),n.data.token?o(n.data.token):n.data.error?i(new e.Exception(n.data.error.code,n.data.error.message)):i(new e.Exception("default")))}.bind(this))},t.number="number",t.expiry="expiry",t.expiryMonth="expiry-month",t.expiryYear="expiry-year",t.cvc="cvc",t.timeout=2e4,t}();e.CardField=i}(ProcessOut||(ProcessOut={})),function(e){var t=function(){function t(e,t){this.instance=e,this.element=t,this.uid=Math.random().toString()}return t.prototype.getUID=function(){return this.uid},t.prototype.setup=function(t,n,o){var i=!1,r=!1,s=!1,a=!1,c=function(){if(i&&r&&s&&a)return this.number.setNext(function(){this.exp&&this.exp.focus(),this.expMonth&&this.expMonth.focus()}.bind(this)),this.exp&&this.exp.setNext(function(){this.cvc&&this.cvc.focus()}.bind(this)),void n(this)}.bind(this);this.number=new e.CardField(this.instance,this,new e.CardFieldOptions(e.CardField.number).apply(t),this.element.querySelector("[data-processout-input=cc-number]"),function(){i=!0,c()},o);var u=this.element.querySelector("[data-processout-input=cc-cvc]");u?this.cvc=new e.CardField(this.instance,this,new e.CardFieldOptions(e.CardField.cvc).apply(t),u,function(){r=!0,c()},o):r=!0;var d=this.element.querySelector("[data-processout-input=cc-exp]");return d?this.exp=new e.CardField(this.instance,this,new e.CardFieldOptions(e.CardField.expiry).apply(t),d,function(){s=!0,a=!0,c()},o):(this.expMonth=new e.CardField(this.instance,this,new e.CardFieldOptions(e.CardField.expiryMonth).apply(t),this.element.querySelector("[data-processout-input=cc-exp-month]"),function(){s=!0,c()},o),this.expYear=new e.CardField(this.instance,this,new e.CardFieldOptions(e.CardField.expiryYear).apply(t),this.element.querySelector("[data-processout-input=cc-exp-year]"),function(){a=!0,c()},o)),this},t.prototype.setupCVC=function(t,n,o){return this.isRefreshCVC=!0,this.cvc=new e.CardField(this.instance,this,new e.CardFieldOptions(e.CardField.cvc).apply(t),this.element.querySelector("[data-processout-input=cc-cvc]"),function(){n(this)}.bind(this),o),this},t.prototype.getElement=function(){return this.element},t.prototype.addEventListener=function(e,t,n){return this.element.addEventListener(e,t,n)},t.prototype.on=function(e,t,n){return this.element.addEventListener(e,t,n)},t.prototype.getNumberField=function(){return this.number},t.prototype.getCVCField=function(){return this.cvc},t.prototype.getExpiryField=function(){return this.exp},t.prototype.getExpiryMonthField=function(){return this.expMonth},t.prototype.getExpiryYearField=function(){return this.expYear},t.prototype.validate=function(e,t){if(this.isRefreshCVC)this.cvc.validate(function(){e()},t);else{var n=!1,o=!1,i=!1,r=!1,s=function(){n&&o&&i&&r&&e()};this.number.validate(function(){n=!0,s()},t),this.cvc?this.cvc.validate(function(){o=!0,s()},t):o=!0,this.exp?this.exp.validate(function(){i=!0,r=!0,s()},t):(this.expMonth.validate(function(){i=!0,s()},t),this.expYear.validate(function(){r=!0,s()},t))}},t.prototype.tokenize=function(e,t,n){var o=["number"];this.cvc&&o.push("cvc"),this.exp&&o.push("exp"),this.expMonth&&o.push("exp-month"),this.expYear&&o.push("exp-year"),this.number.tokenize(o,e,t,n)},t.prototype.refreshCVC=function(t,n,o){this.cvc||o(new e.Exception("processout-js.wrong-type-for-action","RefreshCVC was called but the form has no CVC field initialized.")),this.cvc.refreshCVC(t,n,o)},t}();e.CardForm=t}(ProcessOut||(ProcessOut={})),function(e){var t={en:{default:"An error occured: your payment was declined.","card.declined":"The credit card has been declined.","card.expired":"The given card has expired.","card.duplicate":"The payment could not be completed. Please try again later.","card.network-failed":"The payment could not be completed. Please try again later.","card.invalid":"The given card is invalid.","card.invalid-name":"The cardholder name is invalid.","card.invalid-number":"The card number is invalid.","card.invalid-date":"The card expiry date is invalid.","card.invalid-month":"The card expiry month is invalid.","card.invalid-year":"The card expiry year is invalid.","card.invalid-cvc":"The card CVC is invalid.","card.invalid-zip":"The card's ZIP code is valid.","card.failed-cvc-and-avs":"The CVC and AVS code were invalid.","card.failed-three-d-s":"The 3D-Secure authentication failed.","card.bad-track-data":"The card could not be verified. Maybe your CVC is invalid?","card.not-registered":"The card is not registered.","card.issuer-not-found":"The card issuer could not be found. Please try another card.","card.possible-fraud":"The payment could not be completed. Please contact your bank for further help.","card.contact-bank":"The payment could not be completed. Please contact your bank for further help.","card.not-authorized":"The payment could not be authorized using the provided card.","card.do-not-honor":"The payment could not be completed. Please contact your bank for further help.","card.maximum-attempts":"The card maximum attempts has been reached and the payment could not be processed.","card.stolen":"The payment could not be processed as the provided card was marked as stolen.","card.lost":"The payment could not be processed as the provided card was marked as lost.","card.exceeded-limits":"The payment could not be processed as the payment limits of the card have been exceeded.","card.no-money":"There doesn't seem to be enough money on the bank account linked to the provided card.","customer.canceled":"The customer canceled the payment.","customer.popup-blocked":"Please allow pop-ups to continue with your payment flow.","gateway.declined":"The payment was declined.","payment.declined":"The payment was declined.","payment.pending":"The payment is currently pending, please wait a few minutes for it to fully go through.","three-d-s-2.fingerprint-timed-out":"The 3-D Secure fingerprinting timed out.","request.validation.error":"The provided information is invalid or missing.","request.validation.invalid-country":"The provided country is invalid.","request.validation.missing-name":"A name must be provided.","request.validation.invalid-name":"The provided name is invalid.","request.validation.missing-email":"An email must be provided.","request.validation.invalid-email":"The provided email is invalid.","request.validation.invalid-address":"The provided address is invalid.","request.validation.no-method-selected":"Please select a payment method.","request.gateway.not-available":"The requested gateway is currently unavailable.","request.gateway.not-supported":"The gateway is not supported by ProcessOut.js","processout-js.missing-project-id":"Your project ID was not specified when loading ProcessOut.js.","processout-js.not-hosted":"ProcessOut.js was not loaded from ProcessOut CDN. Please do not host ProcessOut.js yourself but rather use ProcessOut CDN: https://js.processout.com/processout.js","processout-js.modal.unavailable":"The ProcessOut.js modal is unavailable.","processout-js.field.unavailable":"The ProcessOut.js credit card field is unavailable.","processout-js.invalid-config":"The provided gateway configuration is invalid.","processout-js.no-customer-action":"No customer action is required for the given gateway configuration and resource.","processout-js.customer-action-not-supported":"The requested customer action is not supported by ProcessOut.js.","processout-js.invalid-field":"The given HTML element may not be used by ProcessOut.js: it is an input. Please only use divs when creating a ProcessOut.js credit card field.","processout-js.undefined-field":"The given HTML element was undefined.","processout-js.invalid-field-type":"The given field type was incorrect. It must either be number, expiry, expiryMonth, expiryYear or CVC.","processout-js.network-issue":"There seems to be some connectivity issue preventing the payment from making it through. Please switch to another network or try again in a few minutes.","processout-js.invalid-type":"The specified parameter had an unknown type.","processout-js.missing-source":"A source must be specified.","processout-js.wrong-type-for-action":"The requested action could not be performed on the given field because its type is invalid.","processout-js.missing-invoice-id":"An invoice ID must be specified.","processout-js.missing-resource-id":"A resource ID must be specified.","resource.invalid-type":"The provided resource was invalid. It must be an invoice, a subscription or an authorization request.","applepay.not-supported":"The current browser/device does not support Apple Pay.","applepay.no-success-handler":"A success handler must be specified when setting up Apple Pay.","applepay.not-available":"Apple Pay is not available for the current browser, device or ProcessOut project."},fr:{default:"Une erreur est survenue lors du paiement."}},n={en:{"label.cancel":"Cancel","label.apm-description":"A new window was opened to process your payment. Click here to continue."},fr:{"label.cancel":"Annuler","label.apm-description":"Une nouvelle fen&ecirc;tre s'est ouverte pour proc&eacute;der au paiement. Cliquez ici pour continuer."}},o=function(){function e(){}return e.getTranslated=function(e,t,n){return e[this.getLocale()]&&e[this.getLocale()][t]?e[this.getLocale()][t]:e.en[t]?e.en[t]:n||(e[this.getLocale()]&&e[this.getLocale()].default?e[this.getLocale()].default:e.en.default?e.en.default:t)},e.translateError=function(e,n){return this.getTranslated(t,e,n)},e.translateMessage=function(e,t){return this.getTranslated(n,e,t)},e.getLocale=function(){var e=navigator.language||navigator.userLanguage;return e.length<2?"en":e.substring(0,2).toLowerCase()},e}();e.Translator=o}(ProcessOut||(ProcessOut={})),function(e){var t=function(t){function n(n,o){var i=this;return o||(o=e.Translator.translateError(n)),(i=t.call(this,o)||this).code=n,i.message=o,i.name="ProcessOutException",i.stack=(new Error).stack,i}return __extends(n,t),n}(Error);e.Exception=t}(ProcessOut||(ProcessOut={})),function(e){e.DEBUG=!1,e.TestModePrefix="test-";var t=function(){function t(t,n){this.timeout=1e4,this.sandbox=!1,this.host="processout.com",this.processOutFieldEndpoint="",this.apiVersion="1.3.0.0";var o=document.getElementsByTagName("script"),i="";if(/^https?:\/\/.*\.processout\.((com)|(ninja)|(dev))\//.test(window.location.href))i=window.location.href;else for(var r=0;r<o.length;r++)/^https?:\/\/.*\.processout\.((com)|(ninja)|(dev))\//.test(o[r].getAttribute("src"))&&(i=o[r].getAttribute("src"));if(""==i&&!e.DEBUG)throw new e.Exception("processout-js.not-hosted");if(/^https?:\/\/.*\.processout\.ninja\//.test(i)?this.host="processout.ninja":/^https?:\/\/.*\.processout\.dev\//.test(i)?this.host="processout.dev":this.host="processout.com",!t)throw new e.Exception("processout-js.missing-project-id");if(this.projectID=t,0===this.projectID.lastIndexOf(e.TestModePrefix,0)&&(this.sandbox=!0),this.resourceID=n,this.resourceID&&""!=this.resourceID&&"iv_"!=this.resourceID.substring(0,3)&&"sub_"!=this.resourceID.substring(0,4)&&"auth_req_"!=this.resourceID.substring(0,9))throw new e.Exception("resource.invalid-type");this.applePay=new e.ApplePayWrapper(this),this.threeDS=new e.ThreeDSWrapper(this)}return t.prototype.getResourceID=function(){return this.resourceID},t.prototype.getProjectID=function(){return this.projectID},t.prototype.getProcessOutFieldEndpoint=function(t){var n=this.endpoint("js","/ccfield.html");return e.DEBUG&&this.processOutFieldEndpoint&&(n=this.processOutFieldEndpoint),""+n+t},t.prototype.setProcessOutFieldEndpoint=function(t){e.DEBUG&&(this.processOutFieldEndpoint=t)},t.prototype.endpoint=function(e,t){return"https://"+e+"."+this.host+t},t.prototype.apiRequest=function(e,t,n,o,i,r){r||(r=0),e=e.toLowerCase(),"http"!=t.substring(0,4)&&"/"!=t[0]&&(t=this.endpoint("api","/"+t));var s={"Content-Type":"application/json","API-Version":this.apiVersion};for(var a in this.projectID&&(s.Authorization="Basic "+btoa(this.projectID+":")),n||(n={}),n.idempotency_key&&(s["Idempotency-Key"]=n.idempotency_key,delete n.idempotency_key),t+="?legacyrequest=true&project_id="+this.projectID,s)t+="&x-"+a+"="+s[a];if("get"==e)for(var c in n)t+="&"+c+"="+encodeURIComponent(n[c]);var u=new XMLHttpRequest;if(window.XDomainRequest&&(u=new XDomainRequest),u.open(e,t,!0),!window.XDomainRequest)for(var a in s)u.setRequestHeader(a,s[a]);u.timeout=0,u.onload=function(e){var t;try{t=JSON.parse(u.responseText)}catch(e){t={}}window.XDomainRequest?o(t,u,e):4==e.currentTarget.readyState&&o(t,u,e)},u.onerror=function(e){u.status&&u.status>=200&&u.status<500&&u.responseText?u.onload(e):i(u,e)},u.ontimeout=function(){},u.onprogress=function(){},u.onabort=function(){r>3?i(u,null):this.request(e,t,n,o,i,r+1)}.bind(this),u.send(JSON.stringify(n))},t.prototype.setupForm=function(t,n,o,i){if(!this.projectID)throw new e.Exception("default","You must instanciate ProcessOut.js with a valid project ID in order to use ProcessOut's hosted forms.");if(!t)throw new e.Exception("default","The provided form element wasn't set. Make sure to provide setupForm with a valid form element.");return"function"==typeof n?new e.CardForm(this,t).setup(new e.CardFieldOptions(""),n,o):new e.CardForm(this,t).setup(n,o,i)},t.prototype.tokenize=function(t,n,o,i){if(t instanceof e.Card)return this.tokenizeCard(t,n,o,i);if(t instanceof e.CardForm)return this.tokenizeForm(t,n,o,i);if(t instanceof e.ApplePay)return t.tokenize(n,o,i);throw new e.Exception("processout-js.invalid-type","The first parameter had an unknown type/instance. The value must be an instance of either Card, CardForm or ApplePay.")},t.prototype.tokenizeCard=function(t,n,o,i){var r=t.validate();r?i(r):(n||(n={}),n.contact||(n.contact={}),(n=this.injectDeviceData(n)).number=t.getNumber(),n.exp_month=t.getExpiry().getMonth().toString(),n.exp_year=t.getExpiry().getYear().toString(),n.cvc2=t.getCVC(),this.apiRequest("post","cards",n,function(t,n,r){t.success?o(t.card.id):i(new e.Exception(t.error_type,t.message))},function(t,n){i(new e.Exception("processout-js.network-issue"))}))},t.prototype.injectDeviceData=function(e){screen.colorDepth&&(e.app_color_depth=Number(screen.colorDepth));var t=navigator.language||navigator.userLanguage;return t&&(e.app_language=t),screen.height&&(e.app_screen_height=screen.height),screen.width&&(e.app_screen_width=screen.width),e.time_zone_offset=Number((new Date).getTimezoneOffset()),window.navigator&&(e.app_java_enabled=window.navigator.javaEnabled()),e},t.prototype.tokenizeForm=function(e,t,n,o){e.validate(function(){e.tokenize(t,n,o)}.bind(this),o)},t.prototype.setupFormCVC=function(t,n,o,i){return"function"==typeof n?new e.CardForm(this,t).setupCVC(new e.CardFieldOptions(""),n,o):new e.CardForm(this,t).setupCVC(n,o,i)},t.prototype.refreshCVC=function(t,n,o,i){return n instanceof e.CardForm?this.refreshCVCForm(t,n,o,i):this.refreshCVCString(t,n,o,i)},t.prototype.refreshCVCForm=function(e,t,n,o){t.validate(function(){t.refreshCVC(e,n,o)}.bind(this),o)},t.prototype.refreshCVCString=function(t,n,o,i){var r=e.Card.validateCVC(n);r?i(r):this.apiRequest("put","cards/"+t,{cvc:n},function(t,n,r){t.success?o(t.card.id):i(new e.Exception("card.invalid"))},function(t,n){i(new e.Exception("processout-js.network-issue"))})},t.prototype.newModal=function(t,n,o){var i="";if("object"==typeof t&&(i=t.url,n=t.onReady,o=t.onError,!i&&(i=this.endpoint("checkout","/"+this.getProjectID()+"/oneoff?amount="+encodeURIComponent(t.amount)+"&currency="+encodeURIComponent(t.currency)+"&name="+encodeURIComponent(t.name)),t.metadata&&"object"==typeof t.metadata)))for(var r in t.metadata)t.metadata.hasOwnProperty(r)&&(i+="&metadata["+r+"]="+encodeURIComponent(t.metadata[r]));var s=Math.random().toString(36).substr(2,9),a=document.createElement("iframe");a.className="processout-iframe",a.setAttribute("id","processout-iframe-"+s),a.setAttribute("src",i),a.setAttribute("style","position: fixed; top: 0; left: 0; background: none; z-index: 9999999;"),a.setAttribute("frameborder","0"),a.setAttribute("allowtransparency","1"),a.style.display="none";var c=setTimeout(function(){typeof o==typeof Function&&o(new e.Exception("processout-js.modal.unavailable"))},this.timeout);a.onload=function(){clearTimeout(c),typeof n==typeof Function&&n(new e.Modal(this,a,s))}.bind(this),document.body.appendChild(a)},t.prototype.fetchGatewayConfigurations=function(t,n,o){if(t||(t={}),!t.invoiceID&&!t.customerID!=!t.tokenID)throw new e.Exception("processout-js.missing-resource-id");this.apiRequest("GET","gateway-configurations",{filter:t.filter,expand_merchant_accounts:"true"},function(i){if(i.success){for(var r=[],s=0,a=i.gateway_configurations;s<a.length;s++){var c=a[s];c.getInvoiceActionURL=this.buildGetInvoiceActionURL(t.invoiceID,c),c.handleInvoiceAction=this.buildHandleInvoiceAction(t.invoiceID,c),c.hookForInvoice=this.buildConfHookForInvoice(c),c.getCustomerTokenActionURL=this.buildGetCustomerTokenActionURL(t.customerID,t.tokenID,c),c.handleCustomerTokenAction=this.buildHandleCustomerTokenAction(t.customerID,t.tokenID,c),c.hookForCustomerToken=this.buildConfHookForCustomerToken(c),r.push(c)}n(r)}else o(new e.Exception(i.error_type,i.message))}.bind(this),function(t,n){o(new e.Exception("processout-js.network-issue"))})},t.prototype.getInvoiceActionURL=function(t,n){var o=n;if(n&&n.id&&(o=n.id),!t)throw new e.Exception("processout-js.missing-resource-id","An Invoice Action was requested, but the Invoice ID was missing. Make sure you didn't rather want to call `customerToken` helpers on the gateway configuration instead of `invoice` ones.");return this.endpoint("checkout","/"+this.getProjectID()+"/"+t+"/redirect/"+o)},t.prototype.handleInvoiceAction=function(t,n,o,i){var r=null,s=null;n&&n.id&&n.gateway&&(r=n.gateway.name,s=n.gateway.logo_url);var a=new e.ActionHandlerOptions(r,s);return this.handleAction(this.getInvoiceActionURL(t,n),o,i,a)},t.prototype.buildGetInvoiceActionURL=function(e,t){return function(){return this.getInvoiceActionURL(e,t)}.bind(this)},t.prototype.buildHandleInvoiceAction=function(e,t){return function(n,o){return this.handleInvoiceAction(e,t,n,o)}.bind(this)},t.prototype.buildConfHookForInvoice=function(e){return function(t,n,o){t.addEventListener("click",function(t){return t.preventDefault(),e.handleInvoiceAction(n,o),!1}.bind(this))}.bind(this)},t.prototype.getCustomerTokenActionURL=function(t,n,o){var i=o;if(o&&o.id&&(i=o.id),!t||!n)throw new e.Exception("processout-js.missing-resource-id","A Customer Token Action was requested, but a customer ID or a token ID was missing. Make sure you didn't rather want to call `invoice` helpers on the gateway configuration instead of `customerToken` ones.");return this.endpoint("checkout","/"+this.getProjectID()+"/"+t+"/"+n+"/redirect/"+i)},t.prototype.handleCustomerTokenAction=function(t,n,o,i,r){var s=null,a=null;o&&o.id&&o.gateway&&(s=o.gateway.name,a=o.gateway.logo_url);var c=new e.ActionHandlerOptions(s,a);return this.handleAction(this.getCustomerTokenActionURL(t,n,o),i,r,c)},t.prototype.buildGetCustomerTokenActionURL=function(e,t,n){return function(){return this.getCustomerTokenActionURL(e,t,n)}.bind(this)},t.prototype.buildHandleCustomerTokenAction=function(e,t,n){return function(o,i){return this.handleCustomerTokenAction(e,t,n,o,i)}.bind(this)},t.prototype.buildConfHookForCustomerToken=function(e){return function(t,n,o){t.addEventListener("click",function(t){return t.preventDefault(),e.handleCustomerTokenAction(n,o),!1}.bind(this))}.bind(this)},t.prototype.handleAction=function(t,n,o,i){return new e.ActionHandler(this,i).handle(t,n,o)},t.prototype.makeCardToken=function(t,n,o,i,r,s){return t instanceof e.Card||t instanceof e.CardForm?this.tokenize(t,i,function(e){return this.makeCardTokenFromCardID(e,n,o,i,r,s)}.bind(this),s):this.makeCardTokenFromCardID(t,n,o,i,r,s)},t.prototype.makeCardTokenFromCardID=function(t,n,o,i,r,s){i||(i={});var a={source:t,verify:i.verify,verify_metadata:i.verify_metadata,set_default:i.set_default};this.apiRequest("PUT","customers/"+n+"/tokens/"+o,a,function(t){t.success?t.customer_action?s(new e.Exception("processout-js.wrong-type-for-action","makeCardToken doesn't support customer actions yet.")):r(o):s(new e.Exception(t.error_type,t.message))}.bind(this),function(t,n){s(new e.Exception("processout-js.network-issue"))})},t.prototype.makeCardPayment=function(t,n,o,i,r){o||(o={});var s=n;o.gatewayRequestSource&&(s=o.gatewayRequestSource);var a={authorize_only:o.authorize_only,capture_amount:o.capture_amount,auto_capture_at:o.auto_capture_at,source:s,enable_three_d_s_2:!0};a=this.injectDeviceData(a),o.idempotency_key&&(o.iterationNumber||(o.iterationNumber=1),a.idempotency_key=o.idempotency_key+"-"+o.iterationNumber,o.iterationNumber++),this.apiRequest("POST","invoices/"+t+"/capture",a,function(s){if(s.success)if(s.customer_action){var a=function(e){o.gatewayRequestSource=e,this.makeCardPayment(t,n,o,i,r)}.bind(this);switch(s.customer_action.type){case"url":this.handleAction(s.customer_action.value,function(e){o.gatewayRequestSource=null,this.makeCardPayment(t,n,o,i,r)}.bind(this),r,new e.ActionHandlerOptions(e.ActionHandlerOptions.ThreeDSChallengeFlow));break;case"fingerprint":this.handleAction(s.customer_action.value,a,function(t){var n=new e.GatewayRequest;n.url=s.customer_action.value,n.method="POST",n.headers={"Content-Type":"application/json"},n.body='{"threeDS2FingerprintTimeout":true}',a(n.token())},new e.ActionHandlerOptions(e.ActionHandlerOptions.ThreeDSFingerprintFlow));break;case"redirect":this.handleAction(s.customer_action.value,a,r,new e.ActionHandlerOptions(e.ActionHandlerOptions.ThreeDSChallengeFlow));break;default:r(new e.Exception("processout-js.wrong-type-for-action","The customer action type "+s.customer_action.type+" is not supported."))}}else i(t);else r(new e.Exception(s.error_type,s.message))}.bind(this),function(t,n){r(new e.Exception("processout-js.network-issue"))})},t}();e.ProcessOut=t}(ProcessOut||(ProcessOut={})),function(e){var t=function(){function t(e,t,n){this.deleted=!1,this.timeout=1e4,this.instance=e,this.iframe=t,this.uniqId=n}return t.prototype.show=function(t,n,o){var i,r,s,a=t;"object"==typeof t&&(a=t.onShow,n=t.onHide,o=t.onError,i=t.onPayment,r=t.onPaymentError,s=t.hideAfterSuccessTimeout),null==s&&(s=2500);var c=this,u=c.iframe,d=u.contentWindow,p=c.uniqId;d.postMessage(JSON.stringify({namespace:e.Message.modalNamespace,frameID:p,action:"check"}),"*");var l=setTimeout(function(){typeof o==typeof Function&&o(c,new e.Exception("processout-js.modal.unavailable"))},this.timeout);window.addEventListener("message",function(t){var h=e.Message.parseEvent(t);if(h.frameID==p&&h.namespace==e.Message.modalNamespace)switch(h.action){case"openModal":if(clearTimeout(l),document.body.style.overflow="hidden",window.addEventListener("resize",function(e){u.width=window.outerWidth+"px",u.height=window.outerHeight+"px"}),"function"==typeof Event)var f=new Event("resize");else{f=document.createEvent("Event");t.initEvent("resize",!0,!0)}window.dispatchEvent(f),u.style.display="block",d.postMessage(JSON.stringify({namespace:e.Message.modalNamespace,frameID:p,action:"launch"}),"*"),typeof a==typeof Function&&a(c);break;case"closeModal":c.hide(),typeof n==typeof Function&&n(c);break;case"error":clearTimeout(l),typeof o==typeof Function&&o(c,new e.Exception(h.errorCode,h.errorMessage));break;case"onPayment":typeof i==typeof Function&&i(c,h.data),s>0&&setTimeout(function(){c.hide()},s);break;case"onPaymentError":typeof r==typeof Function&&r(c,new e.Exception(h.errorCode,h.errorMessage));break;default:console.log("Could not read event action from modal.",t.data)}},!1)},t.prototype.hide=function(){this.iframe.style.display="none",document.body.style.overflow="",this.iframe.remove(),this.deleted=!0},t.prototype.isDeleted=function(){return this.deleted},t}();e.Modal=t}(ProcessOut||(ProcessOut={})),function(e){var t=function(){function e(){}return e.parseEvent=function(t){try{return JSON.parse(t.data)}catch(t){return new e}},e.modalNamespace="processout.modal",e.checkoutNamespace="processout.checkout",e.fieldNamespace="processout.field",e}();e.Message=t}(ProcessOut||(ProcessOut={})),function(){for(var e=document.querySelectorAll(".processout-modal-button"),t=0;t<e.length;t++){!function(){var n=e[t],o=!1,i=null,r=function(){return!!o&&(document.body.style.cursor="wait",setTimeout(function(){n.click()},500),!1)},s=n.getAttribute("href"),a=s.match(/(test\-)?proj_[a-zA-Z0-9]+/),c="";a.length>0&&(c=a[0]);var u=new ProcessOut.ProcessOut(c,"");n.onmouseover=function(){if(!o&&(null==i||i.isDeleted())){var e=function(e){console.log("Could not properly load the modal"),console.log(e),window.location.href=s};o=!0,i=u.newModal({url:s,onReady:function(t){n.onclick=function(){return!t.isDeleted()&&(o=!1,document.body.style.cursor="auto",t.show({onError:function(t,n){e(n)}}),n.onclick=r,!1)}},onError:e})}},n.onclick=r}()}}();
