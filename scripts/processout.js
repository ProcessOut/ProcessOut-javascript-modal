!function(){function t(t){this.message=t}var r="undefined"!=typeof exports?exports:self,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";(t.prototype=new Error).name="InvalidCharacterError",r.btoa||(r.btoa=function(r){for(var o,n,a=String(r),i=0,c=e,d="";a.charAt(0|i)||(c="=",i%1);d+=c.charAt(63&o>>8-i%1*8)){if(255<(n=a.charCodeAt(i+=.75)))throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");o=o<<8|n}return d}),r.atob||(r.atob=function(r){var o=String(r).replace(/=+$/,"");if(o.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,a,i=0,c=0,d="";a=o.charAt(c++);~a&&(n=i%4?64*n+a:a,i++%4)&&(d+=String.fromCharCode(255&n>>(-2*i&6))))a=e.indexOf(a);return d})}(),"function"!=typeof Object.assign&&(Object.assign=function(a,b){"use strict";if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(c[f]=e[f])}return c}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(item){item.hasOwnProperty("remove")||Object.defineProperty(item,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function remove(){this.parentNode.removeChild(this)}})}),[].includes||(Array.prototype.includes=function(searchElement){"use strict";var O=Object(this),len=parseInt(O.length)||0;if(0!==len){var k,currentElement,n=parseInt(arguments[1])||0;for(0<=n?k=n:(k=len+n)<0&&(k=0);k<len;){if(searchElement===(currentElement=O[k])||searchElement!=searchElement&&currentElement!=currentElement)return!0;k++}}return!1});var ProcessOut,__extends=this&&this.__extends||function(){var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)};return function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},defaultTheme=(!function(ProcessOut){!function(Flow){Flow[Flow.None=1]="None",Flow[Flow.OneOff=2]="OneOff",Flow[Flow.Subscription=3]="Subscription",Flow[Flow.Tokenization=4]="Tokenization"}(ProcessOut.Flow||(ProcessOut.Flow={}))}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var ApplePay=function(){function ApplePay(instance,req){this.instance=instance,req.merchantCapabilities&&req.merchantCapabilities.length||(req.merchantCapabilities=["supports3DS"]),req.supportedNetworks&&req.supportedNetworks.length||(req.supportedNetworks=["amex","discover","masterCard","visa"]),this.request=req,this.session=new ApplePaySession(1,this.request);var t=this;this.session.onvalidatemerchant=function(event){t.instance.apiRequest("post",t.instance.endpoint("api","/applepay/sessions"),{session_url:event.validationURL,domain_name:window.location.hostname,merchant_certificate_id:t.request.merchantCertificateId,applepay_mid:t.request.merchantApplePayCertificateId},function(data,req,e){data.success?t.session.completeMerchantValidation(data.session_payload):(t.onerror(new ProcessOut.Exception(data.error_code,data.message)),t.session.abort())},function(req,e,errorCode){t.onerror(new ProcessOut.Exception(errorCode)),t.session.abort()})},this.session.onpaymentauthorized=function(event){var req=t.data;(req=req||{}).applepay_response=event.payment,req.token_type="applepay",req.applepay_mid=t.request.merchantApplePayCertificateId,t.instance.apiRequest("post",t.instance.endpoint("api","/cards"),req,function(data,req,e){data.success?t.onsuccess(data.card,data.card):(t.onerror(new ProcessOut.Exception(data.error_code,data.message)),t.session.abort())},function(req,e,errorCode){t.onerror(new ProcessOut.Exception(errorCode)),t.session.abort()}),t.onpaymentauthorizedPostprocess(event)},this.onpaymentauthorizedPostprocess=this.onPaymentAuthorizedPostprocessHandler.bind(this),this.session.oncancel=this.onCancelHandler.bind(this),this.session.onshippingcontactselected=this.onShippingContactSelectedHandler.bind(this),this.session.onshippingmethodselected=this.onShippingMethodSelectedHandler.bind(this)}return ApplePay.prototype.setHandlers=function(onsuccess,onerror){if(!onsuccess)throw new ProcessOut.Exception("applepay.no-success-handler");this.onsuccess=onsuccess,this.onerror=function(err){onerror&&onerror(err)}},ApplePay.prototype.tokenize=function(data,onsuccess,onerror){this.setHandlers(onsuccess,onerror),this.data=data,this.session.begin()},ApplePay.prototype.abort=function(){this.session.abort()},ApplePay.prototype.completePayment=function(status){this.session.completePayment(status)},ApplePay.prototype.completePaymentMethodSelection=function(newTotal,newLineItems){this.session.completePaymentMethodSelection(newTotal,newLineItems)},ApplePay.prototype.completeShippingContactSelection=function(status,newShippingMethods,newTotal,newLineItems){this.session.completeShippingContactSelection(status,newShippingMethods,newTotal,newLineItems)},ApplePay.prototype.completeShippingMethodSelection=function(status,newTotal,newLineItems){this.session.completeShippingMethodSelection(status,newTotal,newLineItems)},ApplePay.prototype.getSession=function(){return this.session},ApplePay.prototype.onCancelHandler=function(event){this.oncancel&&this.oncancel(event)},ApplePay.prototype.onPaymentMethodSelectedHandler=function(event){this.onpaymentmethodselected&&this.onpaymentmethodselected(event)},ApplePay.prototype.onShippingContactSelectedHandler=function(event){this.onshippingcontactselected&&this.onshippingcontactselected(event)},ApplePay.prototype.onShippingMethodSelectedHandler=function(event){this.onshippingmethodselected&&this.onshippingmethodselected(event)},ApplePay.prototype.onPaymentAuthorizedPostprocessHandler=function(event){this.onpaymentauthorizedPostprocess&&this.onpaymentauthorizedPostprocess(event)},ApplePay}();ProcessOut.ApplePay=ApplePay}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var ApplePayWrapper=function(){function ApplePayWrapper(instance){this.instance=instance}return ApplePayWrapper.prototype.checkAvailability=function(callback,req){window.ApplePaySession&&ApplePaySession.canMakePayments()?(req=req||{},this.instance.apiRequest("get",this.instance.endpoint("api","/applepay/available"),{domain_name:window.location.hostname,applepay_mid:req.merchantApplePayCertificateId||""},function(data,req,e){data.success?callback(null):callback(new ProcessOut.Exception("applepay.not-available",data.message))}.bind(this),function(req,e,errorCode){callback(new ProcessOut.Exception(errorCode))})):callback(new ProcessOut.Exception("applepay.not-supported"))},ApplePayWrapper.prototype.newSession=function(req,onsuccess,onerror){return new ProcessOut.ApplePay(this.instance,req)},ApplePayWrapper}();ProcessOut.ApplePayWrapper=ApplePayWrapper}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var ThreeDS=function(){function ThreeDS(instance,options){if(this.instance=instance,!options.source)throw new ProcessOut.Exception("request.validation.error","Please provide a source to be used to start the 3-D Secure flow.");var url=options.url;if(!(url=!url&&options.invoiceID?"/".concat(this.instance.getProjectID(),"/").concat(options.invoiceID,"/three-d-s/redirect/").concat(options.source,"?").concat("processoutjs","=").concat("true"):url)&&(url="/".concat(this.instance.getProjectID(),"/three-d-s")+"?".concat("processoutjs","=").concat("true")+"&amount=".concat(encodeURIComponent(options.amount))+"&currency=".concat(encodeURIComponent(options.currency))+"&name=".concat(encodeURIComponent(options.name))+"&return_url=".concat(encodeURIComponent(options.returnURL||""))+"&source=".concat(encodeURIComponent(options.source)),options.metadata)&&"object"==typeof options.metadata)for(var i in options.metadata)options.metadata.hasOwnProperty(i)&&(url+="&metadata[".concat(i,"]=").concat(encodeURIComponent(options.metadata[i])));if(!url)throw new ProcessOut.Exception("request.validation.error","Please provide a 3DS challenge URL or an invoice ID.");this.url=url}return ThreeDS.prototype.handle=function(success,error){return this.instance.handleAction(this.instance.endpoint("checkout",this.url),function(invoiceID){success(invoiceID)},error,new ProcessOut.ActionHandlerOptions(ProcessOut.ActionHandlerOptions.ThreeDSChallengeFlow))},ThreeDS}();ProcessOut.ThreeDS=ThreeDS}(ProcessOut=ProcessOut||{}),!function(ProcessOut){ProcessOut.ThreeDSOptions=function ThreeDSOptions(){};var ThreeDSWrapper=function(){function ThreeDSWrapper(instance){this.instance=instance}return ThreeDSWrapper.prototype.authenticate=function(options,success,error){return new ProcessOut.ThreeDS(this.instance,options).handle(success,error)},ThreeDSWrapper}();ProcessOut.ThreeDSWrapper=ThreeDSWrapper}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var GatewayRequest=function(){function GatewayRequest(){}return GatewayRequest.prototype.token=function(){return"gway_req_".concat(btoa(JSON.stringify({gateway_configuration_id:this.gatewayConfigurationID,url:this.url,method:this.method,headers:this.headers,body:this.body,prepare:this.prepare})))},GatewayRequest}();ProcessOut.GatewayRequest=GatewayRequest}(ProcessOut=ProcessOut||{}),!function(ProcessOut){ProcessOut.CardHolder=function CardHolder(){};var Expiry=function(){function Expiry(month,year){this.month=month,this.year=Expiry.parseYear(year)}return Expiry.parse=function(exp){var exps=exp.split(" / ");exps.length<=1&&(exps=exp.split("/"));exp=0;return new Expiry(Number(exps[0]),exp=1<exps.length?Number(exps[1]):exp)},Expiry.parseMonth=function(monthn){return Number(monthn)||0},Expiry.parseYear=function(yearn){yearn=Number(yearn);return(yearn=yearn||0)<2e3&&(yearn+=2e3),yearn},Expiry.prototype.getMonth=function(){return this.month},Expiry.prototype.getYear=function(){return this.year},Expiry.prototype.string=function(){return this.month+" / "+this.year},Expiry.prototype.validate=function(){var dateMonth,err=Expiry.validateMonth(this.getMonth());return err||Expiry.validateYear(this.getYear())||(dateMonth=(err=new Date).getMonth()+1,this.getMonth()<dateMonth&&this.getYear()==err.getFullYear()?new ProcessOut.Exception("card.invalid-date"):null)},Expiry.format=function(exp){return(exp=4===exp.length?exp.slice(0,-3):exp).replace(/\s/g,"").replace(/^([1-9]\/|[2-9])$/g,"0$1/").replace(/^(0[1-9]|1[0-2])$/g,"$1/").replace(/^1([3-9])$/g,"01/$1").replace(/^(0[1-9]|1[0-2])([0-9][0-9])$/,"$1/$2").replace(/^0\/|0+$/g,"0").replace(/[^\d|^\/]*/g,"").replace(/(\/.*)\//g,"$1").replace(/\//g," / ")},Expiry.validateMonth=function(month){return!month||month<1||12<month?new ProcessOut.Exception("card.invalid-month"):null},Expiry.validateYear=function(year){year<100&&(year+=2e3);var date=new Date;return!year||year<date.getFullYear()?new ProcessOut.Exception("card.invalid-year"):null},Expiry}(),Card=(ProcessOut.Expiry=Expiry,function(){function Card(number,expiry,cvc){this.number=Card.parseNumber(number),this.cvc=cvc,this.expiry=expiry}return Card.prototype.getNumber=function(){return this.number},Card.prototype.getExpiry=function(){return this.expiry},Card.prototype.getCVC=function(){return this.cvc},Card.luhn=function(cardNo){for(var s=0,doubleDigit=!1,i=cardNo.length-1;0<=i;i--){var digit=+cardNo[i];doubleDigit&&9<(digit*=2)&&(digit-=9),s+=digit,doubleDigit=!doubleDigit}return s%10==0},Card.prototype.validate=function(){var iin=this.getIIN(),scheme=Card.getPossibleSchemes(iin)[0],iin=Card.getPossibleCardLength(iin),iin=Card.validateNumber(this.number,iin);return iin||(null==this.expiry?new ProcessOut.Exception("card.invalid-date"):this.expiry.validate()||Card.validateCVC(this.cvc,scheme))},Card.prototype.getIIN=function(){return Card.getIIN(this.number)},Card.prototype.getLast4Digits=function(){return Card.getLast4Digits(this.number)},Card.formatNumber=function(number){for(var format=Card.getCardFormat(Card.getIIN(number)),formatted=(number=Card.parseNumber(number),""),currentBlock=0,currentBlockChar=0,i=0;i<number.length;i++)if(!isNaN(number[i])){if(currentBlockChar>=format[currentBlock]){if(currentBlockChar=0,++currentBlock>=format.length)break;formatted+=" "}formatted+=number[i],currentBlockChar++}return formatted},Card.parseNumber=function(number){return String(number.replace(/ /gi,"").replace(/\-/gi,"").replace(/\-/gi,""))},Card.validateNumber=function(number,limit){return!((number=Card.parseNumber(number)).length<limit[0]||number.length>limit[1])&&Card.luhn(number)?null:new ProcessOut.Exception("card.invalid-number")},Card.validateCVC=function(cvc,scheme){if(scheme){if("american-express"===scheme){if(cvc&&!cvc.match(/^\d{4}$/g))return new ProcessOut.Exception("card.invalid-cvc")}else if(cvc&&!cvc.match(/^\d{3}$/g))return new ProcessOut.Exception("card.invalid-cvc")}else if(cvc&&!cvc.match(/^\d{3,4}$/g))return new ProcessOut.Exception("card.invalid-cvc");return null},Card.getIIN=function(number){var l=(number=Card.parseNumber(number)).length;return number.substring(0,l=6<l?6:l)},Card.getLast4Digits=function(number){var l=(number=Card.parseNumber(number)).length;return number.substr(number.length-(l=4<l?4:l))},Card.autoFormatNumber=function(number,next){var lastLen=0;number.addEventListener("input",function(e){var cursor=this.selectionStart,l=this.value.length,cursor=(this.value=Card.formatNumber(this.value),cursor&&cursor<l&&(this.setSelectionRange(cursor,cursor),0<cursor)&&" "==this.value[cursor-1]&&lastLen<l&&this.setSelectionRange(cursor+1,cursor+1),Card.getPossibleCardLength(Card.getIIN(this.value)));next&&lastLen<l&&Card.parseNumber(this.value).length==cursor[1]&&next(),lastLen=l})},Card.autoFormatExpiry=function(exp,next){var lastLen=0;exp.addEventListener("input",function(e){var l=this.value.length;this.value=Expiry.format(this.value.substring(0,7)),next&&lastLen<l&&7==this.value.length&&next(),lastLen=l})},Card.autoFormatCvc=function(cvc){cvc.addEventListener("keydown",function(e){var isNumericInput=/\d/.test(e.key);(!(1!==e.key.length||isNumericInput||e.ctrlKey||e.metaKey)||isNumericInput&&3<this.value.length)&&e.preventDefault()})},Card.getCardFormat=function(iin){iin=Card.getPossibleSchemes(iin);return 1==iin.length&&"american-express"==iin[0]?[4,6,5]:[4,4,4,4,4]},Card.getPossibleCardLength=function(iin){for(var minLength=19,maxLength=12,schemes=Card.getPossibleSchemes(iin),i=0;i<schemes.length;i++)switch(schemes[i]){case"visa":minLength=Math.min(minLength,16),maxLength=Math.max(maxLength,19);break;case"mastercard":case"instapayment":case"jcb":case"cardguard ead bg ils":case"elo":case"hipercard":minLength=Math.min(minLength,16),maxLength=Math.max(maxLength,16);break;case"american-express":case"uatp":minLength=Math.min(minLength,15),maxLength=Math.max(maxLength,15);break;case"diners-club":minLength=Math.min(minLength,14),maxLength=Math.max(maxLength,16);break;case"union-pay":case"discover":case"interpayment":case"dankort":case"naranja":case"cabal":case"argencard":minLength=Math.min(minLength,16),maxLength=Math.max(maxLength,19);break;case"maestro":minLength=Math.min(minLength,12),maxLength=Math.max(maxLength,19)}return maxLength<minLength&&(minLength=12,maxLength=19),[minLength,maxLength]},Card.getPossibleSchemes=function(iin){iin=Card.parseNumber(iin);var scheme,schemes={visa:["4"],mastercard:["22","23","24","25","26","27","51","52","53","54","55"],"american-express":["34","37"],"union-pay":["62"],"diners-club":["300","301","302","303","304","305","309","36","38","39"],discover:["6011","62","64","65"],jcb:["35"],maestro:["50","56","57","58","59","6"],dankort:["5019","4175","4571"],uatp:["1"],"cardguard ead bg ils":["5392"],hipercard:["606282"],elo:["401178","401179","438935","451416","457632","457393","431274","438935","457631","457632","506699","50670","50671","50672","50673","50674","50675","50676","506770","506771","506772","506773","506774","506775","506776","506777","506778","504175","509","627780","636297","636368","651652","651653","651654","651655","651656","651657","651658","651659","65166","65167","650031","650032","650033","650035","650036","650037","650038","650039","65004","650050","650051","65500","65501","650485","650486","650487","650488","650489","65049","65050","65051","65052","650530","650531","650532","650533","650534","650535","650536","650537","650538","650541","650542","650543","650544","650545","650546","650547","650548","650549","65055","65056","65057","65058","650590","650591","650592","650593","650594","650595","650596","650597","650598","65070","650710","650711","650712","650713","650714","650715","650716","650717","650718","650720","650721","650722","650723","650724","650725","650726","650727","655021","655022","655023","655024","655025","655026","655027","655028","655029","65503","65504","655050","655051","655052","655053","655054","655055","655056","655057","655058","650901","650902","650903","650904","650905","650906","650907","650908","650909","65091","65092","65093","65094","65095","65096","650970","650971","650972","650973","650974","650975","650976","650977","650978","650405","650406","650407","650408","650409","65041","65042","65043"],naranja:["377798","377799","402917","402918","527571","527572","589562"],cabal:["589657","600691","603522","6042","6043","636908"],argencard:["501105"],"carte bancaire":["49707","49783","49771","45950","45334","51336","49836","47722","45721","54515","49732","51345","45626","49774","49734","49738","40220","53253","56125","49835","49715","58171","45619","45954","49793","43782","41506","49773","53710","51338","53102","45940","45627","49766","46978","49720","45611","49902","55700","49796","49733","45930","55961","49792","51348","52945","49708","49726","45610","44995","49739","41507","47717","54985","58170","51327","47260","45335","43951","51365","43950","49746","40100","45629","49731","51810","45332","42011","55420","42346","41993","45333","49723","51361","49719","45929","55426","44244","51330","55981","49752","45621","49764","49755","51321","45615","49765","51375","47802","51372","49742","51377","55886","49837","51623","46983","49716","55391","67759","45613","45568","49758","46609","47480","44841","45958","51320","47729","51319","49722","51317","49745","67117","49797","51313","49714","49704","47726","44996","42012","49791","49749","51341","41503","51325","55980","46657","49711","52948","51371","49717","49838","51314","46703","40355","51324","51350","55892","53103","51353","43783","55496","49839","45612","45620","46547","51316","49763","49721","51379","49728","49770","49776","51521","49909","45616","52954","51312","49901","45939","49712","49775","45720","52166","49735","46982","51337","46361","51374","49788","47961","49785","49741","51385","46986","51364","49795","51992","49703","45937","51323","52931","45617","49760","53119","49709","49724","45566","45623","52922","46969","53506","51360","47427","45560","40593","45628","51357","41505","51315","45337","52942","53610","53611","40594","45624","48651","51366","45567","46896","40657","51750","52933","49756","52943","49790","54953","49761","45056","48373","49906","47809","54284","48369","51332","55399","44855","40223","49777","43787","58175","41509","45614","48160","51301","49754","49753","45054","46980","49737","52920","51356","49713","49706","49725","51390","49779","51370","51318","47268","51354","49750","51386","40221","51367","49744","49730","51373","45771","51736","45745","53411","52371","51300","43953","47718","49748","58177","53711","58176","52886","48362","45330","44245","49740","45622","46625","41717","51302","44997","52944","51369","49747","49772","58178","49768","52941","51363","51362","49781","45618","53234","49789","51326","49799","40209","45331","49702","58173","58174","49743","51352","51311","45625","51335","49905","49786","41628","49798","58179","53801","49767","45339","49769","53250","51328","49782","53410","58172","49778","45051","49736","49718","49900","49903","49784","55397","46321","51376","51331","49710","56124","44853","49759","51351","52949","53532","49904","49787","51322","49762","55888","51620","49794","51355","45932","52946","49780","49757","49729","52947","51310","51329","53502","49751","53255","51378","51303","49727","45933"],bancontact:["6703","487104","670305","670330","670319","670300","670342","487109","670397","670375","670310"]},matches=new Array;for(scheme in schemes){var optionKey,options=schemes[scheme];for(optionKey in options){var option=options[optionKey],l=(iin.length>option.length?option:iin).length;if(iin.substring(0,l)==option.toString().substring(0,l)){matches.push(scheme);break}}}return matches},Card}());ProcessOut.Card=Card}(ProcessOut=ProcessOut||{}),!function(ProcessOut){ProcessOut.CardFieldValue=function CardFieldValue(){this.number=null,this.expiryMonth=null,this.expiryYear=null,this.cvc=null,this.name=null,this.metadata=null};var CardFieldOptions=function(){function CardFieldOptions(type){this.expiryAutoNext=!0,this.cardNumberAutoNext=!0,this.type=type}return CardFieldOptions.prototype.apply=function(o){return o.placeholder&&(this.placeholder=o.placeholder),o.style&&(this.style=o.style),null!=o.requireCVC&&(this.requireCVC=o.requireCVC),o.expiryAutoNext!==undefined&&null!==o.expiryAutoNext&&(this.expiryAutoNext=o.expiryAutoNext),o.cardNumberAutoNext!==undefined&&null!==o.cardNumberAutoNext&&(this.cardNumberAutoNext=o.cardNumberAutoNext),this},CardFieldOptions}(),CardFieldOptions=(ProcessOut.CardFieldOptions=CardFieldOptions,function CardFieldStyle(){}),CardFieldOptions=(ProcessOut.CardFieldStyle=CardFieldOptions,function(){function CardField(instance,form,options,container,success,error){if(this.handlers={},!options||!options.type)throw new ProcessOut.Exception("processout-js.invalid-field-type","Options and a the field type must be provided to setup the field.");if(!container)throw new ProcessOut.Exception("processout-js.undefined-field","The card field for the ".concat(options.type," does not exist in the given container."));if(container instanceof HTMLInputElement)throw new ProcessOut.Exception("processout-js.invalid-field","The card field for the ".concat(options.type," must be an input field."));if(options.type!=CardField.number&&options.type!=CardField.expiry&&options.type!=CardField.expiryMonth&&options.type!=CardField.expiryYear&&options.type!=CardField.cvc)throw new ProcessOut.Exception("processout-js.invalid-field-type");this.instance=instance,this.form=form,this.options=options,this.el=container;instance=this.el.getAttribute("data-processout-placeholder");instance&&(this.options.placeholder=instance),this.spawn(success,error)}return CardField.prototype.spawn=function(success,error){var tmp=Math.random().toString(36).substring(7),endpoint=(this.uid="#".concat(tmp),this.instance.getProcessOutFieldEndpoint("?r=".concat(tmp).concat(this.uid))),errored=(this.iframe=document.createElement("iframe"),this.iframe.className="processout-field-cc-iframe",this.iframe.name=tmp,this.iframe.setAttribute("src",endpoint),this.iframe.setAttribute("style","background: none; width: 100%;"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allowtransparency","1"),this.iframe.style.display="none",!(this.iframe.height="14px")),iframeError=setTimeout(function(){errored=!0,typeof error==typeof Function&&error(new ProcessOut.Exception("processout-js.field.unavailable"))},CardField.timeout);this.iframe.onload=function(){try{navigator.userAgent.match(/firefox|fxios/i)&&this.iframe.contentWindow.location.replace(endpoint)}catch(e){}}.bind(this),window.addEventListener("message",function(event){errored||(event=ProcessOut.Message.parseEvent(event)).frameID==this.uid&&event.namespace==ProcessOut.Message.fieldNamespace&&(this.handlEvent(event),"alive"==event.action&&this.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"setup",formID:this.form.getUID(),data:this.options}),"*"),"ready"==event.action)&&(this.iframe.style.display="block",clearTimeout(iframeError),success(),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"resize"}),"*"),this.iframe.addEventListener("focus",function(event){this.focus()}.bind(this)))}.bind(this)),this.el.appendChild(this.iframe)},CardField.prototype.handlEvent=function(data){var d={field:this,type:this.options.type,element:this.el,data:data.data};switch(data.action){case"inputEvent":this.eventCallback&&this.eventCallback("oninput",d);break;case"mouseEnterEvent":this.eventCallback&&this.eventCallback("onmouseenter",d);break;case"mouseLeaveEvent":this.eventCallback&&this.eventCallback("onmouseleave",d);break;case"focusEvent":this.el.className=this.el.className+" processout-input-focused",this.eventCallback&&this.eventCallback("onfocus",d);break;case"blurEvent":this.el.className=this.el.className.replace(/\bprocessout-input-focused\b/g,"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),this.eventCallback&&this.eventCallback("onblur",d);break;case"next":this.next&&this.next();break;case"event":if(data.data.name in this.handlers)for(var handlers=this.handlers[data.data.name],i=0;i<handlers.length;i++)handlers[0](data.data.data);break;case"resize":this.options.style.height?this.iframe.height=this.options.style.height:this.iframe.height=data.data}},CardField.prototype.setNext=function(next){this.next=next},CardField.prototype.update=function(options){options.placeholder&&(this.options.placeholder=options.placeholder),options.style&&(this.options.style=Object.assign(this.options.style,options.style)),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"update",data:this.options}),"*")},CardField.prototype.addEventListener=function(e,h){e in this.handlers||(this.handlers[e]=[]),this.handlers[e].push(h),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"registerEvent",data:e}),"*")},CardField.prototype.on=function(e,h){return this.addEventListener(e,h)},CardField.prototype.blur=function(){this.iframe.contentWindow.postMessage(JSON.stringify({messageID:Math.random().toString(),namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"blur"}),"*")},CardField.prototype.focus=function(){this.iframe.contentWindow.postMessage(JSON.stringify({messageID:Math.random().toString(),namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"focus"}),"*")},CardField.prototype.validate=function(success,error){var id=Math.random().toString(),fetchingTimeout=(this.iframe.contentWindow.postMessage(JSON.stringify({messageID:id,namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"validate"}),"*"),setTimeout(function(){error(new ProcessOut.Exception("processout-js.field.unavailable"))},CardField.timeout));window.addEventListener("message",function(event){event=ProcessOut.Message.parseEvent(event);event.frameID==this.uid&&event.namespace==ProcessOut.Message.fieldNamespace&&event.messageID==id&&"validate"==event.action&&(clearTimeout(fetchingTimeout),event.data?error(new ProcessOut.Exception(event.data)):success())}.bind(this))},CardField.prototype.tokenize=function(fields,data,success,error){var id=Math.random().toString(),fetchingTimeout=(this.iframe.contentWindow.postMessage(JSON.stringify({messageID:id,namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"tokenize",data:{fields:fields,data:data}}),"*"),setTimeout(function(){error(new ProcessOut.Exception("processout-js.field.unavailable"))},CardField.timeout));window.addEventListener("message",function(event){event=ProcessOut.Message.parseEvent(event);event.messageID==id&&"tokenize"==event.action&&(clearTimeout(fetchingTimeout),event.data.token?success(event.data.token,event.data.card):event.data.error?error(new ProcessOut.Exception(event.data.error.code,event.data.error.message)):error(new ProcessOut.Exception("default")))}.bind(this))},CardField.prototype.refreshCVC=function(cardUID,success,error){var id=Math.random().toString(),fetchingTimeout=(this.iframe.contentWindow.postMessage(JSON.stringify({messageID:id,namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"refresh-cvc",data:cardUID}),"*"),setTimeout(function(){error(new ProcessOut.Exception("processout-js.field.unavailable"))},CardField.timeout));window.addEventListener("message",function(event){event=ProcessOut.Message.parseEvent(event);event.messageID==id&&"refresh-cvc"==event.action&&(clearTimeout(fetchingTimeout),event.data.token?success(event.data.token):event.data.error?error(new ProcessOut.Exception(event.data.error.code,event.data.error.message)):error(new ProcessOut.Exception("default")))}.bind(this))},CardField.number="number",CardField.expiry="expiry",CardField.expiryMonth="expiry-month",CardField.expiryYear="expiry-year",CardField.cvc="cvc",CardField.timeout=2e4,CardField}());ProcessOut.CardField=CardFieldOptions}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var CardForm=function(){function CardForm(instance,el){this.instance=instance,this.element=el,this.uid=Math.random().toString()}return CardForm.prototype.getUID=function(){return this.uid},CardForm.prototype.setup=function(options,success,error){var opts_1,opts_2,expiryMonthOpts_1,expiryYearOpts_1,numberReady=!1,cvcReady=!1,expMonthReady=!1,expYearReady=!1,ev=function(opts){numberReady&&cvcReady&&expMonthReady&&expYearReady&&(opts&&opts.cardNumberAutoNext&&this.number.setNext(function(){this.exp&&this.exp.focus(),this.expMonth&&this.expMonth.focus()}.bind(this)),this.exp&&opts&&opts.expiryAutoNext&&this.exp.setNext(function(){this.cvc&&this.cvc.focus()}.bind(this)),success(this))}.bind(this),cvcEl=(this.number=new ProcessOut.CardField(this.instance,this,new ProcessOut.CardFieldOptions(ProcessOut.CardField.number).apply(options),this.element.querySelector("[data-processout-input=cc-number]"),function(){numberReady=!0,ev()},error),this.element.querySelector("[data-processout-input=cc-cvc]")),cvcEl=(cvcEl?(opts_1=new ProcessOut.CardFieldOptions(ProcessOut.CardField.cvc).apply(options),this.cvc=new ProcessOut.CardField(this.instance,this,opts_1,cvcEl,function(){cvcReady=!0,ev(opts_1)},error)):cvcReady=!0,this.element.querySelector("[data-processout-input=cc-exp]"));return cvcEl?(opts_2=new ProcessOut.CardFieldOptions(ProcessOut.CardField.expiry).apply(options),this.exp=new ProcessOut.CardField(this.instance,this,opts_2,cvcEl,function(){expYearReady=expMonthReady=!0,ev(opts_2)},error)):(expiryMonthOpts_1=new ProcessOut.CardFieldOptions(ProcessOut.CardField.expiryMonth).apply(options),this.expMonth=new ProcessOut.CardField(this.instance,this,expiryMonthOpts_1,this.element.querySelector("[data-processout-input=cc-exp-month]"),function(){expMonthReady=!0,ev(expiryMonthOpts_1)},error),expiryYearOpts_1=new ProcessOut.CardFieldOptions(ProcessOut.CardField.expiryYear).apply(options),this.expYear=new ProcessOut.CardField(this.instance,this,expiryYearOpts_1,this.element.querySelector("[data-processout-input=cc-exp-year]"),function(){expYearReady=!0,ev(expiryYearOpts_1)},error)),this},CardForm.prototype.setupCVC=function(options,success,error){return this.isRefreshCVC=!0,this.cvc=new ProcessOut.CardField(this.instance,this,new ProcessOut.CardFieldOptions(ProcessOut.CardField.cvc).apply(options),this.element.querySelector("[data-processout-input=cc-cvc]"),function(){success(this)}.bind(this),error),this},CardForm.prototype.getElement=function(){return this.element},CardForm.prototype.addEventListener=function(type,listener,useCapture){return this.element.addEventListener(type,listener,useCapture)},CardForm.prototype.on=function(type,listener,useCapture){return this.element.addEventListener(type,listener,useCapture)},CardForm.prototype.getNumberField=function(){return this.number},CardForm.prototype.getCVCField=function(){return this.cvc},CardForm.prototype.getExpiryField=function(){return this.exp},CardForm.prototype.getExpiryMonthField=function(){return this.expMonth},CardForm.prototype.getExpiryYearField=function(){return this.expYear},CardForm.prototype.validate=function(success,error){var number,cvc,expMonth,expYear,ev;this.isRefreshCVC?this.cvc.validate(function(){success()},error):(expYear=expMonth=cvc=number=!1,ev=function(){number&&cvc&&expMonth&&expYear&&success()},this.number.validate(function(){number=!0,ev()},error),this.cvc?this.cvc.validate(function(){cvc=!0,ev()},error):cvc=!0,this.exp?this.exp.validate(function(){expYear=expMonth=!0,ev()},error):(this.expMonth.validate(function(){expMonth=!0,ev()},error),this.expYear.validate(function(){expYear=!0,ev()},error)))},CardForm.prototype.tokenize=function(data,success,error){var fields=["number"];this.cvc&&fields.push("cvc"),this.exp&&fields.push("exp"),this.expMonth&&fields.push("exp-month"),this.expYear&&fields.push("exp-year"),this.number.tokenize(fields,data,success,error)},CardForm.prototype.refreshCVC=function(cardUID,success,error){this.cvc||error(new ProcessOut.Exception("processout-js.wrong-type-for-action","RefreshCVC was called but the form has no CVC field initialized.")),this.cvc.refreshCVC(cardUID,success,error)},CardForm}();ProcessOut.CardForm=CardForm}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var errors={en:{"default":"An error occured: your payment was declined.","card.declined":"The credit card has been declined.","card.expired":"The given card has expired.","card.duplicate":"The payment could not be completed. Please try again later.","card.network-failed":"The payment could not be completed. Please try again later.","card.invalid":"The given card is invalid.","card.invalid-name":"The cardholder name is invalid.","card.invalid-number":"The card number is invalid.","card.invalid-expiry-date":"The card expiry date is invalid.","card.invalid-expiry-month":"The card expiry month is invalid.","card.invalid-expiry-year":"The card expiry year is invalid.","card.invalid-date":"The card expiry date is invalid.","card.invalid-month":"The card expiry month is invalid.","card.invalid-year":"The card expiry year is invalid.","card.invalid-cvc":"The card CVC is invalid.","card.missing-cvc":"The card CVC is required.","card.missing-cardholder-name":"The card holder name is required.","card.invalid-zip":"The card's ZIP code is valid.","card.failed-cvc-and-avs":"The CVC and AVS code were invalid.","card.failed-three-d-s":"The 3D-Secure authentication failed.","card.bad-track-data":"The card could not be verified. Maybe your CVC is invalid?","card.not-registered":"The card is not registered.","card.issuer-not-found":"The card issuer could not be found. Please try another card.","card.possible-fraud":"The payment could not be completed. Please contact your bank for further help.","card.contact-bank":"The payment could not be completed. Please contact your bank for further help.","card.not-authorized":"The payment could not be authorized using the provided card.","card.do-not-honor":"The payment could not be completed. Please contact your bank for further help.","card.maximum-attempts":"The card maximum attempts has been reached and the payment could not be processed.","card.stolen":"The payment could not be processed as the provided card was marked as stolen.","card.lost":"The payment could not be processed as the provided card was marked as lost.","card.exceeded-limits":"The payment could not be processed as the payment limits of the card have been exceeded.","card.no-money":"There doesn't seem to be enough money on the bank account linked to the provided card.","customer.canceled":"The customer canceled the payment.","customer.popup-blocked":"Please allow pop-ups to continue with your payment flow.","gateway.declined":"The payment was declined.","payment.declined":"The payment was declined.","payment.pending":"The payment is currently pending, please wait a few minutes for it to fully go through.","three-d-s-2.fingerprint-timed-out":"The 3-D Secure fingerprinting timed out.","request.validation.error":"The provided information is invalid or missing.","request.validation.invalid-country":"The provided country is invalid.","request.validation.missing-name":"A name must be provided.","request.validation.invalid-name":"The provided name is invalid.","request.validation.missing-email":"An email must be provided.","request.validation.invalid-email":"The provided email is invalid.","request.validation.invalid-address":"The provided address is invalid.","request.validation.no-method-selected":"Please select a payment method.","request.gateway.not-available":"The requested gateway is currently unavailable.","request.gateway.not-supported":"The gateway is not supported by ProcessOut.js","processout-js.missing-project-id":"Your project ID was not specified when loading ProcessOut.js.","processout-js.not-hosted":"ProcessOut.js was not loaded from ProcessOut CDN. Please do not host ProcessOut.js yourself but rather use ProcessOut CDN: https://js.processout.com/processout.js","processout-js.modal.unavailable":"The ProcessOut.js modal is unavailable.","processout-js.field.unavailable":"The ProcessOut.js credit card field is unavailable.","processout-js.invalid-config":"The provided gateway configuration is invalid.","processout-js.no-customer-action":"No customer action is required for the given gateway configuration and resource.","processout-js.customer-action-not-supported":"The requested customer action is not supported by ProcessOut.js.","processout-js.invalid-field":"The given HTML element may not be used by ProcessOut.js: it is an input. Please only use divs when creating a ProcessOut.js credit card field.","processout-js.undefined-field":"The given HTML element was undefined.","processout-js.invalid-field-type":"The given field type was incorrect. It must either be number, expiry, expiryMonth, expiryYear or CVC.","processout-js.invalid-type":"The specified parameter had an unknown type.","processout-js.missing-source":"A source must be specified.","processout-js.wrong-type-for-action":"The requested action could not be performed on the given field because its type is invalid.","processout-js.missing-invoice-id":"An invoice ID must be specified.","processout-js.missing-resource-id":"A resource ID must be specified.","processout-js.internal-server-error":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.not-implemented":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.invalid-response":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.service-unavailable":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.response-timeout":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.http-version-not-supported":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.network-auth-required":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.aborted-retries-exceeded":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.network-issue":"There seems to be some connectivity issue preventing the payment from making it through. Please switch to another network or try again in a few minutes.","resource.invalid-type":"The provided resource was invalid. It must be an invoice, a subscription or an authorization request.","applepay.not-supported":"The current browser/device does not support Apple Pay.","applepay.no-success-handler":"A success handler must be specified when setting up Apple Pay.","applepay.not-available":"Apple Pay is not available for the current browser, device or ProcessOut project."},fr:{"default":"Une erreur est survenue lors du paiement."},es:{"default":"Ha ocurrido un error: el pago ha sido declinado.","card.declined":"La tarjeta ha sido declinada.","card.expired":"La tarjeta empleada ha caducado.","card.duplicate":"El pago no se ha podido completar. Por favor, inténtelo más tarde.","card.network-failed":"El pago no se ha podido completar. Por favor, inténtelo más tarde.","card.invalid":"La tarjeta empleada no es válida.","card.invalid-name":"El nombre del titular de la tarjeta no es válido.","card.invalid-number":"El número de la tarjeta no es válido.","card.invalid-date":"La fecha de caducidad de la tarjeta no es válida.","card.invalid-expiry-date":"La fecha de caducidad de la tarjeta no es válida.","card.invalid-month":"El mes de caducidad de la tarjeta no es válido.","card.invalid-expiry-month":"El mes de caducidad de la tarjeta no es válido.","card.invalid-year":"El año de caducidad de la tarjeta no es válido.","card.invalid-expiry-year":"El año de caducidad de la tarjeta no es válido.","card.invalid-cvc":"El código CVC de la tarjeta no es válido.","card.missing-cvc":"El código CVC de la tarjeta es obligatorio.","card.invalid-zip":"El código ZIP de la tarjeta no es válido.","card.failed-cvc-and-avs":"El código CVC y el código AVS no son válidos.","card.failed-three-d-s":"La autenticación 3DS ha fallado.","card.bad-track-data":"No ha sido posible verificar la tarjeta.","card.missing-cardholder-name":"El nombre del titular de la tarjeta es obligatorio.","card.not-registered":"La tarjeta no ha sido registrada.","card.issuer-not-found":"No se ha podido encontrar el emisor de la tarjeta. Por favor, inténtelo con otra tarjeta.","card.possible-fraud":"El pago no se ha podido completar. Por favor, contacte con su banco para obtener ayuda.","card.contact-bank":"El pago no se ha podido completar. Por favor, contacte con su banco para obtener ayuda.","card.not-authorized":"El pago no se ha podido autorizar con la tarjeta proporcionada.","card.do-not-honor":"El pago no se ha podido completar. Por favor, contacte con su banco para obtener ayuda.","card.maximum-attempts":"Se ha alcanzado el número máximo de intentos con la tarjeta proporcionada y el pago no se ha podido procesar.","card.stolen":"El pago no se ha podido procesar porque la tarjeta proporcionada ha sido marcada como robada.","card.lost":"El pago no se ha podido procesar porque la tarjeta proporcionada ha sido marcada como perdida.","card.exceeded-limits":"El pago no se ha procesado porque se han excedido los límites de pago de la tarjeta.","card.no-money":"Parece que no hay suficiente dinero en la cuenta bancaria vinculada a la tarjeta proporcionada.","customer.canceled":"El cliente ha cancelado el pago.","customer.popup-blocked":"Por favor, permita el uso de pop-ups en su navegador para continuar con el flujo de pago.","gateway.declined":"El pago ha sido rechazado.","payment.declined":"El pago ha sido rechazado.","payment.pending":"El pago está actualmente pendiente. Espere unos minutos hasta que se complete por completo.","three-d-s-2.fingerprint-timed-out":"La identificación por huella digital 3-D Secure ha caducado.","request.validation.error":"La información proporcionada es inválida o no está presente en su totalidad.","request.validation.invalid-country":"El país proporcionado no es válido.","request.validation.missing-name":"Se debe proporcionar un nombre.","request.validation.invalid-name":"El nombre proporcionado no es válido.","request.validation.missing-email":"Se debe proporcionar un email.","request.validation.invalid-email":"El email proporcionado no es válido.","request.validation.invalid-address":"La dirección proporcionada no es válida.","request.validation.no-method-selected":"Por favor, seleccione un método de pago.","request.gateway.not-available":"La pasarela de pago solicitada no está disponible.","request.gateway.not-supported":"La pasarela de pago no es compatible.","resource.invalid-type":"El recurso proporcionado no es válido. Debe ser un invoice, una suscripción o una solicitud de autorización.","applepay.not-supported":"Su navegador o dispositivo actual no es compatible con Apple Pay."},pt:{"default":"Ocorreu um erro: o pagamento foi recusado.","card.declined":"O cartão foi recusado.","card.expired":"O cartão fornecido expirou.","card.duplicate":"O pagamento não foi concluído. Por favor, tente novamente.","card.network-failed":"O pagamento não foi concluído. Por favor, tente novamente.","card.invalid":"O cartão fornecido é inválido.","card.invalid-name":"O nome do titular do cartão é inválido.","card.invalid-number":"O número do cartão é inválido.","card.invalid-date":"A data de validade do cartão é inválida.","card.invalid-expiry-date":"A data de validade do cartão é inválida.","card.invalid-month":"O mês de validade do cartão é inválido.","card.invalid-expiry-month":"O mês de validade do cartão é inválido.","card.invalid-year":"O ano de validade do cartão é inválido.","card.invalid-expiry-year":"O ano de validade do cartão é inválido.","card.invalid-cvc":"O código de verificação do cartão é inválido.","card.missing-cvc":"O código de verificação do cartão é obrigatório.","card.invalid-zip":"O código postal do cartão é inválido.","card.failed-cvc-and-avs":"Os códigos de verificação do cartão e morada são inválidos.","card.failed-three-d-s":"A autenticação 3D-Secure falhou.","card.bad-track-data":"O cartão não pode ser verificado.","card.missing-cardholder-name":"O nome do titular do cartão é obrigatório.","card.not-registered":"O cartão não está registado.","card.issuer-not-found":"O emissor do cartão não existe. Por favor, utilize outro cartão.","card.possible-fraud":"O pagamento não foi concluído. Por favor, entre em contato com o seu banco para mais informação.","card.contact-bank":"O pagamento não foi concluído. Por favor, entre em contato com o seu banco para mais informação.","card.not-authorized":"O pagamento não foi autorizado com o cartão fornecido.","card.do-not-honor":"O pagamento não foi concluído. Por favor, entre em contato com o seu banco para mais informação.","card.maximum-attempts":"O número de tentativas foi excedido e o pagamento não pode ser processado.","card.stolen":"O pagamento não pode ser processado sendo que o cartão foi dado como roubado.","card.lost":"O pagamento não pode ser processado sendo que o cartão foi dado como perdido.","card.exceeded-limits":"O pagamento não pode ser processado sendo que o limite de pagamento do cartão foi excedido.","card.no-money":"A conta bancária associada ao cartão possivelmente não possui fundos suficientes.","customer.canceled":"O cliente cancelou o pagamento.","customer.popup-blocked":"Por favor, ative os pop-ups para prosseguir com o pagamento.","gateway.declined":"O pagamento foi recusado.","payment.declined":"O pagamento foi recusado.","payment.pending":"O pagamento está pendente, por favor aguarde alguns minutos para ser processado.","three-d-s-2.fingerprint-timed-out":"A assinatura digital 3D-Secure expirou.","request.validation.error":"A informação fornecida está inválida ou incompleta.","request.validation.invalid-country":"O país fornecido não é válido.","request.validation.missing-name":"O nome é obrigatório.","request.validation.invalid-name":"O nome fornecido não é válido.","request.validation.missing-email":"O email é obrigatório.","request.validation.invalid-email":"O email fornecido não é válido.","request.validation.invalid-address":"O endereço fornecido não é válido.","request.validation.no-method-selected":"Por favor, selecione um método de pagamento.","request.gateway.not-available":"O gateway de pagamento solicitado está indisponível.","request.gateway.not-supported":"O gateway de pagamento não é suportado.","resource.invalid-type":"O recurso fornecido é inválido. Este recurso deve ser uma fatura (invoice), assinatura (subscription) ou pedido de autorização (authorization request).","applepay.not-supported":"O navegador / dispositivo utilizado não suporta Apple Pay."}},messages={en:{"label.cancel":"Cancel","label.apm-description":"A new window was opened to process your payment. Click here to continue."},fr:{"label.cancel":"Annuler","label.apm-description":"Une nouvelle fen&ecirc;tre s'est ouverte pour proc&eacute;der au paiement. Cliquez ici pour continuer."},es:{"label.cancel":"Cancelar","label.apm-description":"Se abrió una nueva ventana para procesar su pago. Clic aquí para continuar."},pt:{"label.cancel":"Cancelar","label.apm-description":"Uma nova janela foi aberta para processar o seu pagamento. Clique aqui para continuar."}},Translator=function(){function Translator(){}return Translator.getTranslated=function(l,code,message){return l[this.getLocale()]&&l[this.getLocale()][code]?l[this.getLocale()][code]:l.en[code]||message||(l[this.getLocale()]&&l[this.getLocale()]["default"]?l[this.getLocale()]["default"]:l.en["default"]||code)},Translator.translateError=function(code,message){return this.getTranslated(errors,code,message)},Translator.translateMessage=function(code,message){return this.getTranslated(messages,code,message)},Translator.getLocale=function(){var locale=navigator.language||navigator.userLanguage;return locale.length<2?"en":locale.substring(0,2).toLowerCase()},Translator}();ProcessOut.Translator=Translator}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var Exception=function(_super){function Exception(code,message){var _this=this;return message=message||ProcessOut.Translator.translateError(code),(_this=_super.call(this,message)||this).code=code,_this.message=message,_this.name="ProcessOutException",_this.stack=(new Error).stack,_this}return __extends(Exception,_super),Exception}(Error);ProcessOut.Exception=Exception}(ProcessOut=ProcessOut||{}),!function(ProcessOut_1){ProcessOut_1.DEBUG=!1,ProcessOut_1.TestModePrefix="test-";var ProcessOut=function(){function ProcessOut(projectID,resourceID){this.timeout=1e4,this.sandbox=!1,this.host="processout.com",this.processOutFieldEndpoint="",this.processOutMessageHubEndpoint="",this.threeDSInitiationRequested=!1,this.threeDSInitiationURL="",this.apiVersion="1.3.0.0";var scripts=document.getElementsByTagName("script"),jsHost="";if(/^https?:\/\/.*\.processout\.((com)|(ninja)|(dev))\//.test(window.location.href))jsHost=window.location.href;else for(var i=0;i<scripts.length;i++)/^https?:\/\/.*\.processout\.((com)|(ninja)|(dev))\//.test(scripts[i].getAttribute("src"))&&(jsHost=scripts[i].getAttribute("src"));if(""==jsHost&&!ProcessOut_1.DEBUG)throw new ProcessOut_1.Exception("processout-js.not-hosted");if(/^https?:\/\/.*\.processout\.ninja\//.test(jsHost)?this.host="processout.ninja":/^https?:\/\/.*\.processout\.dev\//.test(jsHost)?this.host="processout.dev":this.host="processout.com",!projectID)throw new ProcessOut_1.Exception("processout-js.missing-project-id");if(this.projectID=projectID,0===this.projectID.lastIndexOf(ProcessOut_1.TestModePrefix,0)&&(this.sandbox=!0),this.resourceID=resourceID,this.resourceID&&""!=this.resourceID&&"iv_"!=this.resourceID.substring(0,3)&&"sub_"!=this.resourceID.substring(0,4)&&"auth_req_"!=this.resourceID.substring(0,9))throw new ProcessOut_1.Exception("resource.invalid-type");this.applePay=new ProcessOut_1.ApplePayWrapper(this),this.threeDS=new ProcessOut_1.ThreeDSWrapper(this)}return ProcessOut.prototype.getResourceID=function(){return this.resourceID},ProcessOut.prototype.getProjectID=function(){return this.projectID},ProcessOut.prototype.getProcessOutFieldEndpoint=function(suffix){var endpoint=this.endpoint("js","/ccfield.html");return ProcessOut_1.DEBUG&&this.processOutFieldEndpoint&&(endpoint=this.processOutFieldEndpoint),"".concat(endpoint).concat(suffix)},ProcessOut.prototype.getProcessOutMessageHubEndpoint=function(suffix){var endpoint=this.endpoint("js","/messagehub.html");return ProcessOut_1.DEBUG&&this.processOutMessageHubEndpoint&&(endpoint=this.processOutMessageHubEndpoint),"".concat(endpoint).concat(suffix)},ProcessOut.prototype.setProcessOutFieldEndpoint=function(endpoint){ProcessOut_1.DEBUG&&(this.processOutFieldEndpoint=endpoint)},ProcessOut.prototype.setProcessOutMessageHubEndpoint=function(endpoint){ProcessOut_1.DEBUG&&(this.processOutMessageHubEndpoint=endpoint)},ProcessOut.prototype.endpoint=function(subdomain,path){return"https://".concat(subdomain,".").concat(this.host).concat(path)},ProcessOut.prototype.apiRequest=function(method,path,data,success,error,retry,options){retry=retry||0,method=method.toLowerCase();var isLegacy=!options||options.isLegacy===undefined||options.isLegacy,options=options&&options.clientSecret!==undefined?options.clientSecret:null,headers=("http"!=path.substring(0,4)&&"/"!=path[0]&&(path=this.endpoint("api","/"+path)),{"Content-Type":"application/json","API-Version":this.apiVersion});for(k in this.projectID&&(headers.Authorization="Basic ".concat(btoa(this.projectID+":"))),(data=data||{}).idempotency_key&&(headers["Idempotency-Key"]=data.idempotency_key,delete data.idempotency_key),isLegacy&&(path+="?legacyrequest=true&project_id=".concat(this.projectID)),headers)path+="&x-".concat(k,"=").concat(headers[k]);if("get"==method)for(var key in data)path+="&".concat(key,"=").concat(encodeURIComponent(data[key]));var request=new XMLHttpRequest;if((request=window.XDomainRequest?new XDomainRequest:request).open(method,path,!0),!window.XDomainRequest){for(var k in headers)request.setRequestHeader(k,headers[k]);options&&request.setRequestHeader("x-processout-client-secret",options)}request.timeout=0,request.onload=function(e){var parsed;try{parsed=JSON.parse(request.responseText)}catch(e){parsed={}}!window.XDomainRequest&&4!=e.currentTarget.readyState||success(parsed,request,e)},request.onerror=function(e){request.status&&200<=request.status&&request.status<500&&request.responseText?request.onload(e):error(request,e,this.getApiRequestErrorCode(request.status))}.bind(this),request.ontimeout=function(){},request.onprogress=function(){},request.onabort=function(){3<retry?error(request,null,"processout-js.aborted-retries-exceeded"):this.request(method,path,data,success,error,retry+1)}.bind(this),request.send(JSON.stringify(data))},ProcessOut.prototype.getApiRequestErrorCode=function(httpStatusCode){switch(httpStatusCode){case 0:return"processout-js.network-issue";case 501:return"processout-js.not-implemented";case 502:return"processout-js.invalid-response";case 503:return"processout-js.service-unavailable";case 504:return"processout-js.response-timeout";case 505:return"processout-js.http-version-not-supported";case 511:return"processout-js.network-auth-required";default:return"processout-js.internal-server-error"}},ProcessOut.prototype.setupForm=function(form,options,success,error){if(!this.projectID)throw new ProcessOut_1.Exception("default","You must instanciate ProcessOut.js with a valid project ID in order to use ProcessOut's hosted forms.");if(form)return"function"==typeof options?new ProcessOut_1.CardForm(this,form).setup(new ProcessOut_1.CardFieldOptions(""),options,success):new ProcessOut_1.CardForm(this,form).setup(options,success,error);throw new ProcessOut_1.Exception("default","The provided form element wasn't set. Make sure to provide setupForm with a valid form element.")},ProcessOut.prototype.setupNativeApm=function(config,options){if(this.projectID)return new ProcessOut_1.NativeApm(this,config,options);throw new ProcessOut_1.Exception("default","You must instantiate ProcessOut.js with a valid project ID in order to use ProcessOut's Native APM")},ProcessOut.prototype.setupDynamicCheckout=function(config){if(this.projectID)return new ProcessOut_1.DynamicCheckout(this,config);throw new ProcessOut_1.Exception("default","You must instantiate ProcessOut.js with a valid project ID in order to use ProcessOut's Dynamic Checkout")},ProcessOut.prototype.tokenize=function(val,data,success,error){if(val instanceof ProcessOut_1.Card)return this.tokenizeCard(val,data,success,error);if(val instanceof ProcessOut_1.CardForm)return this.tokenizeForm(val,data,success,error);if(val instanceof ProcessOut_1.PaymentToken)return this.tokenizePaymentToken(val,data,success,error);if(val instanceof ProcessOut_1.ApplePay)return val.tokenize(data,success,error);throw new ProcessOut_1.Exception("processout-js.invalid-type","The first parameter had an unknown type/instance. The value must be an instance of either Card, CardForm or ApplePay.")},ProcessOut.prototype.tokenizePaymentToken=function(token,data,success,error){(data=data||{}).contact||(data.contact={}),data=this.injectDeviceData(data);var tokenType=token.getTokenType();if(tokenType!==ProcessOut_1.TokenType.GooglePay)throw new ProcessOut_1.Exception("processout-js.invalid-field","This token type is not valid or not supported yet!.");token=token.getPayload(),token=btoa(JSON.stringify(token));data.token_type=tokenType,data.payment_token=token,this.apiRequest("post","cards",data,function(data,req,e){data.success?success(data.card.id,data.card):error(new ProcessOut_1.Exception(data.error_type,data.message))},function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut.prototype.tokenizeCard=function(card,data,success,error){var err=card.validate();err?error(err):((data=data||{}).contact||(data.contact={}),(data=this.injectDeviceData(data)).number=card.getNumber(),data.exp_month=card.getExpiry().getMonth().toString(),data.exp_year=card.getExpiry().getYear().toString(),data.cvc2=card.getCVC(),this.apiRequest("post","cards",data,function(data,req,e){data.success?success(data.card.id,data.card):error(new ProcessOut_1.Exception(data.error_type,data.message))},function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))}))},ProcessOut.prototype.injectDeviceData=function(data){var device={request_origin:"web"},language=(screen.colorDepth&&(device.app_color_depth=Number(screen.colorDepth)),navigator.language||navigator.userLanguage);return language&&(device.app_language=language),screen.height&&(device.app_screen_height=screen.height),screen.width&&(device.app_screen_width=screen.width),device.app_timezone_offset=Number((new Date).getTimezoneOffset()),window.navigator&&(device.app_java_enabled=window.navigator.javaEnabled()),data.device=device,Object.keys(device).forEach(function(key){data[key]=device[key]}),data},ProcessOut.prototype.tokenizeForm=function(form,data,success,error){form.validate(function(){form.tokenize(data,success,error)}.bind(this),error)},ProcessOut.prototype.setupFormCVC=function(form,options,success,error){return"function"==typeof options?new ProcessOut_1.CardForm(this,form).setupCVC(new ProcessOut_1.CardFieldOptions(""),options,success):new ProcessOut_1.CardForm(this,form).setupCVC(options,success,error)},ProcessOut.prototype.refreshCVC=function(cardUID,val,success,error){return val instanceof ProcessOut_1.CardForm?this.refreshCVCForm(cardUID,val,success,error):this.refreshCVCString(cardUID,val,success,error)},ProcessOut.prototype.refreshCVCForm=function(cardUID,form,success,error){form.validate(function(){form.refreshCVC(cardUID,success,error)}.bind(this),error)},ProcessOut.prototype.refreshCVCString=function(cardUID,cvc,success,error){var err=ProcessOut_1.Card.validateCVC(cvc);err?error(err):this.apiRequest("put","cards/".concat(cardUID),{cvc:cvc},function(data,req,e){data.success?success(data.card.id):error(new ProcessOut_1.Exception("card.invalid"))},function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut.prototype.newModal=function(options,onReady,onError){var url="";if("object"==typeof options&&(url=options.url,onReady=options.onReady,onError=options.onError,!url)&&(url=this.endpoint("checkout","/".concat(this.getProjectID(),"/oneoff")+"?amount=".concat(encodeURIComponent(options.amount))+"&currency=".concat(encodeURIComponent(options.currency))+"&name=".concat(encodeURIComponent(options.name))),options.metadata)&&"object"==typeof options.metadata)for(var i in options.metadata)options.metadata.hasOwnProperty(i)&&(url+="&metadata[".concat(i,"]=").concat(encodeURIComponent(options.metadata[i])));var uniqId=Math.random().toString(36).substr(2,9),iframe=document.createElement("iframe"),iframeError=(iframe.className="processout-iframe",iframe.setAttribute("id","processout-iframe-"+uniqId),iframe.setAttribute("src",url),iframe.setAttribute("style","position: fixed; top: 0; left: 0; background: none; z-index: 9999999;"),iframe.setAttribute("frameborder","0"),iframe.setAttribute("allowtransparency","1"),iframe.style.display="none",setTimeout(function(){typeof onError==typeof Function&&onError(new ProcessOut_1.Exception("processout-js.modal.unavailable"))},this.timeout));iframe.onload=function(){clearTimeout(iframeError),typeof onReady==typeof Function&&onReady(new ProcessOut_1.Modal(this,iframe,uniqId))}.bind(this),document.body.appendChild(iframe)},ProcessOut.prototype.fetchGatewayConfigurations=function(config,success,error){if(!(config=config||{}).invoiceID&&!config.customerID!=!config.tokenID)throw new ProcessOut_1.Exception("processout-js.missing-resource-id");this.apiRequest("GET","gateway-configurations",{filter:config.filter,expand_merchant_accounts:"true"},function(data){if(data.success){for(var confs=[],_i=0,_a=data.gateway_configurations;_i<_a.length;_i++){var conf=_a[_i];conf.getInvoiceActionURL=this.buildGetInvoiceActionURL(config.invoiceID,conf),conf.handleInvoiceAction=this.buildHandleTokenInvoiceAction(config.invoiceID,conf,config.customerTokenID),conf.hookForInvoice=this.buildConfHookForInvoice(conf),conf.getCustomerTokenActionURL=this.buildGetCustomerTokenActionURL(config.customerID,config.tokenID,conf),conf.handleCustomerTokenAction=this.buildHandleCustomerTokenAction(config.customerID,config.tokenID,conf),conf.handleCustomerTokenActionAdditionalData=this.buildHandleCustomerTokenActionAdditionalData(config.customerID,config.tokenID,conf),conf.hookForCustomerToken=this.buildConfHookForCustomerToken(conf),confs.push(conf)}success(confs)}else error(new ProcessOut_1.Exception(data.error_type,data.message))}.bind(this),function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut.prototype.getInvoiceActionURL=function(invoiceID,gatewayConf,additionalData){gatewayConf=gatewayConf&&gatewayConf.id?gatewayConf.id:gatewayConf;return this.getConfigurableInvoiceActionURL({invoiceId:invoiceID,gatewayConfigurationId:gatewayConf,additionalData:additionalData})},ProcessOut.prototype.getConfigurableInvoiceActionURL=function(config){var gatewayConfID=config.gatewayConfigurationId,invoiceId=config.invoiceId;if(!invoiceId)throw new ProcessOut_1.Exception("processout-js.missing-resource-id","An Invoice Action was requested, but the Invoice ID was missing. Make sure you didn't rather want to call `customerToken` helpers on the gateway configuration instead of `invoice` ones.");var key,suffix="?",additionalData=config.additionalData;for(key in additionalData)suffix+="additional_data[".concat(key,"]=").concat(encodeURI(additionalData[key]),"&");config=config.customerTokenId?"/tokenized/".concat(config.customerTokenId):"",invoiceId="/".concat(this.getProjectID(),"/").concat(invoiceId,"/redirect/").concat(gatewayConfID).concat(config).concat(suffix.substring(0,suffix.length-1));return this.endpoint("checkout",invoiceId)},ProcessOut.prototype.handleInvoiceAction=function(invoiceID,gatewayConf,tokenized,tokenError,iframeOverride){return this.handleInvoiceActionAdditionalData(invoiceID,gatewayConf,{},tokenized,tokenError,iframeOverride)},ProcessOut.prototype.handleInvoiceActionAdditionalData=function(invoiceID,gatewayConf,additionalData,tokenized,tokenError,iframeOverride){var gatewayName=null,gatewayLogo=null,gatewayName=(gatewayConf&&gatewayConf.id&&gatewayConf.gateway&&(gatewayName=gatewayConf.gateway.name,gatewayLogo=gatewayConf.gateway.logo_url),new ProcessOut_1.ActionHandlerOptions(gatewayName,gatewayLogo,iframeOverride));return this.handleAction(this.getInvoiceActionURL(invoiceID,gatewayConf,additionalData),tokenized,tokenError,gatewayName)},ProcessOut.prototype.handleConfigurableInvoiceAction=function(props){var props=ProcessOut_1.sanitizeInvoiceActionProps(props),gatewayName=props.gatewayConf.gatewayName,gatewayLogo=props.gatewayConf.gatewayLogoUrl,gatewayName=new ProcessOut_1.ActionHandlerOptions(gatewayName,gatewayLogo,props.iframeOverride),gatewayLogo={invoiceId:props.invoiceId,gatewayConfigurationId:props.gatewayConf.id,additionalData:props.additionalData,customerTokenId:props.customerTokenId};return this.handleAction(this.getConfigurableInvoiceActionURL(gatewayLogo),props.tokenized,props.tokenError,gatewayName)},ProcessOut.prototype.buildGetInvoiceActionURL=function(invoiceID,gatewayConf){return function(){return this.getInvoiceActionURL(invoiceID,gatewayConf)}.bind(this)},ProcessOut.prototype.buildHandleInvoiceAction=function(invoiceID,gatewayConf){return function(tokenized,tokenError,iframeOverride){return this.handleInvoiceAction(invoiceID,gatewayConf,tokenized,tokenError,iframeOverride)}.bind(this)},ProcessOut.prototype.buildHandleTokenInvoiceAction=function(invoiceID,gatewayConf,customerTokenId){return customerTokenId?function(tokenized,tokenError,iframeOverride){return this.handleConfigurableInvoiceAction({invoiceId:invoiceID,tokenized:tokenized,tokenError:tokenError,gatewayConf:ProcessOut_1.mapInvoiceGatewayConfigurationProps(gatewayConf),customerTokenId:customerTokenId,additionalData:{},iframeOverride:iframeOverride})}.bind(this):this.buildHandleInvoiceAction(invoiceID,gatewayConf)},ProcessOut.prototype.buildConfHookForInvoice=function(gatewayConf){return function(el,tokenized,tokenError){el.addEventListener("click",function(e){return e.preventDefault(),gatewayConf.handleInvoiceAction(tokenized,tokenError),!1}.bind(this))}.bind(this)},ProcessOut.prototype.getCustomerTokenActionURL=function(customerID,tokenID,gatewayConf){var gatewayConfID=gatewayConf;if(gatewayConf&&gatewayConf.id&&(gatewayConfID=gatewayConf.id),customerID&&tokenID)return this.endpoint("checkout","/".concat(this.getProjectID(),"/").concat(customerID,"/").concat(tokenID,"/redirect/").concat(gatewayConfID));throw new ProcessOut_1.Exception("processout-js.missing-resource-id","A Customer Token Action was requested, but a customer ID or a token ID was missing. Make sure you didn't rather want to call `invoice` helpers on the gateway configuration instead of `customerToken` ones.")},ProcessOut.prototype.getCustomerTokenActionURLAdditionalData=function(customerID,tokenID,additionalData,gatewayConf){var gatewayConfID=gatewayConf;if(gatewayConf&&gatewayConf.id&&(gatewayConfID=gatewayConf.id),!customerID||!tokenID)throw new ProcessOut_1.Exception("processout-js.missing-resource-id","A Customer Token Action was requested, but a customer ID or a token ID was missing. Make sure you didn't rather want to call `invoice` helpers on the gateway configuration instead of `customerToken` ones.");var key,suffix="?";for(key in additionalData)suffix+="additional_data[".concat(key,"]=").concat(encodeURI(additionalData[key]),"&");return this.endpoint("checkout","/".concat(this.getProjectID(),"/").concat(customerID,"/").concat(tokenID,"/redirect/").concat(gatewayConfID).concat(suffix.substring(0,suffix.length-1)))},ProcessOut.prototype.handleCustomerTokenAction=function(customerID,tokenID,gatewayConf,tokenized,tokenError){var gatewayName=null,gatewayLogo=null,gatewayName=(gatewayConf&&gatewayConf.id&&gatewayConf.gateway&&(gatewayName=gatewayConf.gateway.name,gatewayLogo=gatewayConf.gateway.logo_url),new ProcessOut_1.ActionHandlerOptions(gatewayName,gatewayLogo));return this.handleAction(this.getCustomerTokenActionURL(customerID,tokenID,gatewayConf),tokenized,tokenError,gatewayName)},ProcessOut.prototype.handleCustomerTokenActionAdditionalData=function(customerID,tokenID,gatewayConf,additionalData,tokenized,tokenError){var gatewayName=null,gatewayLogo=null,gatewayName=(gatewayConf&&gatewayConf.id&&gatewayConf.gateway&&(gatewayName=gatewayConf.gateway.name,gatewayLogo=gatewayConf.gateway.logo_url),new ProcessOut_1.ActionHandlerOptions(gatewayName,gatewayLogo));return this.handleAction(this.getCustomerTokenActionURLAdditionalData(customerID,tokenID,additionalData,gatewayConf),tokenized,tokenError,gatewayName)},ProcessOut.prototype.buildGetCustomerTokenActionURL=function(customerID,tokenID,gatewayConf){return function(){return this.getCustomerTokenActionURL(customerID,tokenID,gatewayConf)}.bind(this)},ProcessOut.prototype.buildHandleCustomerTokenAction=function(customerID,tokenID,gatewayConf){return function(tokenized,tokenError){return this.handleCustomerTokenAction(customerID,tokenID,gatewayConf,tokenized,tokenError)}.bind(this)},ProcessOut.prototype.buildHandleCustomerTokenActionAdditionalData=function(customerID,tokenID,gatewayConf){return function(additionalData,tokenized,tokenError){return this.handleCustomerTokenActionAdditionalData(customerID,tokenID,gatewayConf,additionalData,tokenized,tokenError)}.bind(this)},ProcessOut.prototype.buildConfHookForCustomerToken=function(gatewayConf){return function(el,tokenized,tokenError){el.addEventListener("click",function(e){return e.preventDefault(),gatewayConf.handleCustomerTokenAction(tokenized,tokenError),!1}.bind(this))}.bind(this)},ProcessOut.prototype.handleAction=function(url,success,error,options){return new ProcessOut_1.ActionHandler(this,options).handle(url,success,error)},ProcessOut.prototype.makeCardToken=function(val,customerID,customerTokenID,options,success,error){return val instanceof ProcessOut_1.Card||val instanceof ProcessOut_1.CardForm?this.tokenize(val,options,function(token){return this.makeCardTokenFromCardID(token,customerID,customerTokenID,options,success,error)}.bind(this),error):this.makeCardTokenFromCardID(val,customerID,customerTokenID,options,success,error)},ProcessOut.prototype.makeCardTokenFromCardID=function(cardID,customerID,customerTokenID,options,success,error){this.handleCardActions("PUT","customers/".concat(customerID,"/tokens/").concat(customerTokenID),customerTokenID,cardID,options,success,error)},ProcessOut.prototype.initiateThreeDS=function(invoiceID,source,options,success,error){var url="invoices/".concat(invoiceID,"/capture");this.threeDSInitiationURL="invoices/".concat(invoiceID,"/three-d-s"),this.threeDSInitiationRequested=!0,this.handleCardActions("POST",url,invoiceID,source,options,success,error)},ProcessOut.prototype.makeCardPayment=function(invoiceID,cardID,options,success,error,apiRequestOptions){this.handleCardActions("POST","invoices/".concat(invoiceID,"/capture"),invoiceID,cardID,options,success,error,apiRequestOptions)},ProcessOut.prototype.makeIncrementalAuthorizationPayment=function(invoiceID,cardID,options,success,error){(options=options||{}).incremental=!0,this.handleCardActions("POST","invoices/".concat(invoiceID,"/authorize"),invoiceID,cardID,options,success,error)},ProcessOut.prototype.incrementAuthorizationAmount=function(invoiceID,amount,success,error){this.apiRequest("POST","invoices/".concat(invoiceID,"/increment_authorization"),{amount:amount},function(data,req,e){data.success?success(data):error(new ProcessOut_1.Exception("request.validation.error"))},function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut.prototype.handleCardActions=function(method,endpoint,resourceID,cardID,options,success,error,apiRequestOptions){var _this=this,getEndpoint=function(){return _this.threeDSInitiationRequested?(_this.threeDSInitiationRequested=!1,_this.threeDSInitiationURL):endpoint},source=cardID,source=((options=options||{}).gatewayRequestSource&&(source=options.gatewayRequestSource),{authorize_only:options.authorize_only,allow_fallback_to_sale:options.allow_fallback_to_sale,capture_amount:options.capture_amount,auto_capture_at:options.auto_capture_at,source:source,enable_three_d_s_2:!0,verify:options.verify,verify_metadata:options.verify_metadata,set_default:options.set_default,incremental:options.incremental,preferred_scheme:options.preferred_scheme}),source=this.injectDeviceData(source);options.idempotency_key&&(options.iterationNumber||(options.iterationNumber=1),source.idempotency_key="".concat(options.idempotency_key,"-").concat(options.iterationNumber),options.iterationNumber++),options.save_source&&(source.save_source=options.save_source),this.apiRequest(method,getEndpoint(),source,function(data){if(data.success)if(data.customer_action){var nextStep=function(data){options.gatewayRequestSource=data,this.handleCardActions(method,getEndpoint(),resourceID,cardID,options,success,error)}.bind(this);switch(data.customer_action.type){case"url":var opts=ProcessOut_1.ActionHandlerOptions.ThreeDSChallengeFlow;data.customer_action.metadata&&"true"===data.customer_action.metadata.no_iframe&&(opts=ProcessOut_1.ActionHandlerOptions.ThreeDSChallengeFlowNoIframe),this.handleAction(data.customer_action.value,function(data){options.gatewayRequestSource=null,this.handleCardActions(method,getEndpoint(),resourceID,cardID,options,success,error)}.bind(this),error,new ProcessOut_1.ActionHandlerOptions(opts));break;case"fingerprint":this.handleAction(data.customer_action.value,nextStep,function(err){var gReq=new ProcessOut_1.GatewayRequest;gReq.url=data.customer_action.value,gReq.method="POST",gReq.headers={"Content-Type":"application/x-www-form-urlencoded"},gReq.body='threeDSMethodData={"threeDS2FingerprintTimeout":true}',nextStep(gReq.token())},new ProcessOut_1.ActionHandlerOptions(ProcessOut_1.ActionHandlerOptions.ThreeDSFingerprintFlow));break;case"redirect":this.handleAction(data.customer_action.value,nextStep,error,new ProcessOut_1.ActionHandlerOptions(ProcessOut_1.ActionHandlerOptions.ThreeDSChallengeFlow));break;default:error(new ProcessOut_1.Exception("processout-js.wrong-type-for-action","The customer action type ".concat(data.customer_action.type," is not supported.")))}}else success(resourceID);else error(new ProcessOut_1.Exception(data.error_type,data.message))}.bind(this),function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))},0,apiRequestOptions)},ProcessOut}();ProcessOut_1.ProcessOut=ProcessOut}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var Modal=function(){function Modal(instance,iframe,uniqId){this.deleted=!1,this.timeout=1e4,this.instance=instance,this.iframe=iframe,this.uniqId=uniqId}return Modal.prototype.show=function(options,onHide,onError){var onPayment,onPaymentError,hideAfterSuccessTimeout,onShow=options,modal=("object"==typeof options&&(onShow=options.onShow,onHide=options.onHide,onError=options.onError,onPayment=options.onPayment,onPaymentError=options.onPaymentError,hideAfterSuccessTimeout=options.hideAfterSuccessTimeout),null==hideAfterSuccessTimeout&&(hideAfterSuccessTimeout=2500),this),iframe=modal.iframe,iframeW=iframe.contentWindow,frameid=modal.uniqId,redirectTimeout=(iframeW.postMessage(JSON.stringify({namespace:ProcessOut.Message.modalNamespace,frameID:frameid,action:"check"}),"*"),setTimeout(function(){typeof onError==typeof Function&&onError(modal,new ProcessOut.Exception("processout-js.modal.unavailable"))},this.timeout));window.addEventListener("message",function(event){var devent,data=ProcessOut.Message.parseEvent(event);if(data.frameID==frameid&&data.namespace==ProcessOut.Message.modalNamespace)switch(data.action){case"openModal":clearTimeout(redirectTimeout),document.body.style.overflow="hidden",window.addEventListener("resize",function(event){iframe.width=window.outerWidth+"px",iframe.height=window.outerHeight+"px"}),"function"==typeof Event?devent=new Event("resize"):(devent=document.createEvent("Event"),event.initEvent("resize",!0,!0)),window.dispatchEvent(devent),iframe.style.display="block",iframeW.postMessage(JSON.stringify({namespace:ProcessOut.Message.modalNamespace,frameID:frameid,action:"launch"}),"*"),typeof onShow==typeof Function&&onShow(modal);break;case"closeModal":modal.hide(),typeof onHide==typeof Function&&onHide(modal);break;case"error":clearTimeout(redirectTimeout),typeof onError==typeof Function&&onError(modal,new ProcessOut.Exception(data.errorCode,data.errorMessage));break;case"onPayment":typeof onPayment==typeof Function&&onPayment(modal,data.data),0<hideAfterSuccessTimeout&&setTimeout(function(){modal.hide()},hideAfterSuccessTimeout);break;case"onPaymentError":typeof onPaymentError==typeof Function&&onPaymentError(modal,new ProcessOut.Exception(data.errorCode,data.errorMessage));break;default:console.log("Could not read event action from modal.",event.data)}},!1)},Modal.prototype.hide=function(){this.iframe.style.display="none",document.body.style.overflow="",this.iframe.remove(),this.deleted=!0},Modal.prototype.isDeleted=function(){return this.deleted},Modal}();ProcessOut.Modal=Modal}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var MessageHub=function(){function MessageHub(instance,onready,onnotify){this.instance=instance,this.onnotify=onnotify,this.load(onready)}return MessageHub.prototype.load=function(onready){var ready,tmp=Math.random().toString(36).substring(7),tmp=this.instance.getProcessOutMessageHubEndpoint("?r=".concat(tmp));window.addEventListener("message",function(event){this.active&&(event=ProcessOut.Message.parseEvent(event))&&event.namespace==ProcessOut.Message.messageHubNamespace&&"value"==event.action&&this.onnotify&&this.onnotify(event.data.key,event.data.value)}.bind(this)),MessageHub.iframe?onready&&onready(this):(ready=!1,window.addEventListener("message",function(event){ready||(event=ProcessOut.Message.parseEvent(event))&&event.namespace==ProcessOut.Message.messageHubNamespace&&"ready"==event.action&&(ready=!0,onready)&&onready(this)}.bind(this)),(MessageHub.iframe=document.createElement("iframe")).id="processout-message-hub",MessageHub.iframe.name="processout message hub",MessageHub.iframe.setAttribute("src",tmp),MessageHub.iframe.setAttribute("style","background: none; width: 0; height: 0"),MessageHub.iframe.setAttribute("frameborder","0"),MessageHub.iframe.setAttribute("allowtransparency","1"),document.body.appendChild(MessageHub.iframe)),this.active=!0},MessageHub.prototype.get=function(key){this.active&&MessageHub.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.messageHubNamespace,action:"get",data:{key:key}}),"*")},MessageHub.prototype.set=function(key,val){this.active&&MessageHub.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.messageHubNamespace,action:"set",data:{key:key,value:val}}),"*")},MessageHub}();ProcessOut.MessageHub=MessageHub}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var Message=function(){function Message(){}return Message.parseEvent=function(e){try{return JSON.parse(e.data)}catch(e){return new Message}},Message.modalNamespace="processout.modal",Message.checkoutNamespace="processout.checkout",Message.fieldNamespace="processout.field",Message.messageHubNamespace="processout.message-hub",Message}();ProcessOut.Message=Message}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var PaymentToken=function(){function PaymentToken(tokenType,payload){this.tokenType=tokenType,this.payload=payload}return PaymentToken.prototype.getTokenType=function(){return this.tokenType},PaymentToken.prototype.getPayload=function(){return this.payload},PaymentToken}();ProcessOut.PaymentToken=PaymentToken,(ProcessOut.TokenType||(ProcessOut.TokenType={})).GooglePay="googlepay"}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApm=function(){function NativeApm(processOutInstance,paymentConfig,options){this.prefilledData={},this.captureStart=null,this.processOutInstance=processOutInstance,this.paymentConfig=new ProcessOut.NativeApmPaymentConfig(paymentConfig),this.widgetOptions=options,this.theme=new ProcessOut.NativeApmThemeConfig,this.loadMarkdownLibrary()}return NativeApm.prototype.mount=function(containerSelector){if(this.napmContainer=document.querySelector(containerSelector),!this.napmContainer)throw new ProcessOut.Exception("default","Element with this selector does not exist. You must provide valid element selector");this.loadView(new ProcessOut.NativeApmSpinner(this.theme).getSpinnerElement()),this.getGatewayConfiguration({onFetch:ProcessOut.EventsUtils.dispatchWidgetLoadingEvent,onSuccess:this.onGatewayConfigurationSuccess.bind(this),onError:this.onGatewayConfigurationError.bind(this)})},NativeApm.prototype.getGatewayConfiguration=function(actions){var paymentConfig=this.paymentConfig.getConfig();actions.onFetch(),this.processOutInstance.apiRequest("GET","invoices/".concat(paymentConfig.invoiceId,"/native-payment/").concat(paymentConfig.gatewayConfigurationId),{},actions.onSuccess.bind(this),actions.onError.bind(this))},NativeApm.prototype.onGatewayConfigurationSuccess=function(data){var nativeApmFormView;return data.success?(this.gatewayConfiguration=data,this.gatewayConfiguration.native_apm&&this.gatewayConfiguration.native_apm.parameters.length?(nativeApmFormView=new ProcessOut.NativeApmFormView(this.gatewayConfiguration.native_apm,this.proceedPayment.bind(this),this.theme,this.prefilledData,this.widgetOptions),ProcessOut.EventsUtils.dispatchWidgetReadyEvent(),this.loadView(nativeApmFormView.getViewElement())):this.gatewayConfiguration.native_apm&&0===this.gatewayConfiguration.native_apm.parameters.length?(nativeApmFormView=new ProcessOut.NativeApmPendingView(this.gatewayConfiguration,this.markdownLibraryInstance,this.theme,this.capturePayment.bind(this),""),ProcessOut.EventsUtils.dispatchPaymentInitEvent(),this.loadView(nativeApmFormView.getViewElement())):void 0):(nativeApmFormView=new ProcessOut.NativeApmErrorView({},this.theme),ProcessOut.EventsUtils.dispatchGatewayConfigurationErrorEvent(data),this.loadView(nativeApmFormView.getViewElement()))},NativeApm.prototype.onGatewayConfigurationError=function(req,e,errorCode){var errorView=new ProcessOut.NativeApmErrorView({},this.theme),errorData=req.response;return!req.response&&errorCode&&(errorData={success:!1,error_type:errorCode,message:ProcessOut.Translator.translateError(errorCode)}),ProcessOut.EventsUtils.dispatchGatewayConfigurationErrorEvent(errorData),this.loadView(errorView.getViewElement())},NativeApm.prototype.proceedPayment=function(paymentData,onFormSubmitFinished,onFormApiValidationError){var _this=this,paymentConfig=this.paymentConfig.getConfig();this.processOutInstance.apiRequest("POST","invoices/".concat(paymentConfig.invoiceId,"/native-payment"),{gateway_configuration_id:paymentConfig.gatewayConfigurationId,native_apm:{parameter_values:paymentData}},function(data){return _this.handlePaymentSuccess(data,onFormSubmitFinished,onFormApiValidationError)},this.handlePaymentError.bind(this))},NativeApm.prototype.handlePaymentSuccess=function(data,onFormSubmitFinished,onFormApiValidationError){return onFormSubmitFinished(),ProcessOut.ErrorsUtils.isFieldsValidationError(data)?onFormApiValidationError(data.invalid_fields):!ProcessOut.ErrorsUtils.isValidationError(data)&&data.success?data.native_apm&&"CUSTOMER_INPUT"===data.native_apm.state?(onFormSubmitFinished=new ProcessOut.NativeApmFormView({gateway:this.gatewayConfiguration.native_apm.gateway,parameters:data.native_apm.parameterDefinitions,invoice:this.gatewayConfiguration.native_apm.invoice},this.proceedPayment.bind(this),this.theme,this.prefilledData),ProcessOut.EventsUtils.dispatchPaymentAdditionalInputEvent(),this.loadView(onFormSubmitFinished.getViewElement())):data.native_apm&&"PENDING_CAPTURE"===data.native_apm.state?(this.updatePaymentProviderLogo(data.native_apm.parameterValues.provider_logo_url),onFormApiValidationError=new ProcessOut.NativeApmPendingView(this.gatewayConfiguration,this.markdownLibraryInstance,this.theme,this.capturePayment.bind(this),data.native_apm.parameterValues.customer_action_message),ProcessOut.EventsUtils.dispatchPaymentInitEvent(),this.loadView(onFormApiValidationError.getViewElement())):void 0:(onFormSubmitFinished=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme),ProcessOut.EventsUtils.dispatchPaymentErrorEvent(data),this.loadView(onFormSubmitFinished.getViewElement()))},NativeApm.prototype.handlePaymentError=function(req,e,errorCode){var errorView=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme),errorData=req.response;!req.response&&errorCode&&(errorData={success:!1,error_type:errorCode,message:ProcessOut.Translator.translateError(errorCode)}),ProcessOut.EventsUtils.dispatchPaymentErrorEvent(errorData),this.loadView(errorView.getViewElement())},NativeApm.prototype.capturePayment=function(){var paymentConfig=this.paymentConfig.getConfig();this.captureStart||(this.captureStart=new Date),this.processOutInstance.apiRequest("POST","invoices/".concat(paymentConfig.invoiceId,"/capture"),{source:paymentConfig.gatewayConfigurationId},this.handleCaptureSuccess.bind(this),this.handleCaptureError.bind(this))},NativeApm.prototype.checkIfCaptureTimeout=function(){return 180<=((new Date).getTime()-this.captureStart.getTime())/1e3},NativeApm.prototype.handleCaptureSuccess=function(data){if(data.success&&data.native_apm&&"PENDING_CAPTURE"===data.native_apm.state&&!this.checkIfCaptureTimeout())return this.capturePayment();if(data.success&&data.native_apm&&"PENDING_CAPTURE"===data.native_apm.state&&this.checkIfCaptureTimeout())return this.captureStart=null,ProcessOut.EventsUtils.dispatchPaymentErrorEvent(data);var errorView;if(!data.success)return this.captureStart=null,errorView=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme),ProcessOut.EventsUtils.dispatchPaymentErrorEvent(data),this.loadView(errorView.getViewElement());this.captureStart=null;data=new ProcessOut.NativeApmSuccessView(this.gatewayConfiguration,this.markdownLibraryInstance,this.theme);return ProcessOut.EventsUtils.dispatchPaymentSuccessEvent(),this.loadView(data.getViewElement())},NativeApm.prototype.handleCaptureError=function(req,e,errorCode){var errorView=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme),errorData=req.response;!req.response&&errorCode&&(errorData={success:!1,error_type:errorCode,message:ProcessOut.Translator.translateError(errorCode)}),ProcessOut.EventsUtils.dispatchPaymentErrorEvent(errorData),this.loadView(errorView.getViewElement())},NativeApm.prototype.setTheme=function(themeConfig){return this.theme.setTheme(themeConfig)},NativeApm.prototype.prefillData=function(data){this.prefilledData=data},NativeApm.prototype.loadView=function(view){this.widgetWrapper&&this.napmContainer.removeChild(this.widgetWrapper),this.widgetWrapper=this.createWidgetWrapper(),this.widgetWrapper.appendChild(view),this.napmContainer.appendChild(this.widgetWrapper)},NativeApm.prototype.updatePaymentProviderLogo=function(logoUrl){logoUrl&&(this.gatewayConfiguration=__assign(__assign({},this.gatewayConfiguration),{native_apm:__assign(__assign({},this.gatewayConfiguration.native_apm),{gateway:__assign(__assign({},this.gatewayConfiguration.native_apm.gateway),{logo_url:logoUrl})})}))},NativeApm.prototype.createWidgetWrapper=function(){var widgetWrapper=document.createElement("div"),styleElement=this.theme.createInitialStyleTag();return widgetWrapper.setAttribute("class","native-apm-widget-wrapper"),widgetWrapper.appendChild(styleElement),ProcessOut.StylesUtils.styleElement(widgetWrapper,this.theme.wrapper),widgetWrapper},NativeApm.prototype.loadMarkdownLibrary=function(){var _this=this,markdownScript=document.createElement("script");markdownScript.src="https://js.processout.ninja/js/libraries/showdown.min.js",markdownScript.onload=function(){_this.markdownLibraryInstance=window.globalThis&&window.globalThis.showdown?new window.globalThis.showdown.Converter:null},document.head.appendChild(markdownScript)},NativeApm}();ProcessOut.NativeApm=NativeApm}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmPaymentConfig=function(){function NativeApmPaymentConfig(config){this.setConfig(config)}return NativeApmPaymentConfig.prototype.getConfig=function(){return{gatewayConfigurationId:this.gatewayConfigurationId,invoiceId:this.invoiceId}},NativeApmPaymentConfig.prototype.setConfig=function(config){if(!this.isValidConfig(config))throw new ProcessOut.Exception("default","You must instantiate Native APM with a valid config in order to use it");this.gatewayConfigurationId=config.gatewayConfigurationId,this.invoiceId=config.invoiceId},NativeApmPaymentConfig.prototype.isValidConfig=function(config){return config.gatewayConfigurationId&&config.invoiceId},NativeApmPaymentConfig}();ProcessOut.NativeApmPaymentConfig=NativeApmPaymentConfig}(ProcessOut=ProcessOut||{}),{wrapper:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",width:"100%",fontSize:"1rem"},spinner:{width:"4rem",height:"4rem",border:"5px solid #f2f2f2",borderBottomColor:"#7e57c2",borderRadius:"50%",display:"inline-block",boxSizing:"border-box",animation:"rotation 1s linear infinite"},logo:{width:"10rem",height:"auto",marginBottom:"1rem"},buttons:{"default":{borderWidth:"0px",color:"#fff",backgroundColor:"#7e57c2",cursor:"pointer",padding:"0.8rem 1.5rem",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",marginTop:"0.8rem",fontSize:"1rem",borderRadius:"5px"},spinner:{position:"absolute",width:"1rem",height:"1rem",border:"3px solid #f2f2f2",borderBottomColor:"#7e57c2",borderRadius:"50%",display:"inline-block",boxSizing:"border-box",animation:"rotation 1s linear infinite"}},form:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"0.8rem",width:"100%",inputsWrapper:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:"0.8rem",alignItems:"center",width:"100%"},inputs:{wrapper:{width:"inherit"},text:{padding:"0 0.8rem",height:"3rem",border:"1px solid #d7d7d7",borderRadius:"5px",width:"100%",fontSize:"1rem"},select:{height:"3rem",width:"100%",border:"1px solid #d7d7d7",borderRadius:"5px",fontSize:"1rem"},numeric:{display:"flex",flexDirection:"row",gap:"0.8rem",character:{width:"3rem",height:"3rem",fontSize:"1.5rem",border:"1px solid #d7d7d7",borderRadius:"5px",textAlign:"center"}}},labels:{display:"block",marginBottom:"10px",requiredStar:{color:"#e74c3c",marginLeft:"0.1rem"}},errors:{display:"block",color:"#e74c3c",fontSize:"0.9rem",minHeight:"1rem",marginTop:"0.3rem",width:"100%"}},message:{fontSize:"1.1rem"},actionImage:{marginTop:"1.3rem",width:"15rem",height:"auto"}}),spinnerLoadingAnimation="\n@keyframes rotation {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n",dynamicStyles=(!function(ProcessOut){var NativeApmThemeConfig=function(){function NativeApmThemeConfig(){this.wrapper=defaultTheme.wrapper,this.spinner=defaultTheme.spinner,this.logo=defaultTheme.logo,this.buttons=defaultTheme.buttons,this.form=defaultTheme.form,this.message=defaultTheme.message,this.actionImage=defaultTheme.actionImage}return NativeApmThemeConfig.prototype.getTheme=function(){return{wrapper:this.wrapper,spinner:this.spinner,logo:this.logo,buttons:this.buttons,form:this.form,message:this.message,actionImage:this.actionImage}},NativeApmThemeConfig.prototype.setTheme=function(theme){var mergeObjects=function(obj1,obj2){for(var key in obj2)obj2.hasOwnProperty(key)&&("object"==typeof obj2[key]&&null!==obj2[key]?obj1[key]=mergeObjects(obj1[key],obj2[key]):obj1[key]=obj2[key]);return obj1};mergeObjects(this.wrapper,theme.wrapper),mergeObjects(this.spinner,theme.spinner),mergeObjects(this.logo,theme.logo),mergeObjects(this.buttons,theme.buttons),mergeObjects(this.form,theme.form),mergeObjects(this.message,theme.message),mergeObjects(this.actionImage,theme.actionImage)},NativeApmThemeConfig.prototype.createInitialStyleTag=function(){var styleElement=document.createElement("style");return styleElement.innerHTML=spinnerLoadingAnimation,styleElement},NativeApmThemeConfig}();ProcessOut.NativeApmThemeConfig=NativeApmThemeConfig}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var StylesUtils=function(){function StylesUtils(){}return StylesUtils.styleElement=function(node,styles){return Object.keys(styles).forEach(function(style){node.style[style]=styles[style]})},StylesUtils}();ProcessOut.StylesUtils=StylesUtils}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NATIVE_APM_EVENTS_WIDGET_LOADING="processout_native_apm_loading",NATIVE_APM_EVENTS_WIDGET_READY="processout_native_apm_ready",NATIVE_APM_EVENTS_GATEWAY_CONFIGURATION_ERROR="processout_native_apm_gateway_configuration_error",NATIVE_APM_EVENTS_PAYMENT_INIT="processout_native_apm_payment_init",NATIVE_APM_EVENTS_PAYMENT_ADDITIONAL_INPUT="processout_native_apm_payment_additional_input",NATIVE_APM_EVENTS_PAYMENT_SUCCESS="processout_native_apm_payment_success",NATIVE_APM_EVENTS_PAYMENT_ERROR="processout_native_apm_payment_error",EventsUtils=function(){function EventsUtils(){}return EventsUtils.dispatchGatewayConfigurationErrorEvent=function(errorData){errorData=EventsUtils.createEvent(NATIVE_APM_EVENTS_GATEWAY_CONFIGURATION_ERROR,errorData);return window.dispatchEvent(errorData)},EventsUtils.dispatchPaymentInitEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_PAYMENT_INIT);return window.dispatchEvent(event)},EventsUtils.dispatchWidgetLoadingEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_WIDGET_LOADING);return window.dispatchEvent(event)},EventsUtils.dispatchWidgetReadyEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_WIDGET_READY);return window.dispatchEvent(event)},EventsUtils.dispatchPaymentAdditionalInputEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_PAYMENT_ADDITIONAL_INPUT);return window.dispatchEvent(event)},EventsUtils.dispatchPaymentSuccessEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_PAYMENT_SUCCESS);return window.dispatchEvent(event)},EventsUtils.dispatchPaymentErrorEvent=function(errorData){errorData=EventsUtils.createEvent(NATIVE_APM_EVENTS_PAYMENT_ERROR,errorData);return window.dispatchEvent(errorData)},EventsUtils.createEvent=function(eventName,data){var event_1;return"function"==typeof window.CustomEvent?new CustomEvent(eventName,{bubbles:!0,detail:data}):((event_1=document.createEvent("CustomEvent")).initCustomEvent(eventName,!0,!1,data),event_1)},EventsUtils}();ProcessOut.EventsUtils=EventsUtils}(ProcessOut=ProcessOut||{}),!function(ProcessOut){ProcessOut.texts={en:{invalidCode:"Code is not valid.",invalidPhoneNumber:"Phone number is not valid.",invalidTextValue:"Value is not valid.",invalidEmail:"Email is not valid.",phoneNumberPlaceholder:"Enter phone number",phoneNumberLabel:"Phone number",emailPlaceholder:"name@exmple.com",submitButtonText:"Pay",paymentSuccessMessage:"Success!\nPayment approved.",genericError:"Something went wrong, please try again.",paymentTimeout:"The payment was not confirmed in time in the banking application. Please try again."},pl:{invalidCode:"Niepoprawny kod.",invalidPhoneNumber:"Niepoprawny numer telefonu.",invalidTextValue:"Niepoprawna wartość.",invalidEmail:"Niepoprawny adres email.",phoneNumberPlaceholder:"Twój numer telefonu",phoneNumberLabel:"Numer telefonu",emailPlaceholder:"imię@przykład.pl",submitButtonText:"Zapłać",paymentSuccessMessage:"Sukces!\nPłatność przyjęta.",genericError:"Coś poszło nie tak, spróbuj ponownie.",paymentTimeout:"Płatność odrzucona. Czas na potwierdzenie transakcji został przekroczony. Spróbuj ponownie."},pt:{invalidCode:"Número inválido.",invalidPhoneNumber:"Número de telemóvel inválido.",invalidTextValue:"Texto inválido.",invalidEmail:"Endereço de e-mail inválido.",phoneNumberPlaceholder:"Insira o seu número de telemóvel",phoneNumberLabel:"Nº de telemóvel",emailPlaceholder:"nome@exemplo.pt",submitButtonText:"Pagar",paymentSuccessMessage:"Successo!\nPagamento aprovado.",genericError:"Ocorreu um erro ao processar o seu cartão, por favor tente novamente.",paymentTimeout:"O pagamento não foi confirmado a tempo no aplicativo bancário. Por favor, tente novamente."},fr:{invalidCode:"Numéro invalide.",invalidPhoneNumber:"Votre numéro de téléphone est invalide.",invalidTextValue:"Valeur invalide.",invalidEmail:"Votre adresse e-mail est invalide.",phoneNumberPlaceholder:"Entrez votre numéro de téléphone",phoneNumberLabel:"Numéro de téléphone",emailPlaceholder:"nom@exemple.fr",submitButtonText:"Payer",paymentSuccessMessage:"Succès!\nPaiement confirmé.",genericError:"Une erreur s’est produite, veuillez réessayer.",paymentTimeout:"Le paiement n'a pas été confirmé à temps dans l'application bancaire. Veuillez réessayer."}};var TextUtils=function(){function TextUtils(){}return TextUtils.getText=function(key){var locale=ProcessOut.Translator.getLocale(),locale=ProcessOut.texts.hasOwnProperty(locale)?locale:"en";return ProcessOut.texts[locale][key]||""},TextUtils}();ProcessOut.TextUtils=TextUtils}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var ErrorsUtils=function(){function ErrorsUtils(){}return ErrorsUtils.isFieldsValidationError=function(errorData){var error_type=errorData.error_type,errorData=errorData.invalid_fields;return("request.validation.error"===error_type||"gateway.invalid-customer-input"===error_type)&&0<errorData.length},ErrorsUtils.isValidationError=function(errorData){var error_type=errorData.error_type,errorData=errorData.invalid_fields;return("request.validation.error"===error_type||"gateway.invalid-customer-input"===error_type)&&0===errorData.length},ErrorsUtils}();ProcessOut.ErrorsUtils=ErrorsUtils}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmButton=function(){function NativeApmButton(text,theme){this.loadingSpinnerID="button-loading-spinner",this.theme=theme,this.buttonElement=this.createButtonElement(text)}return NativeApmButton.prototype.getButtonElement=function(){return this.buttonElement},NativeApmButton.prototype.createButtonElement=function(text){var buttonElement=document.createElement("button");return buttonElement.setAttribute("type","submit"),buttonElement.setAttribute("class","native-apm-button"),this.buttonText=document.createElement("span"),this.buttonText.textContent=text,ProcessOut.StylesUtils.styleElement(buttonElement,this.theme.buttons["default"]),buttonElement.appendChild(this.buttonText),buttonElement},NativeApmButton.prototype.setLoadingState=function(){var spinner=this.createLoadingSpinner();ProcessOut.StylesUtils.styleElement(this.buttonText,{opacity:"0"}),this.buttonElement.appendChild(spinner)},NativeApmButton.prototype.resetLoadingState=function(){ProcessOut.StylesUtils.styleElement(this.buttonText,{opacity:"1"}),this.removeLoadingSpinner()},NativeApmButton.prototype.createLoadingSpinner=function(){var spinner=new ProcessOut.NativeApmSpinner(this.theme,this.loadingSpinnerID).getSpinnerElement();return ProcessOut.StylesUtils.styleElement(spinner,this.theme.buttons.spinner),spinner},NativeApmButton.prototype.removeLoadingSpinner=function(){var spinner=document.getElementById(this.loadingSpinnerID);spinner&&this.buttonElement.removeChild(spinner)},NativeApmButton}();ProcessOut.NativeApmButton=NativeApmButton}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmSpinner=function(){function NativeApmSpinner(theme,id){this.theme=theme,this.spinnerElement=this.createSpinnerElement(id)}return NativeApmSpinner.prototype.getSpinnerElement=function(){return this.spinnerElement},NativeApmSpinner.prototype.createSpinnerElement=function(id){var spinnerElement=document.createElement("span");return spinnerElement.setAttribute("class","native-apm-spinner"),id&&spinnerElement.setAttribute("id",id),ProcessOut.StylesUtils.styleElement(spinnerElement,this.theme.spinner),spinnerElement},NativeApmSpinner}();ProcessOut.NativeApmSpinner=NativeApmSpinner}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmTextInput=function(){function NativeApmTextInput(inputData,theme,prefilledValue){this.theme=theme,this.inputData=inputData,this.inputElement=this.createInputElement(prefilledValue),this.inputLabel=this.createInputLabel(),this.errorMessageElement=this.createErrorMessageElement()}return NativeApmTextInput.prototype.getInputElement=function(){var inputWrapper=document.createElement("div");return inputWrapper.setAttribute("class","native-apm-text-input-wrapper"),ProcessOut.StylesUtils.styleElement(inputWrapper,this.theme.form.inputs.wrapper),inputWrapper.appendChild(this.inputLabel),inputWrapper.appendChild(this.inputElement),inputWrapper.appendChild(this.errorMessageElement),inputWrapper},NativeApmTextInput.prototype.validate=function(){var isRequiredPassed=!this.inputData.required||0<this.inputElement.value.length,maxLengthPassed=!this.inputData.max_length||this.inputElement.value.length<=this.inputData.max_length,lengthPassed=!this.inputData.length||this.inputElement.value.length===this.inputData.length;return isRequiredPassed&&maxLengthPassed&&lengthPassed||this.setErrorMessage(),isRequiredPassed&&maxLengthPassed&&lengthPassed},NativeApmTextInput.prototype.getValue=function(){var _a={};return _a[this.inputData.key]=this.inputElement.value,_a},NativeApmTextInput.prototype.getRawInputElement=function(){return this.inputElement},NativeApmTextInput.prototype.createInputElement=function(prefilledValue){var input=document.createElement("input");return input.setAttribute("class","native-apm-text-input"),input.setAttribute("name",this.inputData.key),input.setAttribute("id",this.inputData.key),prefilledValue&&(input.value=prefilledValue),input.addEventListener("keypress",this.resetErrorMessage.bind(this)),ProcessOut.StylesUtils.styleElement(input,this.theme.form.inputs.text),input},NativeApmTextInput.prototype.createErrorMessageElement=function(){var errorMessageElement=document.createElement("span");return errorMessageElement.setAttribute("class","native-apm-input-error"),ProcessOut.StylesUtils.styleElement(errorMessageElement,this.theme.form.errors),errorMessageElement},NativeApmTextInput.prototype.createInputLabel=function(){var requiredStar,label=document.createElement("label");return label.setAttribute("class","native-apm-input-label"),label.setAttribute("for",this.inputData.key),label.textContent=this.inputData.display_name,this.inputData.required&&(requiredStar=this.createRequiredStar(),label.appendChild(requiredStar)),ProcessOut.StylesUtils.styleElement(label,this.theme.form.labels),label},NativeApmTextInput.prototype.createRequiredStar=function(){var requiredStar=document.createElement("span");return requiredStar.textContent="*",ProcessOut.StylesUtils.styleElement(requiredStar,this.theme.form.labels.requiredStar),requiredStar},NativeApmTextInput.prototype.resetErrorMessage=function(){this.errorMessageElement.textContent.length&&(this.errorMessageElement.textContent="")},NativeApmTextInput.prototype.setErrorMessage=function(){this.errorMessageElement.textContent=ProcessOut.TextUtils.getText("invalidTextValue")},NativeApmTextInput.prototype.getInputData=function(){return this.inputData},NativeApmTextInput}();ProcessOut.NativeApmTextInput=NativeApmTextInput}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmNumericInput=function(){function NativeApmNumericInput(inputData,theme){this.theme=theme,this.inputData=inputData,this.inputElement=this.createInputElement(),this.errorMessageElement=this.createErrorMessageElement(),this.inputLabel=this.createInputLabel()}return NativeApmNumericInput.prototype.getInputElement=function(){var inputWrapper=document.createElement("div");return inputWrapper.setAttribute("class","native-apm-numeric-input-wrapper"),ProcessOut.StylesUtils.styleElement(inputWrapper,this.theme.form.inputs.wrapper),inputWrapper.appendChild(this.inputLabel),inputWrapper.appendChild(this.inputElement),inputWrapper.appendChild(this.errorMessageElement),inputWrapper},NativeApmNumericInput.prototype.createInputElement=function(){for(var input=document.createElement("div"),i=0;i<this.inputData.length;i++){var inputDigit=this.createInputDigitElement();input.appendChild(inputDigit)}return input.setAttribute("class","native-apm-numeric-input"),ProcessOut.StylesUtils.styleElement(input,this.theme.form.inputs.numeric),input},NativeApmNumericInput.prototype.createInputDigitElement=function(){var _this=this,inputDigit=document.createElement("input");inputDigit.setAttribute("class","native-apm-numeric-input-character"),inputDigit.setAttribute("type","text"),inputDigit.setAttribute("maxlength","1"),inputDigit.setAttribute("id",this.inputData.key);return inputDigit.addEventListener("input",function(e){_this.resetErrorMessage();e=e.target;e.value=e.value.replace(/[^0-9]/g,""),""!==e.value&&e.nextElementSibling&&"INPUT"===e.nextElementSibling.nodeName&&e.nextElementSibling.focus()}),inputDigit.addEventListener("keydown",function(e){"Backspace"===e.key&&e.target instanceof HTMLInputElement&&e.target.previousElementSibling&&""===e.target.value&&e.target.previousElementSibling.focus()}),ProcessOut.StylesUtils.styleElement(inputDigit,this.theme.form.inputs.numeric.character),inputDigit},NativeApmNumericInput.prototype.createErrorMessageElement=function(){var errorMessageElement=document.createElement("span");return errorMessageElement.setAttribute("class","native-apm-input-error"),ProcessOut.StylesUtils.styleElement(errorMessageElement,this.theme.form.errors),errorMessageElement},NativeApmNumericInput.prototype.createInputLabel=function(){var requiredStar,label=document.createElement("label");return label.textContent=this.inputData.display_name,label.setAttribute("class","native-apm-input-label"),label.setAttribute("for",this.inputData.key),this.inputData.required&&(requiredStar=this.createRequiredStar(),label.appendChild(requiredStar)),ProcessOut.StylesUtils.styleElement(label,this.theme.form.labels),label},NativeApmNumericInput.prototype.createRequiredStar=function(){var requiredStar=document.createElement("span");return requiredStar.textContent="*",ProcessOut.StylesUtils.styleElement(requiredStar,this.theme.form.labels.requiredStar),requiredStar},NativeApmNumericInput.prototype.validate=function(){var isValid=Array.prototype.slice.call(this.inputElement.childNodes).every(function(input){return input.value.length});return isValid||this.setErrorMessage(),isValid},NativeApmNumericInput.prototype.getValue=function(){var value=Array.prototype.slice.call(this.inputElement.childNodes).reduce(function(acc,input){return acc+input.value},""),_a={};return _a[this.inputData.key]=value,_a},NativeApmNumericInput.prototype.resetErrorMessage=function(){this.errorMessageElement.textContent.length&&(this.errorMessageElement.textContent="")},NativeApmNumericInput.prototype.setErrorMessage=function(){this.errorMessageElement.textContent=ProcessOut.TextUtils.getText("invalidCode")},NativeApmNumericInput}();ProcessOut.NativeApmNumericInput=NativeApmNumericInput}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmEmailInput=function(_super){function NativeApmEmailInput(inputData,theme,prefilledValue){inputData=_super.call(this,inputData,theme,prefilledValue)||this,inputData.emailRegex=/^\S+@\S+$/i,theme=_super.prototype.getRawInputElement.call(inputData);return theme.setAttribute("placeholder",ProcessOut.TextUtils.getText("emailPlaceholder")),theme.setAttribute("type","email"),inputData}return __extends(NativeApmEmailInput,_super),NativeApmEmailInput.prototype.validate=function(){var isRequiredPassed=_super.prototype.validate.call(this),isEmail=this.emailRegex.test(this.inputElement.value);return isEmail||this.setErrorMessage(),isRequiredPassed&&isEmail},NativeApmEmailInput.prototype.setErrorMessage=function(){this.errorMessageElement.textContent=ProcessOut.TextUtils.getText("invalidEmail")},NativeApmEmailInput}(ProcessOut.NativeApmTextInput);ProcessOut.NativeApmEmailInput=NativeApmEmailInput}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmPhoneInput=function(_super){function NativeApmPhoneInput(inputData,theme,prefilledValue){inputData=_super.call(this,inputData,theme,prefilledValue)||this;return inputData.phoneNumberRegex=/^\+[1-9][0-9]{10,14}$/,_super.prototype.getRawInputElement.call(inputData).setAttribute("placeholder",ProcessOut.TextUtils.getText("phoneNumberPlaceholder")),inputData.inputLabel=inputData.createInputLabel(),inputData}return __extends(NativeApmPhoneInput,_super),NativeApmPhoneInput.prototype.getValue=function(){var _a={};return _a[this.inputData.key]=this.inputElement.value.replace(/\s/g,""),_a},NativeApmPhoneInput.prototype.createInputLabel=function(){var requiredStar,label=document.createElement("label");return label.setAttribute("class","native-apm-input-label"),label.textContent=ProcessOut.TextUtils.getText("phoneNumberLabel"),this.inputData.required&&(requiredStar=_super.prototype.createRequiredStar.call(this),label.appendChild(requiredStar)),ProcessOut.StylesUtils.styleElement(label,this.theme.form.labels),label},NativeApmPhoneInput.prototype.validate=function(){var isRequiredPassed=_super.prototype.validate.call(this),valueWithoutSpaces=this.inputElement.value.replace(/\s/g,""),valueWithoutSpaces=this.phoneNumberRegex.test(valueWithoutSpaces);return valueWithoutSpaces||this.setErrorMessage(),isRequiredPassed&&valueWithoutSpaces},NativeApmPhoneInput.prototype.setErrorMessage=function(message){this.errorMessageElement.textContent=message||ProcessOut.TextUtils.getText("invalidPhoneNumber")},NativeApmPhoneInput}(ProcessOut.NativeApmTextInput);ProcessOut.NativeApmPhoneInput=NativeApmPhoneInput}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmSelectInput=function(){function NativeApmSelectInput(inputData,theme){this.theme=theme,this.inputData=inputData,this.inputElement=this.createInputElement(),this.inputLabel=this.createInputLabel(),this.errorMessageElement=this.createErrorMessageElement()}return NativeApmSelectInput.prototype.getInputElement=function(){var inputWrapper=document.createElement("div");return ProcessOut.StylesUtils.styleElement(inputWrapper,this.theme.form.inputs.wrapper),inputWrapper.appendChild(this.inputLabel),inputWrapper.appendChild(this.inputElement),inputWrapper.appendChild(this.errorMessageElement),inputWrapper},NativeApmSelectInput.prototype.validate=function(){return!0},NativeApmSelectInput.prototype.getValue=function(){var _a={};return _a[this.inputData.key]=this.inputElement.value,_a},NativeApmSelectInput.prototype.getRawInputElement=function(){return this.inputElement},NativeApmSelectInput.prototype.createInputElement=function(){var _this=this,input=document.createElement("select");return input.setAttribute("class","native-apm-select-input"),input.setAttribute("name",this.inputData.key),this.inputData.available_values.forEach(function(value){var optionElement=_this.createOptionElement(value);input.appendChild(optionElement),value["default"]&&input.setAttribute("selected","true")}),ProcessOut.StylesUtils.styleElement(input,this.theme.form.inputs.select),input},NativeApmSelectInput.prototype.createOptionElement=function(value){var optionElement=document.createElement("option");return optionElement.setAttribute("value",value.value),optionElement.textContent=value.display_name,optionElement},NativeApmSelectInput.prototype.createInputLabel=function(){var label=document.createElement("label");return label.textContent=this.inputData.display_name,label.setAttribute("class","native-apm-input-label"),ProcessOut.StylesUtils.styleElement(label,this.theme.form.labels),label},NativeApmSelectInput.prototype.createErrorMessageElement=function(){var errorMessageElement=document.createElement("span");return errorMessageElement.setAttribute("class","native-apm-input-error"),ProcessOut.StylesUtils.styleElement(errorMessageElement,this.theme.form.errors),errorMessageElement},NativeApmSelectInput.prototype.setErrorMessage=function(){this.errorMessageElement.textContent=ProcessOut.TextUtils.getText("invalidTextValue")},NativeApmSelectInput}();ProcessOut.NativeApmSelectInput=NativeApmSelectInput}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmInput=function(){function NativeApmInput(inputData,theme,prefilledValue){this.inputInstance=this.createInputElement(inputData,theme,prefilledValue)}return NativeApmInput.prototype.getInputElement=function(){return this.inputInstance.getInputElement()},NativeApmInput.prototype.getInputInstance=function(){return this.inputInstance},NativeApmInput.prototype.getInputValue=function(){return this.inputInstance.getValue()},NativeApmInput.prototype.createInputElement=function(inputData,theme,prefilledValue){switch(inputData.type){case"email":return new ProcessOut.NativeApmEmailInput(inputData,theme,prefilledValue);case"numeric":return inputData.length<=6?new ProcessOut.NativeApmNumericInput(inputData,theme):new ProcessOut.NativeApmTextInput(inputData,theme,prefilledValue);case"phone":return new ProcessOut.NativeApmPhoneInput(inputData,theme,prefilledValue);case"single_select":case"single-select":return new ProcessOut.NativeApmSelectInput(inputData,theme);default:return new ProcessOut.NativeApmTextInput(inputData,theme,prefilledValue)}},NativeApmInput}();ProcessOut.NativeApmInput=NativeApmInput}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmFormView=function(){function NativeApmFormView(formData,onSubmitHandler,theme,prefilledData,widgetOptions){if(!formData)throw new ProcessOut.Exception("default","Form data is not defined. You must provide valid form data to create the form view.");this.widgetOptions=widgetOptions,this.theme=theme,this.prefilledData=prefilledData,this.formData=formData,this.onSubmitHandler=onSubmitHandler,this.formInputs=this.createFormInputs(),this.submitButton=this.createSubmitButton(),this.formElement=this.createFormElement()}return NativeApmFormView.prototype.getViewElement=function(){return this.formElement},NativeApmFormView.prototype.createFormElement=function(){var form=document.createElement("form"),inputsWrapper=document.createElement("div"),paymentProviderImage=this.createPaymentProviderImage();return form.setAttribute("class","native-apm-form"),inputsWrapper.setAttribute("class","native-apm-form-inputs-wrapper"),ProcessOut.StylesUtils.styleElement(form,this.theme.form),this.styleInputsWrapper(inputsWrapper),this.formInputs.forEach(function(input){inputsWrapper.appendChild(input.getInputElement())}),form.appendChild(paymentProviderImage),form.appendChild(inputsWrapper),form.appendChild(this.submitButton.getButtonElement()),this.widgetOptions&&this.widgetOptions.dynamicCheckout&&this.widgetOptions.dynamicCheckout.onBackButtonClick&&(paymentProviderImage=this.createBackButton(this.widgetOptions.dynamicCheckout.onBackButtonClick),form.appendChild(paymentProviderImage)),form.addEventListener("submit",this.submitForm.bind(this)),form},NativeApmFormView.prototype.createFormInputs=function(){var _this=this;return this.formData.parameters.map(function(parameter){var prefilledValue=_this.prefilledData[parameter.key];return new ProcessOut.NativeApmInput(parameter,_this.theme,prefilledValue)})},NativeApmFormView.prototype.createSubmitButton=function(){var buttonText="\n      ".concat(ProcessOut.TextUtils.getText("submitButtonText")," \n      ").concat(this.formData.invoice.amount," \n      ").concat(this.formData.invoice.currency_code,"\n      ");return new ProcessOut.NativeApmButton(buttonText,this.theme)},NativeApmFormView.prototype.createBackButton=function(onBackButtonClick){var backButton=document.createElement("button");return backButton.setAttribute("class","native-apm-back-button"),backButton.setAttribute("type","button"),backButton.textContent="Back",backButton.addEventListener("click",function(e){onBackButtonClick()}),backButton},NativeApmFormView.prototype.createPaymentProviderImage=function(){var merchantImg=document.createElement("img");return merchantImg.setAttribute("class","native-apm-payment-provider-logo"),merchantImg.setAttribute("src",this.formData.gateway.logo_url),ProcessOut.StylesUtils.styleElement(merchantImg,this.theme.logo),merchantImg},NativeApmFormView.prototype.submitForm=function(event){var _this=this;event.preventDefault(),this.formInputs.every(function(input){return input.getInputInstance().validate()})&&(event=this.getValuesFromInputs(),this.submitButton.setLoadingState(),this.onSubmitHandler(event,function(){return _this.submitButton.resetLoadingState()},function(invalid_fields){return _this.handleApiValidationErrors(invalid_fields)}))},NativeApmFormView.prototype.handleApiValidationErrors=function(invalid_fields){var _this=this;return invalid_fields.forEach(function(invalidField){return _this.markInputAsNotValid(invalidField)})},NativeApmFormView.prototype.markInputAsNotValid=function(invalidInputData){this.formInputs.forEach(function(input){input.getInputInstance().inputData.key===invalidInputData.name&&input.getInputInstance().setErrorMessage()})},NativeApmFormView.prototype.getValuesFromInputs=function(){return this.formInputs.reduce(function(acc,input){return __assign(__assign({},acc),input.getInputValue())},{})},NativeApmFormView.prototype.styleInputsWrapper=function(inputsWrapper){1===this.formInputs.length&&"numeric"===this.formInputs[0].getInputInstance().inputData.type?ProcessOut.StylesUtils.styleElement(inputsWrapper,__assign(__assign({},this.theme.form.inputsWrapper),{width:"auto"})):ProcessOut.StylesUtils.styleElement(inputsWrapper,this.theme.form.inputsWrapper)},NativeApmFormView}();ProcessOut.NativeApmFormView=NativeApmFormView}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmPendingView=function(){function NativeApmPendingView(gatewayConfiguration,markdownLibraryInstance,theme,capturePayment,customerMessage){if(!gatewayConfiguration)throw new ProcessOut.Exception("default","Gateway configuration is not defined. You must provide valid gateway configuration");this.markdownLibraryInstance=markdownLibraryInstance,this.gatewayConfiguration=gatewayConfiguration,this.theme=theme,this.customerActionMessage=customerMessage,this.viewElement=this.createViewElement(),capturePayment()}return NativeApmPendingView.prototype.getViewElement=function(){return this.viewElement},NativeApmPendingView.prototype.createViewElement=function(){var wrapper=this.createWrapper(),merchantImg=this.createMerchantImageElement(),customerMessage=this.createCustomerMessage(),customerMessageImage=this.createCustomerMessageImage(),loadingSpinner=this.createLoadingSpinner();return wrapper.appendChild(merchantImg),wrapper.appendChild(customerMessage),wrapper.appendChild(loadingSpinner),wrapper.appendChild(customerMessageImage),wrapper},NativeApmPendingView.prototype.createMerchantImageElement=function(){var merchantImg=document.createElement("img");return merchantImg.setAttribute("class","native-apm-payment-provider-logo"),merchantImg.setAttribute("src",this.gatewayConfiguration.native_apm.gateway.logo_url),ProcessOut.StylesUtils.styleElement(merchantImg,this.theme.logo),merchantImg},NativeApmPendingView.prototype.createWrapper=function(){var wrapper=document.createElement("div");return wrapper.setAttribute("class","native-apm-view-wrapper"),ProcessOut.StylesUtils.styleElement(wrapper,this.theme.wrapper),wrapper},NativeApmPendingView.prototype.createCustomerMessage=function(){var customerMessage=document.createElement("p"),message=(customerMessage.setAttribute("class","native-apm-message"),ProcessOut.StylesUtils.styleElement(customerMessage,this.theme.message),this.gatewayConfiguration.native_apm.gateway.customer_action_message||this.customerActionMessage);return customerMessage.innerHTML=this.markdownLibraryInstance&&this.markdownLibraryInstance.makeHtml?this.markdownLibraryInstance.makeHtml(message):message,customerMessage},NativeApmPendingView.prototype.createLoadingSpinner=function(){var spinner=new ProcessOut.NativeApmSpinner(this.theme).getSpinnerElement();return ProcessOut.StylesUtils.styleElement(spinner,this.theme.spinner),spinner},NativeApmPendingView.prototype.createCustomerMessageImage=function(){var customerMessageImage=document.createElement("img");return ProcessOut.StylesUtils.styleElement(customerMessageImage,this.theme.actionImage),customerMessageImage.setAttribute("class","native-apm-action-image"),customerMessageImage.setAttribute("src",this.gatewayConfiguration.native_apm.gateway.customer_action_image_url),customerMessageImage},NativeApmPendingView}();ProcessOut.NativeApmPendingView=NativeApmPendingView}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmErrorView=function(){function NativeApmErrorView(errorData,theme){if(!errorData)throw new ProcessOut.Exception("default","Error data is not defined. You must provide valid error data");this.errorData=errorData,this.theme=theme,this.viewElement=this.createViewElement()}return NativeApmErrorView.prototype.getViewElement=function(){return this.viewElement},NativeApmErrorView.prototype.createViewElement=function(){var wrapper=this.createWrapper(),merchantImg=this.createMerchantImageElement(),customerMessage=this.createCustomerMessage();return merchantImg&&wrapper.appendChild(merchantImg),wrapper.appendChild(customerMessage),wrapper},NativeApmErrorView.prototype.createWrapper=function(){var wrapper=document.createElement("div");return wrapper.setAttribute("class","native-apm-view-wrapper"),ProcessOut.StylesUtils.styleElement(wrapper,this.theme.wrapper),wrapper},NativeApmErrorView.prototype.createMerchantImageElement=function(){var merchantImg;return this.errorData.gateway?((merchantImg=document.createElement("img")).setAttribute("class","native-apm-payment-provider-logo"),merchantImg.setAttribute("src",this.errorData.gateway.logo_url),ProcessOut.StylesUtils.styleElement(merchantImg,this.theme.logo),merchantImg):null},NativeApmErrorView.prototype.createCustomerMessage=function(){var customerMessage=document.createElement("p");return customerMessage.setAttribute("class","native-apm-message"),ProcessOut.StylesUtils.styleElement(customerMessage,this.theme.message),customerMessage.textContent=this.errorData.errorMessage||ProcessOut.TextUtils.getText("genericError"),customerMessage},NativeApmErrorView}();ProcessOut.NativeApmErrorView=NativeApmErrorView}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var NativeApmSuccessView=function(){function NativeApmSuccessView(gatewayConfiguration,markdownLibraryInstance,theme){if(!gatewayConfiguration)throw new ProcessOut.Exception("default","Gateway configuration is not defined. You must provide valid gateway configuration");this.markdownLibraryInstance=markdownLibraryInstance,this.gatewayConfiguration=gatewayConfiguration,this.theme=theme,this.viewElement=this.createViewElement()}return NativeApmSuccessView.prototype.getViewElement=function(){return this.viewElement},NativeApmSuccessView.prototype.createViewElement=function(){var wrapper=this.createWrapper(),merchantImg=this.createMerchantImageElement(),customerMessage=this.createCustomerMessage(),paymentSuccessStatus=this.createPaymentSuccessStatusImage();return wrapper.appendChild(merchantImg),wrapper.appendChild(customerMessage),wrapper.appendChild(paymentSuccessStatus),wrapper},NativeApmSuccessView.prototype.createWrapper=function(){var wrapper=document.createElement("div");return wrapper.setAttribute("class","native-apm-view-wrapper"),ProcessOut.StylesUtils.styleElement(wrapper,this.theme.wrapper),wrapper},NativeApmSuccessView.prototype.createMerchantImageElement=function(){var merchantImg=document.createElement("img");return merchantImg.setAttribute("class","native-apm-payment-provider-logo"),merchantImg.setAttribute("src",this.gatewayConfiguration.native_apm.gateway.logo_url),ProcessOut.StylesUtils.styleElement(merchantImg,this.theme.logo),merchantImg},NativeApmSuccessView.prototype.createCustomerMessage=function(){var customerMessage=document.createElement("p");return customerMessage.setAttribute("class","native-apm-message"),ProcessOut.StylesUtils.styleElement(customerMessage,this.theme.message),customerMessage.innerHTML=this.markdownLibraryInstance&&this.markdownLibraryInstance.makeHtml?this.markdownLibraryInstance.makeHtml(ProcessOut.TextUtils.getText("paymentSuccessMessage")):ProcessOut.TextUtils.getText("paymentSuccessMessage"),customerMessage},NativeApmSuccessView.prototype.createPaymentSuccessStatusImage=function(){var paymentSuccessStatusImage=document.createElement("img");return ProcessOut.StylesUtils.styleElement(paymentSuccessStatusImage,this.theme.actionImage),paymentSuccessStatusImage.setAttribute("class","native-apm-action-image"),paymentSuccessStatusImage.setAttribute("src","https://js.processout.com/images/native-apm-assets/payment_success_image.svg"),paymentSuccessStatusImage},NativeApmSuccessView}();ProcessOut.NativeApmSuccessView=NativeApmSuccessView}(ProcessOut=ProcessOut||{}),!function(ProcessOut){ProcessOut.mapInvoiceGatewayConfigurationProps=function mapInvoiceGatewayConfigurationProps(gatewayConf){var gatewayConfigurationId;return gatewayConf?(gatewayConfigurationId=gatewayConf&&gatewayConf.id?gatewayConf.id:gatewayConf,gatewayConf.gateway?{id:gatewayConfigurationId,gatewayName:(gatewayConf=gatewayConf.gateway).name,gatewayLogoUrl:gatewayConf.logo_url}:{id:gatewayConfigurationId}):null},ProcessOut.sanitizeInvoiceActionProps=function sanitizeInvoiceActionProps(props){return{invoiceId:props.invoiceId,gatewayConf:function sanitizeGatewayConfigurationProps(props){return props||{id:null}}(props.gatewayConf),customerTokenId:props.customerTokenId,additionalData:props.additionalData,tokenized:props.tokenized,tokenError:props.tokenError,iframeOverride:props.iframeOverride}}}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var DynamicCheckout=function(){function DynamicCheckout(processOutInstance,config){this.processOutInstance=processOutInstance,this.paymentConfig=new ProcessOut.DynamicCheckoutPaymentConfig(config)}return DynamicCheckout.prototype.mount=function(containerSelector){if(this.dcoContainer=document.querySelector(containerSelector),this.dcoContainer)return this.applyDynamicStyles(),this.getInvoiceDetails({onFetch:ProcessOut.DynamicCheckoutEventsUtils.dispatchWidgetLoadingEvent,onSuccess:this.onGetInvoiceSuccess.bind(this),onError:this.onGetInvoiceError.bind(this)});throw new Error("Element with this selector does not exist. You must provide a valid element selector")},DynamicCheckout.prototype.getInvoiceDetails=function(actions){actions.onFetch(),this.processOutInstance.apiRequest("GET","invoices/".concat(this.paymentConfig.invoiceId,"?expand=transaction"),{},actions.onSuccess.bind(this),actions.onError.bind(this),0,{isLegacy:!1,clientSecret:this.paymentConfig.clientSecret})},DynamicCheckout.prototype.onGetInvoiceSuccess=function(data){if(!data.success||"waiting"!==data.invoice.transaction.status)return this.loadErrorView(),ProcessOut.DynamicCheckoutEventsUtils.dispatchInvoiceFetchingErrorEvent(data);this.paymentConfig.setInvoiceDetails(data.invoice),this.loadDynamicCheckoutView()},DynamicCheckout.prototype.onGetInvoiceError=function(req,e,errorCode){var errorData=req.response;!req.response&&errorCode&&(errorData={success:!1,error_type:errorCode,message:ProcessOut.Translator.translateError(errorCode)}),this.loadErrorView(),ProcessOut.DynamicCheckoutEventsUtils.dispatchInvoiceFetchingErrorEvent(errorData)},DynamicCheckout.prototype.loadErrorView=function(){var errorView=document.createElement("div");errorView.setAttribute("class","dco-error-view"),errorView.innerText="Something went wrong. Please try again.",this.loadView(errorView)},DynamicCheckout.prototype.loadDynamicCheckoutView=function(){var paymentMethodsView=new ProcessOut.DynamicCheckoutPaymentMethodsView(this,this.processOutInstance,this.paymentConfig);this.loadView(paymentMethodsView.getViewElement()),paymentMethodsView.setupEventListeners(),ProcessOut.DynamicCheckoutEventsUtils.dispatchWidgetReadyEvent()},DynamicCheckout.prototype.loadView=function(view){this.widgetWrapper&&this.dcoContainer.removeChild(this.widgetWrapper),this.widgetWrapper=this.createWidgetWrapper(),this.widgetWrapper.appendChild(view),this.dcoContainer.appendChild(this.widgetWrapper)},DynamicCheckout.prototype.createWidgetWrapper=function(){var widgetWrapper=document.createElement("div");return widgetWrapper.setAttribute("class","dynamic-checkout-widget-wrapper"),widgetWrapper},DynamicCheckout.prototype.applyDynamicStyles=function(){var styleElement=document.createElement("style");styleElement.innerHTML=dynamicStyles,document.head.appendChild(styleElement)},DynamicCheckout}();ProcessOut.DynamicCheckout=DynamicCheckout}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var DynamicCheckoutPaymentConfig=function(){function DynamicCheckoutPaymentConfig(config){this.setInitialConfig(config)}return DynamicCheckoutPaymentConfig.prototype.getConfig=function(){return{invoiceId:this.invoiceId,projectId:this.projectId,invoiceDetails:this.invoiceDetails}},DynamicCheckoutPaymentConfig.prototype.setInvoiceDetails=function(invoiceDetails){this.invoiceDetails=invoiceDetails},DynamicCheckoutPaymentConfig.prototype.setInitialConfig=function(config){if(!this.isValidConfig(config))throw new Error("You must instantiate Dynamic Checkout with a valid config in order to use it");this.invoiceId=config.invoiceId,this.projectId=config.projectId,this.clientSecret=config.clientSecret},DynamicCheckoutPaymentConfig.prototype.isValidConfig=function(config){return!!config.projectId&&!!config.invoiceId},DynamicCheckoutPaymentConfig}();ProcessOut.DynamicCheckoutPaymentConfig=DynamicCheckoutPaymentConfig}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var DynamicCheckoutPaymentMethodsView=function(){function DynamicCheckoutPaymentMethodsView(dynamicCheckout,processOutInstance,paymentConfig){this.dynamicCheckout=dynamicCheckout,this.processOutInstance=processOutInstance,this.paymentConfig=paymentConfig,this.formElement=this.createFormElement(),this.cardFormView=new ProcessOut.DynamicCheckoutCardFormView(dynamicCheckout,processOutInstance,paymentConfig),this.nativeApmView=new ProcessOut.DynamicCheckoutNativeApmView(dynamicCheckout,processOutInstance,paymentConfig)}return DynamicCheckoutPaymentMethodsView.prototype.getViewElement=function(){return this.formElement},DynamicCheckoutPaymentMethodsView.prototype.setupEventListeners=function(){var _this=this;document.querySelectorAll(".dco-pay-button[data-method-id]").forEach(function(button){button.addEventListener("click",function(){var resetContainerHtml_1,redirectUrl=button.getAttribute("data-redirect-url"),dataMethodId=button.getAttribute("data-method-id"),savedCardTokenId=button.getAttribute("data-card-token-id");redirectUrl?window.location.href=redirectUrl:"card"===dataMethodId?_this.cardFormView.setupCardForm(_this.resetContainerHtml()):savedCardTokenId?(resetContainerHtml_1=_this.resetContainerHtml,_this.processOutInstance.makeCardPayment(_this.paymentConfig.invoiceId,savedCardTokenId,{authorize_only:!0},function(invoiceId){resetContainerHtml_1().innerHTML='\n                  <div class="dco-card-payment-success">\n                    <p class="dco-card-payment-success-text">Success! Payment authorized.</p>\n                    <img class="dco-card-payment-success-image" src="https://js.processout.com/images/native-apm-assets/payment_success_image.svg" />\n                  </div>\n                ',ProcessOut.DynamicCheckoutEventsUtils.dispatchPaymentSuccessEvent(invoiceId)},function(err){resetContainerHtml_1().innerHTML='\n                  <div class="dco-card-payment-error-text">\n                    Something went wrong. Please try again.\n                  </div>\n                ',ProcessOut.DynamicCheckoutEventsUtils.dispatchPaymentErrorEvent(err)})):_this.nativeApmView.setupNativeApmWidget(_this.resetContainerHtml(),dataMethodId)})})},DynamicCheckoutPaymentMethodsView.prototype.resetContainerHtml=function(){var container=document.querySelector(".dco-wrapper");return container&&(container.innerHTML=""),container},DynamicCheckoutPaymentMethodsView.prototype.generateFormHtml=function(){var _a=this.getPaymentMethodsHtml(),expressCheckoutHtml=_a.expressCheckoutHtml,_a=_a.directCheckoutHtml,expressCheckoutHtml=expressCheckoutHtml?'\n        <div class="dco-express-checkout">\n          <div class="dco-express-checkout-title">Express checkout</div>\n          '.concat(expressCheckoutHtml,"\n        </div>\n      "):"",_a=_a?'\n          <div class="dco-direct-checkout">\n            '.concat(_a,"\n          </div>\n        "):"";return'\n            <div class="dco-wrapper">\n              '.concat(expressCheckoutHtml,"\n              ").concat(_a,"\n            </div>\n          ")},DynamicCheckoutPaymentMethodsView.prototype.createFormElement=function(){var container=document.createElement("div");return container.innerHTML=this.generateFormHtml().trim(),container},DynamicCheckoutPaymentMethodsView.prototype.getPaymentMethodsHtml=function(){var _this=this,expressCheckoutHtml="",directCheckoutHtml="";return this.paymentConfig.invoiceDetails.payment_methods.forEach(function(_a){var flow=_a.flow,type=_a.type,apm=_a.apm,display=_a.display,apm_customer_token=_a.apm_customer_token,_a=_a.card_customer_token;"express"===flow?(flow=apm,"apm_customer_token"===type?flow=apm_customer_token:"card_customer_token"===type&&(flow=_a),expressCheckoutHtml+=_this.getExpressCheckoutHtml(type,flow,display)):"apm"===type?directCheckoutHtml+=_this.getApmPaymentMethodButtonHtml(display,apm):"card"===type?directCheckoutHtml+=_this.getCardPaymentMethodButtonHtml(display):"card_customer_token"===type&&(expressCheckoutHtml+=_this.getExpressCheckoutHtml(type,_a,display))}),{expressCheckoutHtml:expressCheckoutHtml,directCheckoutHtml:directCheckoutHtml}},DynamicCheckoutPaymentMethodsView.prototype.getExpressCheckoutHtml=function(type,apm,display){switch(type){case"googlepay":return"";case"apm_customer_token":return this.getApmPaymentMethodButtonHtml(display,apm);case"card_customer_token":return this.getSavedCardPaymentMethodButtonHtml(display,apm);default:return""}},DynamicCheckoutPaymentMethodsView.prototype.getSavedCardPaymentMethodButtonHtml=function(display,apm){return'\n        <div class="dco-pay-button" data-method-id="saved-card" data-card-token-id="'.concat(apm.customer_token_id||"",'">\n            <div class="dco-payment-method dco-payment-method--regular" style="background-color: ').concat(ProcessOut.DynamicCheckoutColorsUtils.hexToRgba(display.brand_color.dark),'">\n                <img src="').concat(display.logo.dark_url.vector,'" class="dco-payment-method-logo"/>\n                <span class="dco-payment-method-label">').concat(display.name,"</span>\n                ").concat(apm.redirect_url?'<span class="dco-payment-method-apm-message">You will be redirected to finalise this payment</span>':"","\n            </div>\n        </div>")},DynamicCheckoutPaymentMethodsView.prototype.getApmPaymentMethodButtonHtml=function(display,apm){return'\n        <div class="dco-pay-button" data-method-id="'.concat(apm.gateway_configuration_id,'" data-redirect-url="').concat(apm.redirect_url||"",'">\n            <div class="dco-payment-method dco-payment-method--regular" style="background-color: ').concat(ProcessOut.DynamicCheckoutColorsUtils.hexToRgba(display.brand_color.dark),'">\n                <img src="').concat(display.logo.dark_url.vector,'" class="dco-payment-method-logo"/>\n                <span class="dco-payment-method-label">').concat(display.name,"</span>\n                ").concat(apm.redirect_url?'<span class="dco-payment-method-apm-message">You will be redirected to finalise this payment</span>':"","\n            </div>\n        </div>")},DynamicCheckoutPaymentMethodsView.prototype.getCardPaymentMethodButtonHtml=function(display){return'\n        <div class="dco-pay-button" data-method-id="card">\n            <div class="dco-payment-method dco-payment-method--regular" style="background-color: '.concat(ProcessOut.DynamicCheckoutColorsUtils.hexToRgba(display.brand_color.dark),'">\n                <img src="').concat(display.logo.dark_url.vector,'" class="dco-payment-method-logo"/>\n                <span class="dco-payment-method-label">').concat(display.name,"</span>\n            </div>\n        </div>")},DynamicCheckoutPaymentMethodsView}();ProcessOut.DynamicCheckoutPaymentMethodsView=DynamicCheckoutPaymentMethodsView}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var DynamicCheckoutCardFormView=function(){function DynamicCheckoutCardFormView(dynamicCheckout,processOutInstance,paymentConfig){this.unitsHtmlMap={street:'\n       <div class="dco-card-payment-input-row">\n          <div class="dco-card-payment-input-group">\n            <div class="dco-card-payment-input-label">Address line 1</div>\n            <input class="dco-card-form-input" id="dco-card-form-address1" placeholder="Address line 1"></input>\n          </div>\n        </div>\n        <div class="dco-card-payment-input-row">\n          <div class="dco-card-payment-input-group">\n            <div class="dco-card-payment-input-label">Address line 2</div>\n            <input class="dco-card-form-input" placeholder="Address line 2" id="dco-card-form-address2"></input>\n          </div>\n        </div>',city:'\n          <div class="dco-card-payment-input-row">\n          <div class="dco-card-payment-input-group">\n            <div class="dco-card-payment-input-label">City</div>\n            <input class="dco-card-form-input" placeholder="City" id="dco-card-form-city"></input>\n          </div>\n        </div>\n        ',postcode:'\n         <div class="dco-card-payment-input-row">\n          <div class="dco-card-payment-input-group">\n            <div class="dco-card-payment-input-label">Postal code</div>\n            <input class="dco-card-form-input" placeholder="Postal code" id="dco-card-form-postalcode"></input>\n          </div>\n        </div>',state:'\n        <div class="dco-card-payment-input-row">\n          <div class="dco-card-payment-input-group">\n            <div class="dco-card-payment-input-label">State</div>\n            <input class="dco-card-form-input" placeholder="State" id="dco-card-form-state"></input>\n          </div>\n        </div>',stateSelect:function(states){return'\n          <div class="dco-card-payment-input-row">\n            <div class="dco-card-payment-input-group">\n              <div class="dco-card-payment-input-label">State</div>\n              <select class="dco-card-form-input" name="state-select" id="dco-card-form-state">\n                '.concat(states.map(function(state){return'<option value="'.concat(state.abbreviation,'">').concat(state.name,"</option>")}).join(""),"\n              </select>\n            </div>\n          </div>\n        ")}},this.dynamicCheckout=dynamicCheckout,this.processOutInstance=processOutInstance,this.paymentConfig=paymentConfig}return DynamicCheckoutCardFormView.prototype.setupCardFormOptions=function(){var cardPaymentMethod=this.getCardPaymentMethod(),options=new ProcessOut.CardFieldOptions("");return options.style={fontSize:"14px","::placeholder":{color:"#ECEFF1"}},options.placeholder="",options.expiryAutoNext=!1,options.cardNumberAutoNext=!0,options.requireCVC=cardPaymentMethod&&cardPaymentMethod.card.require_cvc,options},DynamicCheckoutCardFormView.prototype.setupCardForm=function(container){container.innerHTML=this.getCardPaymentHtml(),this.setupCardFormEventListeners(container);var cardOptions=this.setupCardFormOptions(),procesoutInstance=this.processOutInstance,paymentConfig=this.paymentConfig,getBillingAddress=this.getBillingAddressValues.bind(this),getCardSuccessHtml=this.getCardAuthorizeSuccessHtml.bind(this),showFormErrorMessages=this.showFormErrorMessages.bind(this),hideFormErrorMessages=this.hideFormErrorMessages.bind(this),setButtonLoadingState=this.setButtonLoadingState.bind(this);procesoutInstance.setupForm(container,cardOptions,function(form){form.addEventListener("submit",function(e){e.preventDefault();var nameValid=!0,nameElement=document.getElementById("dco-card-form-name");nameElement&&0===nameElement.value.length&&(nameValid=!1,showFormErrorMessages("card.missing-name")),form.validate(function(){nameValid&&(hideFormErrorMessages(),setButtonLoadingState(!0),procesoutInstance.tokenize(form,{name:nameElement?nameElement.value:"",contact:getBillingAddress()},function(token){ProcessOut.DynamicCheckoutEventsUtils.dispatchTokenizePaymentSuccessEvent(token);var reqOptions={authorize_only:!0},saveCardCheckbox=document.querySelector("#save-card-checkbox");saveCardCheckbox&&(reqOptions.save_source=saveCardCheckbox.checked),procesoutInstance.makeCardPayment(paymentConfig.invoiceId,token,reqOptions,function(invoiceId){setButtonLoadingState(!1),container.innerHTML=getCardSuccessHtml(),ProcessOut.DynamicCheckoutEventsUtils.dispatchPaymentSuccessEvent({invoiceId:invoiceId,returnUrl:paymentConfig.invoiceDetails.return_url})},function(err){setButtonLoadingState(!1),container.innerHTML='\n                          <div class="dco-card-payment-error-text">\n                            Something went wrong. Please try again.\n                          </div>\n                        ',ProcessOut.DynamicCheckoutEventsUtils.dispatchPaymentErrorEvent(err)},{clientSecret:paymentConfig.clientSecret})},function(err){setButtonLoadingState(!1),ProcessOut.DynamicCheckoutEventsUtils.dispatchTokenizePaymentErrorEvent({message:"Tokenize payment error: ".concat(JSON.stringify(err,undefined,2))})}))},function(err){setButtonLoadingState(!1),showFormErrorMessages(err.code)})})},function(err){console.log({err:err})})},DynamicCheckoutCardFormView.prototype.setButtonLoadingState=function(loading){var payButton=document.querySelector(".dco-cta-pay");payButton.innerHTML=loading?this.getCardPaymentSpinnerHtml():this.getPayButtonText()},DynamicCheckoutCardFormView.prototype.showFormErrorMessages=function(errorCode){switch(errorCode){case"card.invalid-number":var cardNumberErrorMessage=document.querySelector(".dco-card-form-error-message-number");cardNumberErrorMessage&&(cardNumberErrorMessage.textContent="Invalid card number");break;case"card.invalid-month":cardNumberErrorMessage=document.querySelector(".dco-card-form-error-message-expiry");cardNumberErrorMessage&&(cardNumberErrorMessage.textContent="Invalid expiry date");break;case"card.missing-cvc":cardNumberErrorMessage=document.querySelector(".dco-card-form-error-message-cvc");cardNumberErrorMessage&&(cardNumberErrorMessage.textContent="Invalid CVC");break;case"card.missing-name":cardNumberErrorMessage=document.querySelector(".dco-card-form-error-message-name");cardNumberErrorMessage&&(cardNumberErrorMessage.textContent="Invalid cardholder name")}},DynamicCheckoutCardFormView.prototype.hideFormErrorMessages=function(){var cardNumberErrorMessage=document.querySelector(".dco-card-form-error-message-number"),cardNumberErrorMessage=(cardNumberErrorMessage&&(cardNumberErrorMessage.textContent=""),document.querySelector(".dco-card-form-error-message-expiry")),cardNumberErrorMessage=(cardNumberErrorMessage&&(cardNumberErrorMessage.textContent=""),document.querySelector(".dco-card-form-error-message-cvc")),cardNumberErrorMessage=(cardNumberErrorMessage&&(cardNumberErrorMessage.textContent=""),document.querySelector(".dco-card-form-error-message-name"));cardNumberErrorMessage&&(cardNumberErrorMessage.textContent="")},DynamicCheckoutCardFormView.prototype.setupCardFormEventListeners=function(container){var _this=this,selectInput=document.getElementById("dco-countries-input"),backButton=document.querySelector(".dco-cta-back"),nameInput=document.getElementById("dco-card-form-name"),hideFormErrorMessages=this.hideFormErrorMessages.bind(this),processOutInstance=this.processOutInstance;window.addEventListener("message",function(e){e.origin===processOutInstance.endpoint("js","")&&"inputEvent"===(e.data?JSON.parse(e.data):{}).action&&hideFormErrorMessages()}),nameInput&&nameInput.addEventListener("input",function(){hideFormErrorMessages()}),backButton&&backButton.addEventListener("click",function(){_this.dynamicCheckout.loadDynamicCheckoutView()}),selectInput&&selectInput.addEventListener("change",function(e){e=e.target.value;container.querySelector("#dco-billing-address-dynamic-fields").innerHTML=_this.getDynamicBillingAddressFieldsHtml(e)})},DynamicCheckoutCardFormView.prototype.getBillingAddressValues=function(){var billingAddressValues={},streetElement1=document.getElementById("dco-card-form-address1"),streetElement2=document.getElementById("dco-card-form-address1"),cityElement=document.getElementById("dco-card-form-city"),countryElement=document.getElementById("dco-countries-input"),stateElement=document.getElementById("dco-card-form-state"),postalCodeElement=document.getElementById("dco-card-form-postalcode");return streetElement1&&streetElement1.value.length&&(billingAddressValues.address1=streetElement1.value),streetElement2&&streetElement2.value.length&&(billingAddressValues.address2=streetElement2.value),cityElement&&cityElement.value.length&&(billingAddressValues.city=cityElement.value),countryElement&&countryElement.value.length&&(billingAddressValues.country_code=countryElement.value),stateElement&&stateElement.value.length&&(billingAddressValues.state=stateElement.value),postalCodeElement&&postalCodeElement.value.length&&(billingAddressValues.zip=postalCodeElement.value),billingAddressValues},DynamicCheckoutCardFormView.prototype.getCountryOptions=function(){var cardPaymentMethod=this.getCardPaymentMethod(),restrictToCountries=cardPaymentMethod?cardPaymentMethod.card.billing_address.restrict_to_country_codes:[],countryOptions="<option class='dco-select-country-option' disabled selected value=''>Select country</option>",cardPaymentMethod=Object.keys(billingAddressConfig).map(function(countryCode){return{value:countryCode,label:billingAddressConfig[countryCode].name}}),filteredCountries=[];return restrictToCountries&&cardPaymentMethod.forEach(function(country){restrictToCountries.forEach(function(restrictedCountry){restrictedCountry===country.value&&filteredCountries.push(country)})}),(0<filteredCountries.length?filteredCountries:cardPaymentMethod).forEach(function(country){countryOptions+='<option class="dco-select-country-option" value="'.concat(country.value,'">').concat(country.label,"</option>")}),countryOptions},DynamicCheckoutCardFormView.prototype.getDynamicBillingAddressFieldsHtml=function(country){var _this=this,dynamicBillingAddressFieldsHtml="",cardPaymentMethod=this.getCardPaymentMethod();return!cardPaymentMethod||"automatic"!==cardPaymentMethod.card.billing_address.collection_mode||"US"!==country&&"CA"!==country&&"GB"!==country?(cardPaymentMethod&&"automatic"!==cardPaymentMethod.card.billing_address.collection_mode&&billingAddressConfig[country]&&billingAddressConfig[country].units.forEach(function(unit){"state"===unit&&billingAddressConfig[country].states?dynamicBillingAddressFieldsHtml+=_this.unitsHtmlMap.stateSelect(billingAddressConfig[country].states):dynamicBillingAddressFieldsHtml+=_this.unitsHtmlMap[unit]}),dynamicBillingAddressFieldsHtml):'\n         <div class="dco-card-payment-input-row">\n          <div class="dco-card-payment-input-group">\n            <div class="dco-card-payment-input-label">Postal code</div>\n            <input class="dco-card-form-input" placeholder="Postal code" id="dco-card-form-postalcode></input>\n          </div>\n        </div>'},DynamicCheckoutCardFormView.prototype.getCardBillingAddressHtml=function(){var cardPaymentMethod=this.getCardPaymentMethod(),countriesHtml=this.getCountryOptions();return cardPaymentMethod&&"never"===cardPaymentMethod.card.billing_address.collection_mode?"":cardPaymentMethod&&"automatic"===cardPaymentMethod.card.billing_address.collection_mode?'\n        <div class="dco-billing-address-section">\n          <span class="dco-card-form-section-header">Billing address</span>\n          <div class="dco-card-payment-input-row">\n            <div class="dco-card-payment-input-group">\n              <div class="dco-card-payment-input-label">Country</div>\n              <select id="dco-countries-input" class="dco-card-form-input" placeholder="Country" name="country">\n                '.concat(countriesHtml,'\n              </select>\n            </div>\n          </div>\n          <div id="dco-billing-address-dynamic-fields"></div>\n          </div>\n        '):'\n        <div class="dco-billing-address-section">\n        <span class="dco-card-form-section-header">Billing address</span>\n        <div class="dco-card-payment-input-row">\n          <div class="dco-card-payment-input-group">\n            <div class="dco-card-payment-input-label">Country</div>\n            <select id="dco-countries-input" class="dco-card-form-input" placeholder="Poland" name="country">\n              '.concat(countriesHtml,'\n            </select>\n          </div>\n        </div>\n        <div id="dco-billing-address-dynamic-fields"></div>\n        </div>\n      ')},DynamicCheckoutCardFormView.prototype.getCardPaymentSpinnerHtml=function(){return'\n        <div class="dco-card-pay-spinner"></div>\n      '},DynamicCheckoutCardFormView.prototype.getPayButtonText=function(){var amount=this.paymentConfig.invoiceDetails.amount,currency=this.paymentConfig.invoiceDetails.currency;return"Pay ".concat(amount," ").concat(currency)},DynamicCheckoutCardFormView.prototype.getCardPaymentHtml=function(){var cardPaymentMethod=this.getCardPaymentMethod(),cvcField=cardPaymentMethod&&cardPaymentMethod.card.require_cvc?'\n            <div class="dco-card-payment-input-group">\n              <div class="dco-card-payment-input-label">CVC</div>\n              <div class="dco-card-form-input" data-processout-input="cc-cvc" data-processout-placeholder="CVC"></div>\n              <span class="dco-card-form-error-message dco-card-form-error-message-cvc"></span>\n            </div>\n          ':"",cardHolderNameField=cardPaymentMethod&&cardPaymentMethod.card.require_cardholder_name?'\n            <div class="dco-card-payment-input-group">\n              <div class="dco-card-payment-input-label">Cardholder Name</div>\n              <input class="dco-card-form-input" type="text" id="dco-card-form-name" placeholder="Cardholder name"/>\n              <span class="dco-card-form-error-message dco-card-form-error-message-name"></span>\n            </div>\n          ':"",cardBillingAddress=this.getCardBillingAddressHtml(),cardPaymentMethod=cardPaymentMethod.card.saving_allowed?'\n        <div class="dco-save-card-checkbox-wrapper">\n          <input type="checkbox" id="save-card-checkbox" name="saveCard" class="dco-save-card-checkbox-input">\n          <label for="save-card-checkbox" class="dco-save-card-checkbox-label">Save card for future use</label>\n        </div>\n      ':"";return'\n          <span class="dco-card-form-section-header">Payment details</span>\n          <form action="" method="POST" id="card-form">\n            <div class="dco-card-payment">\n                <div class="dco-card-payment-input-group">\n                    <div class="dco-card-payment-input-label">Card Number</div>\n                    <div class="dco-card-form-input" data-processout-input="cc-number" data-processout-placeholder="0000 0000 0000 0000"></div>\n                    <span class="dco-card-form-error-message dco-card-form-error-message-number"></span> \n                </div>\n                <div class="dco-card-payment-input-row">\n                    <div class="dco-card-payment-input-group">\n                      <div class="dco-card-payment-input-label">Expiry Date</div>\n                      <div class="dco-card-form-input" data-processout-input="cc-exp" data-processout-placeholder="MM/YY"></div>\n                      <span class="dco-card-form-error-message dco-card-form-error-message-expiry"></span>\n                    </div>\n                    '.concat(cvcField,"\n                </div>\n                ").concat(cardHolderNameField,"\n                ").concat(cardBillingAddress,"\n            </div>\n            ").concat(cardPaymentMethod,'\n            <div class="dco-card-form-buttons">\n              <button type="submit" class="dco-cta-pay">').concat(this.getPayButtonText(),'</button>\n              <button type="button" class="dco-cta-back">Back</button>\n            </div>\n          </form>\n          ')},DynamicCheckoutCardFormView.prototype.getCardAuthorizeSuccessHtml=function(){return'\n        <div class="dco-card-payment-success">\n          <p class="dco-card-payment-success-text">Success! Payment authorized.</p>\n          <img class="dco-card-payment-success-image" src="https://js.processout.com/images/native-apm-assets/payment_success_image.svg" />\n        </div>\n      '},DynamicCheckoutCardFormView.prototype.getCardPaymentMethod=function(){var cardPaymentMethod;return this.paymentConfig.invoiceDetails.payment_methods.forEach(function(paymentMethod){"card"===paymentMethod.type&&(cardPaymentMethod=paymentMethod)}),cardPaymentMethod},DynamicCheckoutCardFormView}();ProcessOut.DynamicCheckoutCardFormView=DynamicCheckoutCardFormView}(ProcessOut=ProcessOut||{}),!function(ProcessOut){var DynamicCheckoutNativeApmView=function(){function DynamicCheckoutNativeApmView(dynamicCheckout,processOutInstance,paymentConfig){this.dynamicCheckout=dynamicCheckout,this.processOutInstance=processOutInstance,this.paymentConfig=paymentConfig}return DynamicCheckoutNativeApmView.prototype.setupNativeApmWidget=function(container,gatewayConfigurationId){var _this=this;this.processOutInstance.setupNativeApm({gatewayConfigurationId:gatewayConfigurationId,invoiceId:this.paymentConfig.invoiceId},{dynamicCheckout:{onBackButtonClick:function(){return _this.dynamicCheckout.loadDynamicCheckoutView()}}}).mount(".".concat(container.className))},DynamicCheckoutNativeApmView}();ProcessOut.DynamicCheckoutNativeApmView=DynamicCheckoutNativeApmView}(ProcessOut=ProcessOut||{}),"\n\n  @keyframes rotation {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n\n  .dco-wrapper * {\n    box-sizing: border-box;\n  }\n\n  .dco-wrapper {\n    background-color: white;\n    min-width: 320px;\n    padding: 20px;\n    margin: 0 auto;\n    width: 100%;\n  }\n\n  .dco-express-checkout {\n    position: relative;\n    border: 1px solid #dde0e3;\n    gap: 12px;\n    display: flex;\n    flex-direction: column;\n    padding: 20px 10px 10px;\n    position: relative;\n    margin-bottom: 20px;\n    border-radius: 4px;\n  }\n\n  .dco-express-checkout-title {\n    position: absolute;\n    font-size: 14px;\n    top: 0;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background-color: white;\n    padding: 0 10px;\n  }\n\n\n  .dco-direct-checkout {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n  }\n\n  .dco-payment-method {\n    position: relative;\n    text-align: center;\n    background-color: rgba(255, 255, 255, 1);\n    border-radius: 4px;\n    border: 1px solid #dde0e3;\n    display: flex;\n    justify-content: center;\n    padding: 10px;\n    cursor: pointer;\n    flex-wrap: wrap;\n    transition: all .3s;\n  }\n\n  .dco-payment-method--regular {\n    justify-content: flex-start;\n    align-items: center;\n    color: rgba(91, 101, 118, 1);\n  }\n\n  .dco-payment-method-apm-message {\n    width: 100%;\n    text-align: left;\n    font-size: 12px;\n    margin-top: 5px;\n  }\n\n  .dco-payment-method-logo {\n    height: 30px;\n    width: 30px;\n    margin-right: 10px;\n  }\n\n  .dco-payment-method-label {\n    font-size: 14px;\n  }\n\n  .dco-payment-method:hover {\n    border: 1px solid #7d7f81;\n  }\n\n  .dco-card-form-buttons {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  .dco-pay-button {\n  position: relative;\n    min-height: 40px;\n    border-radius: 4px;\n  }\n\n\n  .dco-billing-address-section {\n    margin-top: 20px;\n  }\n\n  .dco-card-form-section-header {\n    font-size: 14px;\n    font-weight: bold;\n    margin-bottom: 15px;\n    display: block;\n  }\n\n  .dco-card-payment-input-group {\n    width: 100%;\n    margin-bottom: 16px;\n  }\n\n  .dco-card-payment-input-row {\n    display: flex;\n    gap: 10px;\n    justify-content: space-between;\n  }\n\n  .dco-save-card-checkbox-wrapper {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n  }\n\n  .dco-save-card-checkbox-input { \n    width:18px;\n    height: 18px;\n    background:white;\n    border-radius:5px;\n    border:2px solid #dde0e3;\n  }\n\n  .dco-card-payment-input-label {\n    margin-bottom: 8px;\n    font-size: 14px;\n  }\n\n  .dco-save-card-checkbox-label {\n    font-size: 14px;\n    margin: 0;\n  }\n\n  .dco-cta-pay {\n    position: relative;\n    border-radius: 4px;\n    background-color: #242C38;\n    color: white;\n    width: 100%;\n    height: 40px;\n    font-size: 14px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin-top: 32px;\n    cursor: pointer;\n  }\n\n  .dco-cta-back, .native-apm-back-button {\n    border-radius: 4px;\n    width: 100%;\n    height: 40px;\n    font-size: 14px;\n    margin-top: 16px;\n    background-color: transparent;\n    color: #242C38;\n    border: 1px solid #242C38;\n    cursor: pointer;\n  }\n\n  .native-apm-back-button {\n    margin-top: 0;\n  }\n\n  .dco-card-form-input,\n  .native-apm-select-input, .native-apm-text-input {\n    height: 40px !important;\n    border-radius: 4px !important;\n    border: 1px solid #CCD1D6 !important;\n    box-shadow: none;\n    padding: 8px !important;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    font-size: 14px !important; \n  }\n\n  :-moz-placeholder,\n  ::-moz-placeholder,\n  ::-webkit-input-placeholder,\n  :-ms-input-placeholder {\n    color: #eceff1;\n    opacity: 1;\n  }\n\n  .dco-card-form-input::placeholder {\n    color: #eceff1;\n    opacity: 1;\n  }\n\n  .native-apm-spinner {\n    width: 40px !important;\n    height: 40px !important; \n    border-bottom-color: #242C38 !important;\n  }\n\n  .native-apm-message {\n    text-align: center;\n    font-size: 14px !important;\n  }\n\n  .native-apm-button {\n    width: 100% !important;\n    height: 40px !important;\n    font-size: 14px !important;\n    background-color: #242C38 !important;\n    color: white !important;\n  }\n\n  .dco-card-pay-spinner {\n    width: 1rem;\n    height: 1rem; \n    border: 3px solid #546073;\n    border-bottom-color: white;\n    border-radius: 50%;\n    animation: rotation 1s linear infinite;\n  }\n  .native-apm-input-error {\n    font-size: 14px !important;\n  }\n\n  .native-apm-input-label, .native-apm-input-label {\n    font-size: 14px !important; \n  }\n\n  .native-apm-numeric-input {\n    display: flex !important;;\n    justify-content: space-between !important;;\n  }\n\n  .native-apm-numeric-input-character {\n    height: 40px !important;\n    width: 100% !important;\n    font-size: 14px !important;\n    padding: 0 !important;\n    border-radius: 4px !important;\n    border: 1px solid #CCD1D6 !important;\n  }\n\n  .native-apm-payment-provider-logo {\n    width: 50% !important;\n  }\n\n  #button-loading-spinner {\n    width: 18px !important;\n    height: 18px !important;\n  }\n\n  .dco-card-payment-success {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .dco-card-payment-success-image {\n    display: block;\n    width: 50%;\n    margin-top: 1.3rem;\n  }\n\n  .dco-card-payment-success-text {\n    display: block;\n    text-align: center;\n    font-size: 14px;\n  }\n\n  .dco-card-payment-error-text {\n    text-align: center;\n    font-size: 14px !important;\n  }\n\n  .dco-card-form-error-message {\n    font-size: 12px;\n    color: red;\n    margin-top: 3px;\n  }\n\n  .dco-error-view {\n    text-align: center;\n    font-size: 14px;\n  }\n\n  .dco-save-card-checkbox-wrapper {\n\n  }\n"),billingAddressConfig={AC:{name:"Ascension Island",units:["street","city","postcode"]},AD:{name:"Andorra",units:["street","postcode","city"]},AE:{name:"United Arab Emirates",stateUnit:"emirate",units:["street","state"]},AF:{name:"Afghanistan",units:["street","city","postcode"]},AG:{name:"Antigua and Barbuda"},AI:{name:"Anguilla",units:["street","city","postcode"]},AL:{name:"Albania",units:["street","postcode","city"]},AM:{name:"Armenia",units:["street","postcode","city","state"]},AO:{name:"Angola",units:["street","city"]},AR:{name:"Argentina",units:["street","postcode","city","state"]},AT:{name:"Austria",units:["street","postcode","city"]},AU:{name:"Australia",cityUnit:"suburb",stateUnit:"state"},AW:{name:"Aruba",units:["street","city"]},AX:{name:"Åland Islands",units:["postcode","city","street"]},AZ:{name:"Azerbaijan",units:["street","postcode","city"]},BA:{name:"Bosnia and Herzegovina",units:["street","postcode","city"]},BB:{name:"Barbados",stateUnit:"parish"},BD:{name:"Bangladesh",units:["street","city","postcode"]},BE:{name:"Belgium",units:["street","postcode","city"]},BF:{name:"Burkina Faso",units:["street","city"]},BG:{name:"Bulgaria",units:["street","postcode","city"]},BH:{name:"Bahrain",units:["street","city","postcode"]},BI:{name:"Burundi",units:["street","city"]},BJ:{name:"Benin",units:["street","city"]},BL:{name:"Saint Barthélemy",units:["street","postcode","city"]},BM:{name:"Bermuda",units:["street","city","postcode"]},BN:{name:"Brunei",units:["street","city","postcode"]},BO:{name:"Bolivia",units:["street","city"]},BQ:{name:"Bonaire",units:["street","city"]},BR:{name:"Brazil",stateUnit:"state"},BS:{name:"Bahamas",stateUnit:"island",units:["street","city","state"]},BT:{name:"Bhutan",units:["street","city","postcode"]},BV:{name:"Bouvet Island",units:["street","city"]},BW:{name:"Botswana",units:["street","city"]},BY:{name:"Belarus",units:["state","postcode","city","street"]},BZ:{name:"Belize",units:["street","city"]},CA:{name:"Canada",units:["state"],states:[{abbreviation:"AB",name:"Alberta"},{abbreviation:"BC",name:"British Columbia"},{abbreviation:"MB",name:"Manitoba"},{abbreviation:"NB",name:"New Brunswick"},{abbreviation:"NL",name:"Newfoundland and Labrador"},{abbreviation:"NT",name:"Northwest Territories"},{abbreviation:"NS",name:"Nova Scotia"},{abbreviation:"NU",name:"Nunavut"},{abbreviation:"ON",name:"Ontario"},{abbreviation:"PE",name:"Prince Edward Island"},{abbreviation:"QC",name:"Quebec"},{abbreviation:"SK",name:"Saskatchewan"},{abbreviation:"YT",name:"Yukon"}]},CD:{name:"Democratic Republic of the Congo",units:["street","city"]},CF:{name:"Central African Republic",units:["street","city"]},CG:{name:"Republic of the Congo",units:["street","city"]},CH:{name:"Switzerland",units:["street","postcode","city"]},CI:{name:"Ivory Coast",units:["street","city"]},CK:{name:"Cook Islands",units:["street","city"]},CL:{name:"Chile",units:["street","postcode","city","state"]},CM:{name:"Cameroon",units:["street","city"]},CN:{name:"China",units:["postcode","state","city","street"]},CO:{name:"Colombia",stateUnit:"department"},CR:{name:"Costa Rica",units:["street","state","city","postcode"]},CV:{name:"Cape Verde",stateUnit:"island",units:["street","postcode","city","state"]},CW:{name:"Curaçao",units:["street","city"]},CY:{name:"Cyprus",units:["street","postcode","city"]},CZ:{name:"Czech Republic",units:["street","postcode","city"]},DE:{name:"Germany",units:["street","postcode","city"]},DJ:{name:"Djibouti",units:["street","city"]},DK:{name:"Denmark",units:["street","postcode","city"]},DM:{name:"Dominica",units:["street","city"]},DO:{name:"Dominican Republic",units:["street","postcode","city"]},DZ:{name:"Algeria",units:["street","postcode","city"]},EC:{name:"Ecuador",units:["street","postcode","city"]},EE:{name:"Estonia",units:["street","postcode","city"]},EG:{name:"Egypt"},EH:{name:"Western Sahara",units:["street","postcode","city"]},ER:{name:"Eritrea",units:["street","city"]},ES:{name:"Spain",units:["street","postcode","city","state"]},ET:{name:"Ethiopia",units:["street","postcode","city"]},FI:{name:"Finland",units:["street","postcode","city"]},FJ:{name:"Fiji",units:["street","city"]},FK:{name:"Falkland Islands",units:["street","city","postcode"]},FO:{name:"Faroe Islands",units:["street","postcode","city"]},FR:{name:"France",units:["street","postcode","city"]},GA:{name:"Gabon",units:["street","city"]},GB:{name:"United Kingdom",cityUnit:"postTown",units:["street","city","postcode"]},GD:{name:"Grenada",units:["street","city"]},GE:{name:"Georgia",units:["street","postcode","city"]},GF:{name:"French Guiana",units:["street","postcode","city"]},GG:{name:"Guernsey"},GH:{name:"Ghana",units:["street","city"]},GI:{name:"Gibraltar",units:["street","postcode"]},GL:{name:"Greenland",units:["street","postcode","city"]},GM:{name:"Gambia",units:["street","city"]},GN:{name:"Guinea",units:["postcode","street","city"]},GP:{name:"Guadeloupe",units:["street","postcode","city"]},GQ:{name:"Equatorial Guinea",units:["street","city"]},GR:{name:"Greece",units:["street","postcode","city"]},GS:{name:"South Georgia and the South Sandwich Islands",units:["street","city","postcode"]},GT:{name:"Guatemala",units:["street","postcode","city"]},GU:{name:"Guam",postcodeUnit:"zip",units:["street","city","postcode"]},GW:{name:"Guinea-Bissau",units:["street","postcode","city"]},GY:{name:"Guyana",units:["street","city"]},HK:{name:"Hong Kong",cityUnit:"district",stateUnit:"area",units:["state","city","street"]},HN:{name:"Honduras",stateUnit:"department"},HR:{name:"Croatia",units:["street","postcode","city"]},HT:{name:"Haiti",units:["street","postcode","city"]},HU:{name:"Hungary",units:["city","street","postcode"]},ID:{name:"Indonesia"},IE:{name:"Ireland",postcodeUnit:"eircode",stateUnit:"county"},IL:{name:"Israel",units:["street","city","postcode"]},IM:{name:"Isle of Man",units:["street","city","postcode"]},IN:{name:"India",postcodeUnit:"pin",stateUnit:"state",units:["street","city","postcode","state"]},IO:{name:"British Indian Ocean Territory",units:["street","city","postcode"]},IQ:{name:"Iraq"},IS:{name:"Iceland",units:["street","postcode","city"]},IT:{name:"Italy",units:["street","postcode","city","state"]},JE:{name:"Jersey"},JM:{name:"Jamaica",stateUnit:"parish",units:["street","city","state"]},JO:{name:"Jordan",units:["street","city","postcode"]},JP:{name:"Japan",stateUnit:"prefecture",units:["postcode","state","street"]},KE:{name:"Kenya",units:["street","city","postcode"]},KG:{name:"Kyrgyzstan",units:["street","postcode","city"]},KH:{name:"Cambodia",units:["street","city","postcode"]},KI:{name:"Kiribati",stateUnit:"island",units:["street","state","city"]},KM:{name:"Comoros",units:["street","city"]},KN:{name:"Saint Kitts and Nevis",stateUnit:"island",units:["street","city","state"]},KR:{name:"South Korea",stateUnit:"doSi",units:["state","city","street","postcode"]},KW:{name:"Kuwait",units:["street","postcode","city"]},KY:{name:"Cayman Islands",stateUnit:"island",units:["street","state","postcode"]},KZ:{name:"Kazakhstan",units:["postcode","state","city","street"]},LA:{name:"Laos",units:["street","postcode","city"]},LB:{name:"Lebanon",units:["street","city","postcode"]},LC:{name:"Saint Lucia",units:["street","city"]},LI:{name:"Liechtenstein",units:["street","postcode","city"]},LK:{name:"Sri Lanka",units:["street","city","postcode"]},LR:{name:"Liberia",units:["street","postcode","city"]},LS:{name:"Lesotho",units:["street","city","postcode"]},LT:{name:"Lithuania",units:["street","postcode","city"]},LU:{name:"Luxembourg",units:["street","postcode","city"]},LV:{name:"Latvia",units:["street","city","postcode"]},LY:{name:"Libya",units:["street","city"]},MA:{name:"Morocco",units:["street","postcode","city"]},MC:{name:"Monaco",units:["street","postcode","city"]},MD:{name:"Moldova",units:["street","postcode","city"]},ME:{name:"Montenegro",units:["street","postcode","city"]},MF:{name:"Saint Martin",units:["street","postcode","city"]},MG:{name:"Madagascar",units:["street","postcode","city"]},MK:{name:"North Macedonia",units:["street","postcode","city"]},ML:{name:"Mali",units:["street","city"]},MM:{name:"Myanmar",units:["street","city","postcode"]},MN:{name:"Mongolia"},MO:{name:"Macau",units:["street"]},MQ:{name:"Martinique",units:["street","postcode","city"]},MR:{name:"Mauritania",units:["street","city"]},MS:{name:"Montserrat",units:["street","city"]},MT:{name:"Malta",units:["street","city","postcode"]},MU:{name:"Mauritius",units:["street","postcode","city"]},MV:{name:"Maldives",units:["street","city","postcode"]},MW:{name:"Malawi",units:["street","city"]},MX:{name:"Mexico",stateUnit:"state",units:["street","postcode","city","state"]},MY:{name:"Malaysia",stateUnit:"state",units:["street","postcode","city","state"]},MZ:{name:"Mozambique",units:["street","postcode","city","state"]},NA:{name:"Namibia",units:["street","city","postcode"]},NC:{name:"New Caledonia",units:["street","postcode","city"]},NE:{name:"Niger",units:["street","postcode","city"]},NG:{name:"Nigeria",stateUnit:"state",units:["street","city","postcode","state"]},NI:{name:"Nicaragua",stateUnit:"department",units:["street","postcode","city","state"]},NL:{name:"Netherlands",units:["street","postcode","city"]},NO:{name:"Norway",cityUnit:"postTown",units:["street","postcode","city"]},NP:{name:"Nepal",units:["street","city","postcode"]},NR:{name:"Nauru",stateUnit:"prefecture",units:["street","state"]},NU:{name:"Niue",units:["street","city"]},NZ:{name:"New Zealand",units:["street","city","postcode"]},OM:{name:"Oman",units:["street","postcode","city"]},PA:{name:"Panama",units:["street","city","state"]},PE:{name:"Peru",cityUnit:"district",units:["street","city","postcode","state"]},PF:{name:"French Polynesia",stateUnit:"island",units:["street","postcode","city","state"]},PG:{name:"Papua New Guinea",units:["street","city","postcode","state"]},PH:{name:"Philippines",units:["street","city","postcode","state"]},PK:{name:"Pakistan",units:["street","city","postcode"]},PL:{name:"Poland",units:["street","postcode","city"]},PM:{name:"Saint Pierre and Miquelon",units:["street","postcode","city"]},PN:{name:"Pitcairn Islands",units:["street","city","postcode"]},PR:{name:"Puerto Rico",postcodeUnit:"zip",units:["street","city","postcode"]},PS:{name:"Palestine",units:["street","city"]},PT:{name:"Portugal",units:["street","postcode","city"]},PY:{name:"Paraguay",units:["street","postcode","city"]},QA:{name:"Qatar",units:["street","city"]},RE:{name:"Réunion",units:["street","postcode","city"]},RO:{name:"Romania",units:["street","postcode","city"]},RS:{name:"Serbia",units:["street","postcode","city"]},RU:{name:"Russia",stateUnit:"oblast"},RW:{name:"Rwanda",units:["street","city"]},SA:{name:"Saudi Arabia",units:["street","city","postcode"]},SB:{name:"Solomon Islands",units:["street","city"]},SC:{name:"Seychelles",stateUnit:"island",units:["street","city","state"]},SE:{name:"Sweden",cityUnit:"postTown",units:["street","state","postcode","city"]},SG:{name:"Singapore",units:["street","postcode"]},SH:{name:"Saint Helena",units:["street","city","postcode"]},SI:{name:"Slovenia",units:["street","state","postcode","city"]},SJ:{name:"Svalbard and Jan Mayen",cityUnit:"postTown",units:["street","postcode","city"]},SK:{name:"Slovakia",units:["street","postcode","city"]},SL:{name:"Sierra Leone",units:["street","city"]},SM:{name:"San Marino",units:["street","postcode","city"]},SN:{name:"Senegal",units:["street","postcode","city"]},SO:{name:"Somalia"},SR:{name:"Suriname",units:["street","city","state"]},SS:{name:"South Sudan",units:["street","city"]},ST:{name:"São Tomé and Príncipe",units:["street","city"]},SV:{name:"El Salvador",units:["street","postcode","city","state"]},SX:{name:"Sint Maarten",units:["street","city"]},SZ:{name:"Eswatini",units:["street","city","postcode"]},TA:{name:"Tristan da Cunha",units:["street","city","postcode"]},TC:{name:"Turks and Caicos Islands",units:["street","city","postcode"]},TD:{name:"Chad",units:["street","city"]},TF:{name:"French Southern Territories",units:["street","city"]},TG:{name:"Togo",units:["street","city"]},TH:{name:"Thailand"},TJ:{name:"Tajikistan",units:["street","postcode","city"]},TK:{name:"Tokelau",units:["street","city"]},TL:{name:"Timor-Leste",units:["street","city"]},TM:{name:"Turkmenistan",units:["street","postcode","city"]},TN:{name:"Tunisia",units:["street","postcode","city"]},TO:{name:"Tonga",units:["street","city"]},TR:{name:"Turkey",cityUnit:"district",units:["street","postcode","city","state"]},TT:{name:"Trinidad and Tobago",units:["street","city"]},TV:{name:"Tuvalu",stateUnit:"island",units:["street","city","state"]},TW:{name:"Taiwan",stateUnit:"county",units:["postcode","state","city","street"]},TZ:{name:"Tanzania",units:["street","postcode","city"]},UA:{name:"Ukraine",stateUnit:"oblast"},UG:{name:"Uganda",units:["street","city"]},US:{name:"United States",postcodeUnit:"zip",stateUnit:"state",units:["state"],states:[{abbreviation:"AL",name:"Alabama"},{abbreviation:"AK",name:"Alaska"},{abbreviation:"AS",name:"American Samoa"},{abbreviation:"AZ",name:"Arizona"},{abbreviation:"AR",name:"Arkansas"},{abbreviation:"AA",name:"Armed Forces (AA)"},{abbreviation:"AE",name:"Armed Forces (AE)"},{abbreviation:"AP",name:"Armed Forces (AP)"},{abbreviation:"CA",name:"California"},{abbreviation:"CO",name:"Colorado"},{abbreviation:"CT",name:"Connecticut"},{abbreviation:"DE",name:"Delaware"},{abbreviation:"DC",name:"District of Columbia"},{abbreviation:"FL",name:"Florida"},{abbreviation:"GA",name:"Georgia"},{abbreviation:"GU",name:"Guam"},{abbreviation:"HI",name:"Hawaii"},{abbreviation:"ID",name:"Idaho"},{abbreviation:"IL",name:"Illinois"},{abbreviation:"IN",name:"Indiana"},{abbreviation:"IA",name:"Iowa"},{abbreviation:"KS",name:"Kansas"},{abbreviation:"KY",name:"Kentucky"},{abbreviation:"LA",name:"Louisiana"},{abbreviation:"ME",name:"Maine"},{abbreviation:"MH",name:"Marshall Islands"},{abbreviation:"MD",name:"Maryland"},{abbreviation:"MA",name:"Massachusetts"},{abbreviation:"MI",name:"Michigan"},{abbreviation:"FM",name:"Micronesia"},{abbreviation:"MN",name:"Minnesota"},{abbreviation:"MS",name:"Mississippi"},{abbreviation:"MO",name:"Missouri"},{abbreviation:"MT",name:"Montana"},{abbreviation:"NE",name:"Nebraska"},{abbreviation:"NV",name:"Nevada"},{abbreviation:"NH",name:"New Hampshire"},{abbreviation:"NJ",name:"New Jersey"},{abbreviation:"NM",name:"New Mexico"},{abbreviation:"NY",name:"New York"},{abbreviation:"NC",name:"North Carolina"},{abbreviation:"ND",name:"North Dakota"},{abbreviation:"MP",name:"Northern Mariana Islands"},{abbreviation:"OH",name:"Ohio"},{abbreviation:"OK",name:"Oklahoma"},{abbreviation:"OR",name:"Oregon"},{abbreviation:"PW",name:"Palau"},{abbreviation:"PA",name:"Pennsylvania"},{abbreviation:"PR",name:"Puerto Rico"},{abbreviation:"RI",name:"Rhode Island"},{abbreviation:"SC",name:"South Carolina"},{abbreviation:"SD",name:"South Dakota"},{abbreviation:"TN",name:"Tennessee"},{abbreviation:"TX",name:"Texas"},{abbreviation:"UT",name:"Utah"},{abbreviation:"VT",name:"Vermont"},{abbreviation:"VI",name:"Virgin Islands"},{abbreviation:"VA",name:"Virginia"},{abbreviation:"WA",name:"Washington"},{abbreviation:"WV",name:"West Virginia"},{abbreviation:"WI",name:"Wisconsin"},{abbreviation:"WY",name:"Wyoming"}]},UY:{name:"Uruguay",units:["street","postcode","city","state"]},UZ:{name:"Uzbekistan",units:["street","postcode","city","state"]},VA:{name:"Vatican City",units:["street","postcode","city"]},VC:{name:"Saint Vincent and the Grenadines",units:["street","city","postcode"]},VE:{name:"Venezuela",stateUnit:"state",units:["street","city","postcode","state"]},VG:{name:"British Virgin Islands",units:["street","city","postcode"]},VN:{name:"Vietnam"},VU:{name:"Vanuatu",units:["street","city"]},WF:{name:"Wallis and Futuna",units:["street","postcode","city"]},WS:{name:"Samoa",units:["street","city"]},XK:{name:"Kosovo",units:["street","postcode","city"]},YE:{name:"Yemen",units:["street","city"]},YT:{name:"Mayotte",units:["street","postcode","city"]},ZA:{name:"South Africa",units:["street","city","postcode"]},ZM:{name:"Zambia",units:["street","postcode","city"]},ZW:{name:"Zimbabwe",units:["street","city"]}};!function(ProcessOut){var DYNAMIC_CHECKOUT_EVENTS_WIDGET_LOADING="processout_dynamic_checkout_loading",DYNAMIC_CHECKOUT_EVENTS_WIDGET_READY="processout_dynamic_checkout_ready",DYNAMIC_CHECKOUT_EVENTS_INVOICE_FETCHING_ERROR="processout_dynamic_checkout_invoice_fetching_error",DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_SUCCESS="processout_dynamic_checkout_tokenize_payment_success",DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_ERROR="processout_dynamic_checkout_tokenize_payment_error",DYNAMIC_CHECKOUT_EVENTS_PAYMENT_SUCCESS="processout_dynamic_checkout_payment_success",DynamicCheckoutEventsUtils=function(){function DynamicCheckoutEventsUtils(){}return DynamicCheckoutEventsUtils.dispatchInvoiceFetchingErrorEvent=function(errorData){errorData=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_INVOICE_FETCHING_ERROR,errorData);return window.dispatchEvent(errorData)},DynamicCheckoutEventsUtils.dispatchWidgetLoadingEvent=function(){var event=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_WIDGET_LOADING);return window.dispatchEvent(event)},DynamicCheckoutEventsUtils.dispatchWidgetReadyEvent=function(){var event=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_WIDGET_READY);return window.dispatchEvent(event)},DynamicCheckoutEventsUtils.dispatchTokenizePaymentSuccessEvent=function(token){token=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_SUCCESS,{token:token});return window.dispatchEvent(token)},DynamicCheckoutEventsUtils.dispatchTokenizePaymentErrorEvent=function(errorData){errorData=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_ERROR,errorData);return window.dispatchEvent(errorData)},DynamicCheckoutEventsUtils.dispatchPaymentErrorEvent=function(errorData){errorData=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_ERROR,errorData);return window.dispatchEvent(errorData)},DynamicCheckoutEventsUtils.dispatchPaymentSuccessEvent=function(response){response=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_PAYMENT_SUCCESS,response);return window.dispatchEvent(response)},DynamicCheckoutEventsUtils.createEvent=function(eventName,data){var event_2;return"function"==typeof window.CustomEvent?new CustomEvent(eventName,{bubbles:!0,detail:data}):((event_2=document.createEvent("CustomEvent")).initCustomEvent(eventName,!0,!1,data),event_2)},DynamicCheckoutEventsUtils}();ProcessOut.DynamicCheckoutEventsUtils=DynamicCheckoutEventsUtils}(ProcessOut=ProcessOut||{}),function(ProcessOut){var DynamicCheckoutColorsUtils=function(){function DynamicCheckoutColorsUtils(){}return DynamicCheckoutColorsUtils.hexToRgba=function(hex){var r=parseInt(hex.slice(2,4),16),g=parseInt(hex.slice(4,6),16),b=parseInt(hex.slice(6,8),16),hex=parseInt(hex.slice(8,10),16)/255;return"rgba(".concat(r,", ").concat(g,", ").concat(b,", ").concat(hex,")")},DynamicCheckoutColorsUtils}();ProcessOut.DynamicCheckoutColorsUtils=DynamicCheckoutColorsUtils}(ProcessOut=ProcessOut||{}),function(ProcessOut){ProcessOut.ApplePayClient=function ApplePayClient(){}}(ProcessOut=ProcessOut||{}),function(ProcessOut){var GooglePayClient=function(){function GooglePayClient(){}return GooglePayClient.prototype.initializeGooglePay=function(configuration){var baseRequest={apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:configuration.allowed_auth_methods,allowedCardNetworks:configuration.allowed_card_networks},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:"example",gatewayMerchantId:"exampleGatewayMerchantId"}}}]},paymentsClient=null;function getGooglePaymentsClient(){return paymentsClient=null===paymentsClient?new google.payments.api.PaymentsClient({environment:"TEST"}):paymentsClient}function onGooglePaymentButtonClicked(){var paymentDataRequest=__assign(__assign({},baseRequest),{transactionInfo:{countryCode:"US",currencyCode:"USD",totalPriceStatus:"FINAL",totalPrice:"1.00"}});getGooglePaymentsClient().loadPaymentData(paymentDataRequest).then(function(paymentData){!function processPayment(paymentData){console.log("Google Pay payment data:",paymentData)}(paymentData)})["catch"](function(err){console.error("Error loading payment data:",err)})}!function onGooglePayLoaded(){getGooglePaymentsClient().isReadyToPay(baseRequest).then(function(response){response.result&&!function addGooglePayButton(){var button,container=document.getElementById("google-pay-button-container");container?(button=getGooglePaymentsClient().createButton({onClick:onGooglePaymentButtonClicked,buttonSizeMode:"fill"}),container.appendChild(button)):console.error("Container element not found.")}()})["catch"](function(err){console.error("Error checking Google Pay readiness:",err)})}()},GooglePayClient}();ProcessOut.GooglePayClient=GooglePayClient}(ProcessOut=ProcessOut||{}),function(ProcessOut){var ActionFlow,MockedIFrameWindow=function(){function MockedIFrameWindow(el,iframe){var event;this.element=el,this.iframe=iframe,window.addEventListener("resize",function(event){var width=Math.max(document.body.clientWidth,document.documentElement.clientWidth),width=(this.element.style.width=width+"px",Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight));this.element.style.height=width+"px"}.bind(this)),"function"==typeof Event?event=new Event("resize"):(event=document.createEvent("Event")).initEvent("resize",!0,!0),window.dispatchEvent(event)}return MockedIFrameWindow.prototype.open=function(url){this.iframe.setAttribute("src",url),document.body.style.overflow="hidden",document.body.appendChild(this.element)},MockedIFrameWindow.prototype.close=function(){document.body.style.overflow="",this.closed=!0,this.element.remove()},MockedIFrameWindow}(),ActionHandlerOptions=(!function(ActionFlow){ActionFlow[ActionFlow.NewTab=0]="NewTab",ActionFlow[ActionFlow.NewWindow=1]="NewWindow",ActionFlow[ActionFlow.IFrame=2]="IFrame",ActionFlow[ActionFlow.FingerprintIframe=3]="FingerprintIframe",ActionFlow[ActionFlow.CurrentWindow=4]="CurrentWindow"}(ActionFlow=ProcessOut.ActionFlow||(ProcessOut.ActionFlow={})),function(){function ActionHandlerOptions(actionType,gatewayLogo,override){switch(this.iframeWidth=440,this.iframeHeight=480,this.gatewayLogo=gatewayLogo,actionType){case ActionHandlerOptions.ThreeDSChallengeFlow:this.flow=ActionFlow.IFrame;break;case ActionHandlerOptions.ThreeDSChallengeFlowNoIframe:this.flow=ActionFlow.CurrentWindow;break;case ActionHandlerOptions.ThreeDSFingerprintFlow:this.flow=ActionFlow.FingerprintIframe;break;case"paypal":case"paypalexpresscheckout":case"paypal-rest":this.flow=ActionFlow.NewWindow,this.newWindowHeight=645,this.newWindowWidth=450;break;case"test-credit-card":case"test-alternative-payment":this.flow=ActionFlow.NewWindow,this.newWindowHeight=645,this.newWindowWidth=450;break;default:this.flow=ActionFlow.NewTab}this.flow==ActionFlow.NewWindow&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(this.flow=ActionFlow.NewTab),override&&(this.flow=ActionFlow.IFrame,this.iframeWidth=override.width,this.iframeHeight=override.height)}return ActionHandlerOptions.ThreeDSChallengeFlow="three-d-s-challenge-flow",ActionHandlerOptions.ThreeDSChallengeFlowNoIframe="three-d-s-challenge-flow-no-iframe",ActionHandlerOptions.ThreeDSFingerprintFlow="three-d-s-fingerprint-flow",ActionHandlerOptions}()),ActionHandler=(ProcessOut.ActionHandlerOptions=ActionHandlerOptions,function(){function ActionHandler(instance,options){var iframe,button;this.canceled=!1,this.newWindowName="processout.checkout-window",this.instance=instance,this.options=options,this.options||(this.options=new ActionHandlerOptions),this.options.flow==ActionFlow.IFrame&&((instance=document.createElement("div")).id="processoutjs-action-modal",instance.style.position="fixed",instance.style.top="0",instance.style.left="0",instance.style.height="100%",instance.style.width="100%",instance.setAttribute("style","position: fixed; top: 0; left: 0; background: rgba(0, 0, 0, 0.5); z-index: 9999999; overflow: auto;"),(iframe=document.createElement("iframe")).setAttribute("style","margin: 1em auto; width: ".concat(this.options.iframeWidth,"px; height: ").concat(this.options.iframeHeight,'px; max-width: 100%; max-height: 100%; display: block; box-shadow: 0 15px 35px rgba(50, 50, 93, 0.1), 0 5px 15px rgba(0, 0, 0, 0.07); background-color: #ECEFF1; background-image: url("').concat(this.instance.endpoint("js","/images/loader.gif"),'"); background-repeat: no-repeat; background-position: center;")')),iframe.setAttribute("frameborder","0"),iframe.onload=function(){iframe.style.backgroundImage=null},(options=document.createElement("div")).setAttribute("style","width: 100%; text-align: center; margin-bottom: 1em;"),(button=document.createElement("div")).setAttribute("style","cursor: pointer; color: white;"),button.innerHTML=ProcessOut.Translator.translateMessage("label.cancel","Cancel"),options.appendChild(button),instance.appendChild(iframe),instance.appendChild(options),this.iframeWrapper=new MockedIFrameWindow(instance,iframe),button.onclick=function(){this.iframeWrapper.close()}.bind(this))}return ActionHandler.prototype.handle=function(url,success,error){var _a,timeout,topLayer,newWindow,timer,t=this,refocus=function(){topLayer&&topLayer.remove(),window.focus()};switch(this.options.flow){case ActionFlow.NewWindow:_a=this.createNewWindow(url),topLayer=_a.topLayer,newWindow=_a.newWindow;break;case ActionFlow.IFrame:(newWindow=this.iframeWrapper).open(url);break;case ActionFlow.FingerprintIframe:(newWindow=this.createFingerprintIFrame()).open(url),timeout=setTimeout(function(){clearInterval(timer),timer=null,newWindow.close(),error(new ProcessOut.Exception("three-d-s-2.fingerprint-timed-out"))},1e4);break;case ActionFlow.CurrentWindow:(newWindow=window).location.replace(url);break;default:_a=this.createNewTabOrWindow(url),topLayer=_a.topLayer,newWindow=_a.newWindow}return newWindow?(timer=setInterval(function(){if(timer)if(t.isCanceled())clearInterval(timer),timer=null,newWindow.close(),error(new ProcessOut.Exception("customer.canceled")),refocus();else{var cancelf=function(){clearInterval(timer),timer=null,error(new ProcessOut.Exception("customer.canceled")),refocus()};try{newWindow&&!newWindow.closed||cancelf()}catch(err){try{newWindow.close()}catch(err){}cancelf()}}},500),this.listenEvents(newWindow,timer,refocus,function(data){timeout&&clearTimeout(timeout),success(data)},function(err){timeout&&clearTimeout(timeout),error(err)}),this):(error(new ProcessOut.Exception("customer.popup-blocked")),refocus(),null)},ActionHandler.prototype.createNewTabOrWindow=function(url){url=window.open(url,this.newWindowName);return this.setupWindowObject(url)},ActionHandler.prototype.createNewWindow=function(url){var h=this.options.newWindowHeight,w=this.options.newWindowWidth,y=window.top.outerHeight/2+window.top.screenY-h/2,x=window.top.outerWidth/2+window.top.screenX-w/2,url=window.open(url,this.newWindowName,"menubar=false,toolbar=false,width=".concat(w,",height=").concat(h,",top=").concat(y,",left=").concat(x));return this.setupWindowObject(url)},ActionHandler.prototype.setupWindowObject=function(newWindow){var ret,topLayerMessageImage;return newWindow?(ret={topLayer:null,newWindow:newWindow},newWindow=function(e){try{ret.newWindow.close()}catch(err){}},window.addEventListener("beforeunload",newWindow,!1),window.addEventListener("pagehide",newWindow,!1),ret.topLayer=document.createElement("div"),ret.topLayer.id="processoutjs-action-modal",ret.topLayer.setAttribute("style","position: fixed; top: 0; left: 0; background: rgba(0, 0, 0, 0.7); z-index: 9999999; overflow: auto; height: 100%; width: 100%;"),(newWindow=document.createElement("div")).setAttribute("style","text-align: center; color: white; max-width: 350px; margin: 0 auto; margin-top: 10%; cursor: pointer;"),this.options.gatewayLogo&&((topLayerMessageImage=document.createElement("img")).setAttribute("style","max-height: 70px; max-width: 230px; filter: saturate(0) grayscale(1) brightness(0.6) contrast(100000) invert(1); margin-bottom: 2em;"),topLayerMessageImage.setAttribute("src",this.options.gatewayLogo),newWindow.appendChild(topLayerMessageImage)),(topLayerMessageImage=document.createElement("div")).innerHTML=ProcessOut.Translator.translateMessage("label.apm-description"),newWindow.appendChild(topLayerMessageImage),ret.topLayer.appendChild(newWindow),newWindow.addEventListener("click",function(){ret.newWindow.focus()}.bind(this),!1),(topLayerMessageImage=document.createElement("div")).setAttribute("style","text-align: center; color: white; max-width: 350px; margin: 0 auto; margin-top: 3em; cursor: pointer; opacity: 0.9;"),topLayerMessageImage.innerHTML=ProcessOut.Translator.translateMessage("label.cancel"),ret.topLayer.appendChild(topLayerMessageImage),topLayerMessageImage.addEventListener("click",function(){this.cancel()}.bind(this),!1),document.body.appendChild(ret.topLayer),ret):{}},ActionHandler.prototype.createFingerprintIFrame=function(){var iframeWrapper=document.createElement("div"),iframe=(iframeWrapper.id="processoutjs-fingerprint-wrapper",iframeWrapper.style.height="0",iframeWrapper.style.width="0",document.createElement("iframe"));return iframe.style.display="none",iframe.setAttribute("frameborder","0"),iframeWrapper.appendChild(iframe),new MockedIFrameWindow(iframeWrapper,iframe)},ActionHandler.prototype.listenEvents=function(newWindow,timer,refocus,success,error){var cur=++ActionHandler.listenerCount,alreadyDone=!1,handler=function(event){var data=ProcessOut.Message.parseEvent(event);if(data.namespace==ProcessOut.Message.checkoutNamespace)if(ActionHandler.listenerCount!=cur)timer&&(clearInterval(timer),timer=null);else if(!alreadyDone)switch(alreadyDone=!0,data.action){case"success":timer&&(clearInterval(timer),timer=null),newWindow.close(),success(data.data),refocus();break;case"canceled":timer&&(clearInterval(timer),timer=null),newWindow.close(),error(new ProcessOut.Exception("customer.canceled")),refocus();break;case"none":timer&&(clearInterval(timer),timer=null),newWindow.close(),error(new ProcessOut.Exception("processout-js.no-customer-action")),refocus();break;case"error":timer&&(clearInterval(timer),timer=null),newWindow.close(),error(new ProcessOut.Exception(data.errorCode,data.errorMessage)),refocus();break;default:timer&&(clearInterval(timer),timer=null),newWindow.close(),error(new ProcessOut.Exception("default")),refocus()}};window.addEventListener("message",handler),new ProcessOut.MessageHub(this.instance,null,function(k,v){v=ProcessOut.Message.parseEvent({data:v});v.namespace=k,handler({data:JSON.stringify(v)})})},ActionHandler.prototype.cancel=function(){this.canceled=!0},ActionHandler.prototype.isCanceled=function(){return this.canceled},ActionHandler.listenerCount=0,ActionHandler}());ProcessOut.ActionHandler=ActionHandler}(ProcessOut=ProcessOut||{});
